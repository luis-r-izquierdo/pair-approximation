(* Content-type: application/vnd.wolfram.cdf.text *)

(*** Wolfram CDF File ***)
(* http://www.wolfram.com/cdf *)

(* CreatedBy='Mathematica 8.0' *)

(*************************************************************************)
(*                                                                       *)
(*  The Mathematica License under which this file was created prohibits  *)
(*  restricting third parties in receipt of this file from republishing  *)
(*  or redistributing it by any means, including but not limited to      *)
(*  rights management or terms of use, without the express consent of    *)
(*  Wolfram Research, Inc.                                               *)
(*                                                                       *)
(*************************************************************************)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       835,         17]
NotebookDataLength[    255437,       5346]
NotebookOptionsPosition[    254163,       5316]
NotebookOutlinePosition[    254902,       5340]
CellTagsIndexPosition[    254859,       5337]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Pair approximation for 2x2 symmetric games on regular networks\
\>", "Title",ExpressionUUID->"be2ab95f-49ca-4d64-983e-6549390d65ef"],

Cell[TextData[{
 "\nBy ",
 ButtonBox["Luis R. Izquierdo",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://luis.izqui.org"], None},
  ButtonNote->"http://luis.izqui.org"],
 ", ",
 ButtonBox["Segismundo S. Izquierdo",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://www.segis.izqui.org"], None},
  ButtonNote->"http://www.segis.izqui.org"],
 " and ",
 ButtonBox["Christoph Hauert",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://personal.math.ubc.ca/~hauert/"], None},
  ButtonNote->"https://personal.math.ubc.ca/~hauert/"],
 " "
}], "Subtitle",ExpressionUUID->"c414d9db-7737-4bde-8abd-eaa0928aedb2"],

Cell[TextData[{
 "This is a notebook created to solve the system of differential equations of \
the pair approximation explained in section 2.4 of the book ",
 ButtonBox["Agent-based Evolutionary Game Dynamics",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://wisc.pb.unizin.org/agent-based-evolutionary-game-dynamics/"],
     None},
  ButtonNote->
   "https://wisc.pb.unizin.org/agent-based-evolutionary-game-dynamics/"],
 "."
}], "Text",ExpressionUUID->"73c625d9-c929-477d-869c-c28f423133fc"]
}, Open  ]],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`a11$$ = 1, $CellContext`a12$$ = 
    0.8, $CellContext`a21$$ = 1.2, $CellContext`a22$$ = 
    0, $CellContext`gameName$$ = "Snowdrift", $CellContext`initqAA$$ = 
    0.5, $CellContext`initxA$$ = 0.5, $CellContext`k$$ = 4, $CellContext`m$$ =
     40, $CellContext`maxTimeOut$$ = 20, $CellContext`preset$$ = 
    "Hauert Doebeli 2004 fig1b r=0.2", $CellContext`showMD$$ = 
    True, $CellContext`update$$ = 1000, $CellContext`updateRule$$ = 
    "Imitative pairwise difference", Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`preset$$], "Hauert Doebeli 2004 fig1b r=0.2"}, 
      ControlType -> None}, {{
       Hold[$CellContext`a11$$], 1}, ControlType -> None}, {{
       Hold[$CellContext`a12$$], 0.8}, ControlType -> None}, {{
       Hold[$CellContext`a21$$], 1.2}, ControlType -> None}, {{
       Hold[$CellContext`a22$$], 0}, ControlType -> None}, {{
       Hold[$CellContext`gameName$$], "Snowdrift"}, ControlType -> None}, {{
       Hold[$CellContext`k$$], 4}, ControlType -> None}, {{
       Hold[$CellContext`update$$], 0}, 0, 100, ControlType -> None}, {{
       Hold[$CellContext`updateRule$$], "Imitative pairwise difference"}, 
      ControlType -> None}, {{
       Hold[$CellContext`m$$], 1}, ControlType -> None}, {{
       Hold[$CellContext`initxA$$], 0.5}, ControlType -> None}, {{
       Hold[$CellContext`initqAA$$], 0.5}, ControlType -> None}, {{
       Hold[$CellContext`showMD$$], True}, ControlType -> None}, {{
       Hold[$CellContext`maxTimeOut$$], 1}, ControlType -> None}, {
      Hold[
       Style["Presets for replication", Bold, Medium]], 
      Manipulate`Dump`ThisIsNotAControl, ControlType -> None}, {
      Hold[
       Row[{
         ActionMenu[
          Dynamic[$CellContext`preset$$], {
          "Hauert & Doebeli (2004)" -> {
            "fig1b r=0.2" :> ($CellContext`a11$$ = 1; $CellContext`a12$$ = 
               0.8; $CellContext`a21$$ = 1.2; $CellContext`a22$$ = 
               0; $CellContext`update$$ = 1000; $CellContext`gameName$$ = 
               "Snowdrift"; $CellContext`updateRule$$ = 
               "Imitative pairwise difference"; $CellContext`k$$ = 
               4; $CellContext`initxA$$ = 0.5; $CellContext`initqAA$$ = 
               0.5; $CellContext`showMD$$ = True; $CellContext`preset$$ = 
               "Hauert Doebeli 2004 fig1b r=0.2"), 
             "fig1b r=0.5" :> ($CellContext`a11$$ = 1; $CellContext`a12$$ = 
               0.5; $CellContext`a21$$ = 1.5; $CellContext`a22$$ = 
               0; $CellContext`update$$ = 2000; $CellContext`gameName$$ = 
               "Snowdrift"; $CellContext`updateRule$$ = 
               "Imitative pairwise difference"; $CellContext`k$$ = 
               4; $CellContext`initxA$$ = 0.5; $CellContext`initqAA$$ = 
               0.5; $CellContext`showMD$$ = True; $CellContext`preset$$ = 
               "Hauert Doebeli 2004 fig1b r=0.5"), 
             "fig1b r=0.9" :> ($CellContext`a11$$ = 1; $CellContext`a12$$ = 
               0.1; $CellContext`a21$$ = 1.9; $CellContext`a22$$ = 
               0; $CellContext`update$$ = 3000; $CellContext`gameName$$ = 
               "Snowdrift"; $CellContext`updateRule$$ = 
               "Imitative pairwise difference"; $CellContext`k$$ = 
               4; $CellContext`initxA$$ = 0.5; $CellContext`initqAA$$ = 
               0.5; $CellContext`showMD$$ = True; $CellContext`preset$$ = 
               "Hauert Doebeli 2004 fig1b r=0.9"), Delimiter, 
             "fig1d r=0.2" :> ($CellContext`a11$$ = 1; $CellContext`a12$$ = 
               0.8; $CellContext`a21$$ = 1.2; $CellContext`a22$$ = 
               0; $CellContext`update$$ = 5000; $CellContext`gameName$$ = 
               "Snowdrift"; $CellContext`updateRule$$ = 
               "Imitative pairwise difference"; $CellContext`k$$ = 
               8; $CellContext`initxA$$ = 0.5; $CellContext`initqAA$$ = 
               0.5; $CellContext`showMD$$ = True; $CellContext`preset$$ = 
               "Hauert Doebeli 2004 fig1d r=0.2"), 
             "fig1d r=0.5" :> ($CellContext`a11$$ = 1; $CellContext`a12$$ = 
               0.5; $CellContext`a21$$ = 1.5; $CellContext`a22$$ = 
               0; $CellContext`update$$ = 6000; $CellContext`gameName$$ = 
               "Snowdrift"; $CellContext`updateRule$$ = 
               "Imitative pairwise difference"; $CellContext`k$$ = 
               8; $CellContext`initxA$$ = 0.5; $CellContext`initqAA$$ = 
               0.5; $CellContext`showMD$$ = True; $CellContext`preset$$ = 
               "Hauert Doebeli 2004 fig1d r=0.5"), 
             "fig1d r=0.9" :> ($CellContext`a11$$ = 1; $CellContext`a12$$ = 
               0.1; $CellContext`a21$$ = 1.9; $CellContext`a22$$ = 
               0; $CellContext`update$$ = 7000; $CellContext`gameName$$ = 
               "Snowdrift"; $CellContext`updateRule$$ = 
               "Imitative pairwise difference"; $CellContext`k$$ = 
               8; $CellContext`initxA$$ = 0.5; $CellContext`initqAA$$ = 
               0.5; $CellContext`showMD$$ = True; $CellContext`preset$$ = 
               "Hauert Doebeli 2004 fig1d r=0.9")}, 
           "Hauert & Szab\[OAcute] (2005)" -> {
            "fig5 r=0" :> ($CellContext`a11$$ = 1; $CellContext`a12$$ = 
               0; $CellContext`a21$$ = 1; $CellContext`a22$$ = 
               0; $CellContext`update$$ = 15500; $CellContext`gameName$$ = 
               "Weak Prisoner's D"; $CellContext`updateRule$$ = 
               "Fermi (set intensity \!\(\*StyleBox[\"m\",FontSlant->\"Italic\
\"]\))"; $CellContext`k$$ = 4; $CellContext`m$$ = 40; $CellContext`initxA$$ = 
               0.5; $CellContext`initqAA$$ = 0.5; $CellContext`showMD$$ = 
               False; $CellContext`maxTimeOut$$ = 20; $CellContext`preset$$ = 
               "Hauert Szab\[OAcute] 2005 fig5 r=0.01"), 
             "fig5 r=0.01" :> ($CellContext`a11$$ = 
               1; $CellContext`a12$$ = -0.01; $CellContext`a21$$ = 
               1.01; $CellContext`a22$$ = 0; $CellContext`update$$ = 
               16000; $CellContext`gameName$$ = 
               "Prisoner's Dilemma"; $CellContext`updateRule$$ = 
               "Fermi (set intensity \!\(\*StyleBox[\"m\",FontSlant->\"Italic\
\"]\))"; $CellContext`k$$ = 4; $CellContext`m$$ = 40; $CellContext`initxA$$ = 
               0.5; $CellContext`initqAA$$ = 0.5; $CellContext`showMD$$ = 
               False; $CellContext`maxTimeOut$$ = 20; $CellContext`preset$$ = 
               "Hauert Szab\[OAcute] 2005 fig5 r=0.01"), 
             "fig5 r=0.02" :> ($CellContext`a11$$ = 
               1; $CellContext`a12$$ = -0.02; $CellContext`a21$$ = 
               1.02; $CellContext`a22$$ = 0; $CellContext`update$$ = 
               17000; $CellContext`gameName$$ = 
               "Prisoner's Dilemma"; $CellContext`updateRule$$ = 
               "Fermi (set intensity \!\(\*StyleBox[\"m\",FontSlant->\"Italic\
\"]\))"; $CellContext`k$$ = 4; $CellContext`m$$ = 40; $CellContext`initxA$$ = 
               0.5; $CellContext`initqAA$$ = 0.5; $CellContext`showMD$$ = 
               False; $CellContext`maxTimeOut$$ = 20; $CellContext`preset$$ = 
               "Hauert Szab\[OAcute] 2005 fig5 r=0.02"), 
             "fig5 r=0.06" :> ($CellContext`a11$$ = 
               1; $CellContext`a12$$ = -0.06; $CellContext`a21$$ = 
               1.06; $CellContext`a22$$ = 0; $CellContext`update$$ = 
               18000; $CellContext`gameName$$ = 
               "Prisoner's Dilemma"; $CellContext`updateRule$$ = 
               "Fermi (set intensity \!\(\*StyleBox[\"m\",FontSlant->\"Italic\
\"]\))"; $CellContext`k$$ = 4; $CellContext`m$$ = 40; $CellContext`initxA$$ = 
               0.5; $CellContext`initqAA$$ = 0.5; $CellContext`showMD$$ = 
               False; $CellContext`maxTimeOut$$ = 20; $CellContext`preset$$ = 
               "Hauert Szab\[OAcute] 2005 fig5 r=0.02")}, 
           "Fu, Nowak & Hauert (2010)" -> {
            "fig4a,b u=0.02" :> ($CellContext`a11$$ = 1; $CellContext`a12$$ = 
               0; $CellContext`a21$$ = 1.02; $CellContext`a22$$ = 
               0.02; $CellContext`update$$ = 8000; $CellContext`gameName$$ = 
               "Prisoner's Dilemma"; $CellContext`updateRule$$ = 
               "Imitative pairwise difference"; $CellContext`k$$ = 
               8; $CellContext`initxA$$ = 0.01; $CellContext`initqAA$$ = 
               0.7; $CellContext`showMD$$ = False; $CellContext`preset$$ = 
               "Fu et al 2010 fig4ab u=0.02"), 
             "fig4a,b u=0.1" :> ($CellContext`a11$$ = 1; $CellContext`a12$$ = 
               0; $CellContext`a21$$ = 1.1; $CellContext`a22$$ = 
               0.1; $CellContext`update$$ = 9000; $CellContext`gameName$$ = 
               "Prisoner's Dilemma"; $CellContext`updateRule$$ = 
               "Imitative pairwise difference"; $CellContext`k$$ = 
               8; $CellContext`initxA$$ = 0.01; $CellContext`initqAA$$ = 
               0.7; $CellContext`showMD$$ = False; $CellContext`preset$$ = 
               "Fu et al 2010 fig4ab u=0.1"), Delimiter, 
             "fig4d,e v=0.05" :> ($CellContext`a11$$ = 1; $CellContext`a12$$ = 
               0.95; $CellContext`a21$$ = 1.05; $CellContext`a22$$ = 
               0; $CellContext`update$$ = 10000; $CellContext`gameName$$ = 
               "Snowdrift"; $CellContext`updateRule$$ = 
               "Imitative pairwise difference"; $CellContext`k$$ = 
               8; $CellContext`initxA$$ = 0.01; $CellContext`initqAA$$ = 
               0.7; $CellContext`showMD$$ = False; $CellContext`preset$$ = 
               "Fu et al 2010 fig4de v=0.05"), 
             "fig4d,e v=0.4" :> ($CellContext`a11$$ = 1; $CellContext`a12$$ = 
               0.6; $CellContext`a21$$ = 1.4; $CellContext`a22$$ = 
               0; $CellContext`update$$ = 11000; $CellContext`gameName$$ = 
               "Snowdrift"; $CellContext`updateRule$$ = 
               "Imitative pairwise difference"; $CellContext`k$$ = 
               8; $CellContext`initxA$$ = 0.01; $CellContext`initqAA$$ = 
               0.7; $CellContext`showMD$$ = False; $CellContext`preset$$ = 
               "Fu et al 2010 fig4de v=0.4"), Delimiter, 
             "fig6a u=0.05" :> ($CellContext`a11$$ = 1; $CellContext`a12$$ = 
               0; $CellContext`a21$$ = 1.05; $CellContext`a22$$ = 
               0.05; $CellContext`update$$ = 12000; $CellContext`gameName$$ = 
               "Prisoner's Dilemma"; $CellContext`updateRule$$ = 
               "Imitative pairwise difference"; $CellContext`k$$ = 
               8; $CellContext`initxA$$ = 0.01; $CellContext`initqAA$$ = 
               0.7; $CellContext`showMD$$ = True; $CellContext`preset$$ = 
               "Fu et al 2010 fig6a u=0.05"), 
             "fig6a u=0.15" :> ($CellContext`a11$$ = 1; $CellContext`a12$$ = 
               0; $CellContext`a21$$ = 1.15; $CellContext`a22$$ = 
               0.15; $CellContext`update$$ = 13000; $CellContext`gameName$$ = 
               "Prisoner's Dilemma"; $CellContext`updateRule$$ = 
               "Imitative pairwise difference"; $CellContext`k$$ = 
               8; $CellContext`initxA$$ = 0.01; $CellContext`initqAA$$ = 
               0.7; $CellContext`showMD$$ = True; $CellContext`preset$$ = 
               "Fu et al 2010 fig6a u=0.15"), Delimiter, 
             "fig6c v=0.5" :> ($CellContext`a11$$ = 1; $CellContext`a12$$ = 
               0.5; $CellContext`a21$$ = 1.5; $CellContext`a22$$ = 
               0; $CellContext`update$$ = 14000; $CellContext`gameName$$ = 
               "Snowdrift"; $CellContext`updateRule$$ = 
               "Imitative pairwise difference"; $CellContext`k$$ = 
               8; $CellContext`initxA$$ = 0.01; $CellContext`initqAA$$ = 
               0.7; $CellContext`showMD$$ = True; $CellContext`preset$$ = 
               "Fu et al 2010 fig6c v=0.5"), 
             "fig6c v=1" :> ($CellContext`a11$$ = 1; $CellContext`a12$$ = 
               0; $CellContext`a21$$ = 2; $CellContext`a22$$ = 
               0; $CellContext`update$$ = 15000; $CellContext`gameName$$ = 
               "Snowdrift"; $CellContext`updateRule$$ = 
               "Imitative pairwise difference"; $CellContext`k$$ = 
               8; $CellContext`initxA$$ = 0.01; $CellContext`initqAA$$ = 
               0.7; $CellContext`showMD$$ = True; $CellContext`preset$$ = 
               "Fu et al 2010 fig6c v=1")}}, Appearance -> "PopupMenu", 
          ImageSize -> {220, 20}]}, ImageSize -> 220, Alignment -> Center]], 
      Manipulate`Dump`ThisIsNotAControl, ControlType -> None}, {
      Hold[
       Style[
       "Payoffs (\!\(\*SubscriptBox[\(\[CapitalPi]\), \(ij\)]\))", Bold, 
        Medium]], Manipulate`Dump`ThisIsNotAControl, ControlType -> None}, {
      Hold[
       Row[{
         ActionMenu[
          Dynamic[$CellContext`gameName$$], {
          "Snowdrift" :> {$CellContext`a11$$ = 3, $CellContext`a12$$ = 
             1, $CellContext`a21$$ = 4, $CellContext`a22$$ = 
             0, $CellContext`update$$ = 500; $CellContext`gameName$$ = 
              "Snowdrift", $CellContext`preset$$ = "Presets"}, 
           "Prisoner's Dilemma" :> {$CellContext`a11$$ = 
             3, $CellContext`a12$$ = 0, $CellContext`a21$$ = 
             4, $CellContext`a22$$ = 
             1, $CellContext`update$$ = 1000; $CellContext`gameName$$ = 
              "Prisoner's Dilemma", $CellContext`preset$$ = "Presets"}, 
           "Coordination" :> {$CellContext`a11$$ = 2, $CellContext`a12$$ = 
             0, $CellContext`a21$$ = 0, $CellContext`a22$$ = 
             1, $CellContext`update$$ = 2000; $CellContext`gameName$$ = 
              "Coordination", $CellContext`preset$$ = "Presets"}, 
           "All 0s" :> {$CellContext`a11$$ = 0, $CellContext`a12$$ = 
             0, $CellContext`a21$$ = 0, $CellContext`a22$$ = 
             0, $CellContext`update$$ = 3000; $CellContext`gameName$$ = 
              "All 0s", $CellContext`preset$$ = "Presets"}}, Appearance -> 
          "PopupMenu", ImageSize -> {150, 20}]}, ImageSize -> 180, Alignment -> 
        Center]], Manipulate`Dump`ThisIsNotAControl, ControlType -> None}, {{
       Hold[$CellContext`a11$$], 1, 
       "\!\(\*SubscriptBox[\(\[CapitalPi]\), \(\(A\)\(\[CenterDot]\)\)]\)"}, 
      Dynamic[InputField[
        Dynamic[$CellContext`a11$$, ($CellContext`a11$$ = \
$CellContext`ForceNumber[#])& ], Number, FieldSize -> 4]& ], ControlType -> 
      Automatic}, {{
       Hold[$CellContext`a12$$], 0.8, ""}, 
      Dynamic[InputField[
        Dynamic[$CellContext`a12$$, ($CellContext`a12$$ = \
$CellContext`ForceNumber[#])& ], Number, FieldSize -> 4]& ], ControlType -> 
      Automatic}, {{
       Hold[$CellContext`a21$$], 1.2, 
       "\!\(\*SubscriptBox[\(\[CapitalPi]\), \(\(B\)\(\[CenterDot]\)\)]\)"}, 
      Dynamic[InputField[
        Dynamic[$CellContext`a21$$, ($CellContext`a21$$ = \
$CellContext`ForceNumber[#])& ], Number, FieldSize -> 4]& ], ControlType -> 
      Automatic}, {{
       Hold[$CellContext`a22$$], 0, ""}, 
      Dynamic[InputField[
        Dynamic[$CellContext`a22$$, ($CellContext`a22$$ = \
$CellContext`ForceNumber[#])& ], Number, FieldSize -> 4]& ], ControlType -> 
      Automatic}, {
      Hold[
       Grid[{{"              ", 
          Manipulate`Place[1], 
          Manipulate`Place[2]}, {"", 
          Manipulate`Place[3], 
          Manipulate`Place[4]}}, Alignment -> Right]], 
      Manipulate`Dump`ThisIsNotAControl, ControlType -> None}, {
      Hold[
       Button[
       "Update", 
        Increment[$CellContext`update$$]; $CellContext`gameName$$ = 
         "Predefined games"; $CellContext`preset$$ = "Presets", ImageSize -> 
        180]], Manipulate`Dump`ThisIsNotAControl, ControlType -> None}, {
      Hold[
       Style["Degree of regular network", Bold, Medium]], 
      Manipulate`Dump`ThisIsNotAControl, ControlType -> None}, {{
       Hold[$CellContext`k$$], 8, 
       "\!\(\*StyleBox[\"k\",FontSlant->\"Italic\"]\)"}, 2, 10, 1, 
      ControlType -> Manipulator}, {{
       Hold[$CellContext`updateRule$$], "Imitative pairwise difference", 
       ""}, {"Imitative pairwise difference", "Imitate if better, all nbrs", 
       "Fermi (set intensity \!\(\*StyleBox[\"m\",FontSlant->\"Italic\"]\))", 
       "Best neighbor"}, ControlType -> PopupMenu}, {
      Hold[
       Grid[{{
          Style["Decision rule", Bold, Medium]}, {
          Manipulate`Place[5]}}, Alignment -> Left]], 
      Manipulate`Dump`ThisIsNotAControl, ControlType -> None}, {{
       Hold[$CellContext`m$$], 1, 
       "Fermi's \!\(\*StyleBox[\"m\",FontSlant->\"Italic\"]\)"}, 0.5, 40, 
      0.01, ControlType -> Manipulator}, {
      Hold[
       Style["Initial conditions", Bold, Medium]], 
      Manipulate`Dump`ThisIsNotAControl, ControlType -> None}, {{
       Hold[$CellContext`initxA$$], 0.5, 
       "\!\(\*SubscriptBox[StyleBox[\"x\",FontSlant->\"Italic\"], \
\"A\"]\)\!\(\*StyleBox[\"(\",FontWeight->\"Plain\"]\)\!\(\*StyleBox[\"0\",\
FontWeight->\"Plain\"]\)\!\(\*StyleBox[\")\",FontWeight->\"Plain\"]\)"}, 0.01,
       0.99, 0.01, ControlType -> Manipulator}, {{
       Hold[$CellContext`initqAA$$], 0.5, 
       "\!\(\*SubscriptBox[StyleBox[\"q\",FontSlant->\"Italic\"], \"AA\"]\)\!\
\(\*StyleBox[\"(\",FontWeight->\"Plain\"]\)\!\(\*StyleBox[\"0\",FontWeight->\"\
Plain\"]\)\!\(\*StyleBox[\")\",FontWeight->\"Plain\"]\)"}, 0.01, 0.99, 0.01, 
      ControlType -> Manipulator}, {
      Hold[
       Style["Mean Dynamic (MD)", Bold, Medium]], 
      Manipulate`Dump`ThisIsNotAControl, ControlType -> None}, {{
       Hold[$CellContext`showMD$$], True, "Show MD"}, {True, False}, 
      ControlType -> Checkbox}, {
      Hold[
       Style["Time allowed for computations", Bold, Medium]], 
      Manipulate`Dump`ThisIsNotAControl, ControlType -> None}, {{
       Hold[$CellContext`maxTimeOut$$], 1, "maxTimeOut (s)"}, 1, 20, 1, 
      ControlType -> Manipulator}}, Typeset`size$$ = {578., {246., 254.}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = False}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`a11$$ = 1, $CellContext`a12$$ = 
        0.8, $CellContext`a21$$ = 1.2, $CellContext`a22$$ = 
        0, $CellContext`gameName$$ = "Snowdrift", $CellContext`initqAA$$ = 
        0.5, $CellContext`initxA$$ = 0.5, $CellContext`k$$ = 
        4, $CellContext`m$$ = 1, $CellContext`maxTimeOut$$ = 
        1, $CellContext`preset$$ = 
        "Hauert Doebeli 2004 fig1b r=0.2", $CellContext`showMD$$ = 
        True, $CellContext`update$$ = 0, $CellContext`updateRule$$ = 
        "Imitative pairwise difference"}, "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`\[Rho]A$, $CellContext`\[Rho]B$, \
$CellContext`qAA$, $CellContext`xAA$, $CellContext`qAB$, $CellContext`qBA$, \
$CellContext`payoffs$, $CellContext`initialxA$, $CellContext`initialqAA$, \
$CellContext`rulesToAddt$, $CellContext`t$, $CellContext`maxTime$ = 
         100000, $CellContext`tolerance$ = 
         10^(-8), $CellContext`accuracyGoal$ = 
         6, $CellContext`maxDiff$, $CellContext`mR$, $CellContext`errorPA$ = 
         False, $CellContext`errorMD$ = False, $CellContext`tooLong$ = 
         False, $CellContext`limitingxPA$, $CellContext`limitingqPA$, \
$CellContext`limitingxMD$, $CellContext`epsilon$ = 
         10^(-4)}, $CellContext`payoffs$ = 
         Rationalize[{$CellContext`a11$$, $CellContext`a12$$, \
$CellContext`a21$$, $CellContext`a22$$}, 
           0]; {$CellContext`initialxA$, $CellContext`initialqAA$} = 
         Rationalize[{$CellContext`initxA$$, $CellContext`initqAA$$}, 
           0]; $CellContext`actualFinalTimePA = $CellContext`maxTime$; \
$CellContext`actualFinalTimeMD = $CellContext`maxTime$; $CellContext`xAA$ = \
$CellContext`\[Rho]A$ $CellContext`qAA$; $CellContext`\[Rho]B$ = 
         1 - $CellContext`\[Rho]A$; $CellContext`qBA$ = 
         1 - $CellContext`qAA$; $CellContext`qAB$ = ($CellContext`\[Rho]A$/(
           1 - $CellContext`\[Rho]A$)) (
           1 - $CellContext`qAA$); $CellContext`maxDiff$ = Max[
           Outer[Subtract, $CellContext`payoffs$, $CellContext`payoffs$]]; 
        If[$CellContext`maxDiff$ == 0, $CellContext`maxDiff$ = 
          1]; $CellContext`mR$ = 
         Rationalize[$CellContext`m$$, 0]; $CellContext`rulesToAddt$ = {
          Derivative[1][$CellContext`\[Rho]A$] -> 
           Derivative[
            1][$CellContext`\[Rho]A$][$CellContext`t$], $CellContext`\[Rho]A$ -> \
$CellContext`\[Rho]A$[$CellContext`t$], $CellContext`qAA$ -> \
$CellContext`qAA$[$CellContext`t$]}; 
        Derivative[
          1][$CellContext`xAA$] = $CellContext`\[Rho]B$ 
           Sum[$CellContext`PB[$CellContext`kA, $CellContext`k$$, \
$CellContext`qAB$] $CellContext`FB[$CellContext`kA, $CellContext`k$$, \
$CellContext`maxDiff$, $CellContext`mR$, $CellContext`payoffs$, \
$CellContext`qAA$, $CellContext`qAB$] (
              2 ($CellContext`kA/$CellContext`k$$)), {$CellContext`kA, 
              0, $CellContext`k$$}] - $CellContext`\[Rho]A$ 
          Sum[$CellContext`PA[$CellContext`kA, $CellContext`k$$, \
$CellContext`qAA$] $CellContext`FA[$CellContext`kA, $CellContext`k$$, \
$CellContext`maxDiff$, $CellContext`mR$, $CellContext`payoffs$, \
$CellContext`qAA$, $CellContext`qAB$] (
             2 ($CellContext`kA/$CellContext`k$$)), {$CellContext`kA, 
             0, $CellContext`k$$}]; $CellContext`pairApproximationSolution = 
         Block[{$MaxExtraPrecision = 1000}, 
           TimeConstrained[
            Quiet[
             Check[
              
              NDSolveValue[{
               Derivative[1][$CellContext`\[Rho]A$][$CellContext`t$] == 
                ReplaceAll[$CellContext`\[Rho]B$ 
                   Sum[$CellContext`PB[$CellContext`kA, $CellContext`k$$, \
$CellContext`qAB$] $CellContext`FB[$CellContext`kA, $CellContext`k$$, \
$CellContext`maxDiff$, $CellContext`mR$, $CellContext`payoffs$, \
$CellContext`qAA$, $CellContext`qAB$], {$CellContext`kA, 
                    0, $CellContext`k$$}] - $CellContext`\[Rho]A$ 
                  Sum[$CellContext`PA[$CellContext`kA, $CellContext`k$$, \
$CellContext`qAA$] $CellContext`FA[$CellContext`kA, $CellContext`k$$, \
$CellContext`maxDiff$, $CellContext`mR$, $CellContext`payoffs$, \
$CellContext`qAA$, $CellContext`qAB$], {$CellContext`kA, 
                    0, $CellContext`k$$}], $CellContext`rulesToAddt$], 
                Derivative[1][$CellContext`qAA$][$CellContext`t$] == 
                ReplaceAll[
                 Derivative[
                    1][$CellContext`xAA$]/$CellContext`\[Rho]A$ - \
($CellContext`xAA$/$CellContext`\[Rho]A$^2) 
                  Derivative[
                   1][$CellContext`\[Rho]A$], $CellContext`rulesToAddt$], \
$CellContext`\[Rho]A$[0] == $CellContext`initialxA$, $CellContext`qAA$[
                 0] == $CellContext`initialqAA$, 
                WhenEvent[{Norm[{
                    Derivative[1][$CellContext`\[Rho]A$][$CellContext`t$], 
                    Derivative[
                    1][$CellContext`qAA$][$CellContext`t$]}] - \
$CellContext`tolerance$ < 0}, 
                 "StopIntegration"; $CellContext`actualFinalTimePA = \
$CellContext`t$]}, {$CellContext`\[Rho]A$, $CellContext`qAA$}, \
{$CellContext`t$, 0, $CellContext`maxTime$}, 
               AccuracyGoal -> $CellContext`accuracyGoal$, MaxSteps -> 
               Infinity, WorkingPrecision -> 20, 
               Method -> {
                "TimeIntegration" -> "StiffnessSwitching", 
                 "EquationSimplification" -> {
                  "Solve", "TimeConstraint" -> 10}}], $CellContext`errorPA$ = 
               True; $CellContext`actualFinalTimePA = 
               10; {-1& , -1& }]], $CellContext`maxTimeOut$$]]; 
        If[$CellContext`pairApproximationSolution === $Aborted, \
$CellContext`tooLong$ = 
           True; $CellContext`pairApproximationSolution = {-1& , -1& }; \
$CellContext`actualFinalTimePA = 0; Null]; $CellContext`actualFinalTimeMD = 
         Max[10, $CellContext`actualFinalTimePA]; \
$CellContext`meanDynamicSolution = 
         If[$CellContext`updateRule$$ != "Imitate if better, all nbrs", 
           Quiet[
            Check[
             
             NDSolveValue[{
              Derivative[1][$CellContext`\[Rho]A$][$CellContext`t$] == 
               ReplaceAll[
                 $CellContext`ExpectedChange[$CellContext`maxDiff$, \
$CellContext`mR$, $CellContext`payoffs$, $CellContext`\[Rho]A$], \
$CellContext`rulesToAddt$], $CellContext`\[Rho]A$[
                0] == $CellContext`initialxA$, 
               WhenEvent[Abs[
                   Derivative[
                   1][$CellContext`\[Rho]A$][$CellContext`t$]] - \
$CellContext`tolerance$ < 0, 
                "StopIntegration"; $CellContext`actualFinalTimeMD = \
$CellContext`t$]}, $CellContext`\[Rho]A$, {$CellContext`t$, 
               0, $CellContext`maxTime$}, 
              AccuracyGoal -> $CellContext`accuracyGoal$, MaxSteps -> 
              Infinity, 
              Method -> {
               "StiffnessSwitching", "DiscontinuityProcessing" -> 
                False}], $CellContext`errorMD$ = 
              True; $CellContext`actualFinalTimeMD = 
              10; -1& ]], -1& ]; \
$CellContext`meanDynamicSolutionImitateIfBetterAllNbrs = \
$CellContext`MDsolutionImitateIfBetterAllNbrs[$CellContext`initialxA$, \
$CellContext`payoffs$]; $CellContext`update$$; $CellContext`actualFinalTime = 
         Max[$CellContext`actualFinalTimePA, $CellContext`actualFinalTimeMD]; \
$CellContext`limitingxPA$ = Chop[
           
           First[$CellContext`pairApproximationSolution][$CellContext`\
actualFinalTime], 10^(-5)]; $CellContext`limitingqPA$ = Chop[
           
           Last[$CellContext`pairApproximationSolution][$CellContext`\
actualFinalTime], 
           10^(-5)]; $CellContext`limitingxMD$ = \
$CellContext`meanDynamicSolution[$CellContext`actualFinalTime]; If[
          
          And[$CellContext`updateRule$$ != 
           "Imitate if better, all nbrs", $CellContext`showMD$$, 
           Not[
           0 - $CellContext`epsilon$ <= $CellContext`limitingxMD$ <= 
            1 + $CellContext`epsilon$]], $CellContext`errorMD$ = 
           True; $CellContext`meanDynamicSolution = -1& ; Null]; Pane[
          Grid[{{
             Item[
              Manipulate[
               Plot[{
                 Evaluate[
                  MapThread[Tooltip, {
                    
                    Map[#[$CellContext`t2]& , \
$CellContext`pairApproximationSolution], {"\[Rho]A", "qAA"}}]], 
                 Evaluate[
                  Tooltip[
                   If[$CellContext`showMD$$, 
                    
                    If[$CellContext`updateRule$$ == 
                    "Imitate if better, all nbrs", 
                    $CellContext`meanDynamicSolutionImitateIfBetterAllNbrs[$\
CellContext`t2], 
                    $CellContext`meanDynamicSolution[$CellContext`t2]], -1], 
                   "MD"]]}, {$CellContext`t2, 
                 0, $CellContext`actualFinalTime/$CellContext`z^2}, 
                PlotLegends -> LineLegend[{
                   Directive[
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[2]], 
                   Directive[
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[2]], 
                   Directive[
                    If[$CellContext`showMD$$, Black, White], 
                    AbsoluteThickness[2], Dashed]}, 
                  
                  If[$CellContext`showMD$$, {
                   "\!\(\*SubscriptBox[\(x\), \(A\)]\)", 
                    "\!\(\*SubscriptBox[\(q\), \(AA\)]\)", "MD"}, {
                   "\!\(\*SubscriptBox[\(x\), \(A\)]\)", 
                    "\!\(\*SubscriptBox[\(q\), \(AA\)]\)", ""}]], ImageSize -> 
                Medium, PlotRange -> {{0, Automatic}, {-0.01, 1.01}}, 
                AxesLabel -> {
                 "\!\(\*StyleBox[\"t\",FontSlant->\"Italic\"]\)", None}, 
                PlotStyle -> {
                  Directive[
                   RGBColor[0.368417, 0.506779, 0.709798], 
                   AbsoluteThickness[2]], 
                  Directive[
                   RGBColor[0.880722, 0.611041, 0.142051], 
                   AbsoluteThickness[2]], 
                  Directive[Black, 
                   AbsoluteThickness[2], Dashed]}, ImageSize -> 
                450], {{$CellContext`z, 1, "zoom"}, 1, 100}, 
               SynchronousUpdating -> True, ContinuousAction -> True, 
               AppearanceElements -> None, Paneled -> False], Alignment -> 
              Center], SpanFromLeft, SpanFromLeft}, {
             If[
              Or[
               And[
                Not[$CellContext`errorPA$], 
                Not[$CellContext`tooLong$]], 
               And[$CellContext`showMD$$, 
                Not[$CellContext`errorMD$]]], 
              
              Row[{"Numerical integration stopped at \
\!\(\*StyleBox[\"t\",FontSlant->\"Italic\"]\)=", 
                ScientificForm[
                 N[
                  Floor[$CellContext`actualFinalTime]], 3], " because ", 
                
                If[$CellContext`actualFinalTime < $CellContext`maxTime$, 
                 "all computed values stabilized at that time", 
                 "that is the maximum time set for integration"]}], ""], 
             SpanFromLeft, SpanFromLeft}, {}, {
             Style["Pair Approximation", Black, 14], "", 
             If[$CellContext`showMD$$, 
              Style["Mean Dynamic (MD)", Black, 14], ""]}, {
             If[$CellContext`errorPA$, 
              Style["Numerical instability", Red, 12], 
              If[$CellContext`tooLong$, 
               Style["Solving the pair approximation", Red, 12], 
               Style[
                
                Row[{"\!\(\*SubscriptBox[StyleBox[\"x\",FontSlant->\"Italic\"]\
, \"A\"]\)(\!\(\*StyleBox[\"t\",FontSlant->\"Italic\"]\)=", 
                  ScientificForm[
                   N[
                    Floor[$CellContext`actualFinalTime]], 3], ") = ", 
                  NumberForm[$CellContext`limitingxPA$, 3]}], 
                Darker[Blue], 12]]], "", 
             If[$CellContext`showMD$$, 
              If[$CellContext`errorMD$, 
               Style["Numerical instability", Red, 12], 
               Style[
                
                Row[{"\!\(\*SubscriptBox[StyleBox[\"x\",FontSlant->\"Italic\"]\
, \"A\"]\)(\!\(\*StyleBox[\"t\",FontSlant->\"Italic\"]\)=", 
                  ScientificForm[
                   N[
                    Floor[$CellContext`actualFinalTime]], 3], ") = ", 
                  NumberForm[
                   Chop[
                    
                    If[$CellContext`updateRule$$ == 
                    "Imitate if better, all nbrs", 
                    Quiet[
                    N[
                    $CellContext`meanDynamicSolutionImitateIfBetterAllNbrs[$\
CellContext`actualFinalTime]]], $CellContext`limitingxMD$], 10^(-5)], 3]}], 
                Black, 12]], ""]}, {
             If[$CellContext`errorPA$, 
              Style["Please, try changing the initial conditions", Black, 10], 
              If[$CellContext`tooLong$, 
               
               Style[("takes longer than maxTimeOut = " <> 
                 ToString[$CellContext`maxTimeOut$$]) <> "s.", Red, 12], 
               Style[
                
                Row[{"\!\(\*SubscriptBox[StyleBox[\"q\",FontSlant->\"Italic\"]\
, \"AA\"]\)(\!\(\*StyleBox[\"t\",FontSlant->\"Italic\"]\)=", 
                  ScientificForm[
                   N[
                    Floor[$CellContext`actualFinalTime]], 3], ") = ", 
                  NumberForm[$CellContext`limitingqPA$, 3]}], 
                Darker[Orange], 12]]], "", 
             If[
              And[$CellContext`showMD$$, $CellContext`errorMD$], 
              Style["Please, try changing initial cond.", Black, 10], ""]}}, 
           Alignment -> {{Left, Center, Right}}]]], 
      "Specifications" :> {{{$CellContext`preset$$, 
          "Hauert Doebeli 2004 fig1b r=0.2"}, ControlType -> 
         None}, {{$CellContext`a11$$, 1}, ControlType -> 
         None}, {{$CellContext`a12$$, 0.8}, ControlType -> 
         None}, {{$CellContext`a21$$, 1.2}, ControlType -> 
         None}, {{$CellContext`a22$$, 0}, ControlType -> 
         None}, {{$CellContext`gameName$$, "Snowdrift"}, ControlType -> 
         None}, {{$CellContext`k$$, 4}, ControlType -> 
         None}, {{$CellContext`update$$, 0}, 0, 100, ControlType -> 
         None}, {{$CellContext`updateRule$$, "Imitative pairwise difference"},
          ControlType -> None}, {{$CellContext`m$$, 1}, ControlType -> 
         None}, {{$CellContext`initxA$$, 0.5}, ControlType -> 
         None}, {{$CellContext`initqAA$$, 0.5}, ControlType -> 
         None}, {{$CellContext`showMD$$, True}, ControlType -> 
         None}, {{$CellContext`maxTimeOut$$, 1}, ControlType -> None}, 
        Style["Presets for replication", Bold, Medium], 
        Row[{
          ActionMenu[
           Dynamic[$CellContext`preset$$], {
           "Hauert & Doebeli (2004)" -> {
             "fig1b r=0.2" :> ($CellContext`a11$$ = 1; $CellContext`a12$$ = 
                0.8; $CellContext`a21$$ = 1.2; $CellContext`a22$$ = 
                0; $CellContext`update$$ = 1000; $CellContext`gameName$$ = 
                "Snowdrift"; $CellContext`updateRule$$ = 
                "Imitative pairwise difference"; $CellContext`k$$ = 
                4; $CellContext`initxA$$ = 0.5; $CellContext`initqAA$$ = 
                0.5; $CellContext`showMD$$ = True; $CellContext`preset$$ = 
                "Hauert Doebeli 2004 fig1b r=0.2"), 
              "fig1b r=0.5" :> ($CellContext`a11$$ = 1; $CellContext`a12$$ = 
                0.5; $CellContext`a21$$ = 1.5; $CellContext`a22$$ = 
                0; $CellContext`update$$ = 2000; $CellContext`gameName$$ = 
                "Snowdrift"; $CellContext`updateRule$$ = 
                "Imitative pairwise difference"; $CellContext`k$$ = 
                4; $CellContext`initxA$$ = 0.5; $CellContext`initqAA$$ = 
                0.5; $CellContext`showMD$$ = True; $CellContext`preset$$ = 
                "Hauert Doebeli 2004 fig1b r=0.5"), 
              "fig1b r=0.9" :> ($CellContext`a11$$ = 1; $CellContext`a12$$ = 
                0.1; $CellContext`a21$$ = 1.9; $CellContext`a22$$ = 
                0; $CellContext`update$$ = 3000; $CellContext`gameName$$ = 
                "Snowdrift"; $CellContext`updateRule$$ = 
                "Imitative pairwise difference"; $CellContext`k$$ = 
                4; $CellContext`initxA$$ = 0.5; $CellContext`initqAA$$ = 
                0.5; $CellContext`showMD$$ = True; $CellContext`preset$$ = 
                "Hauert Doebeli 2004 fig1b r=0.9"), Delimiter, 
              "fig1d r=0.2" :> ($CellContext`a11$$ = 1; $CellContext`a12$$ = 
                0.8; $CellContext`a21$$ = 1.2; $CellContext`a22$$ = 
                0; $CellContext`update$$ = 5000; $CellContext`gameName$$ = 
                "Snowdrift"; $CellContext`updateRule$$ = 
                "Imitative pairwise difference"; $CellContext`k$$ = 
                8; $CellContext`initxA$$ = 0.5; $CellContext`initqAA$$ = 
                0.5; $CellContext`showMD$$ = True; $CellContext`preset$$ = 
                "Hauert Doebeli 2004 fig1d r=0.2"), 
              "fig1d r=0.5" :> ($CellContext`a11$$ = 1; $CellContext`a12$$ = 
                0.5; $CellContext`a21$$ = 1.5; $CellContext`a22$$ = 
                0; $CellContext`update$$ = 6000; $CellContext`gameName$$ = 
                "Snowdrift"; $CellContext`updateRule$$ = 
                "Imitative pairwise difference"; $CellContext`k$$ = 
                8; $CellContext`initxA$$ = 0.5; $CellContext`initqAA$$ = 
                0.5; $CellContext`showMD$$ = True; $CellContext`preset$$ = 
                "Hauert Doebeli 2004 fig1d r=0.5"), 
              "fig1d r=0.9" :> ($CellContext`a11$$ = 1; $CellContext`a12$$ = 
                0.1; $CellContext`a21$$ = 1.9; $CellContext`a22$$ = 
                0; $CellContext`update$$ = 7000; $CellContext`gameName$$ = 
                "Snowdrift"; $CellContext`updateRule$$ = 
                "Imitative pairwise difference"; $CellContext`k$$ = 
                8; $CellContext`initxA$$ = 0.5; $CellContext`initqAA$$ = 
                0.5; $CellContext`showMD$$ = True; $CellContext`preset$$ = 
                "Hauert Doebeli 2004 fig1d r=0.9")}, 
            "Hauert & Szab\[OAcute] (2005)" -> {
             "fig5 r=0" :> ($CellContext`a11$$ = 1; $CellContext`a12$$ = 
                0; $CellContext`a21$$ = 1; $CellContext`a22$$ = 
                0; $CellContext`update$$ = 15500; $CellContext`gameName$$ = 
                "Weak Prisoner's D"; $CellContext`updateRule$$ = 
                "Fermi (set intensity \
\!\(\*StyleBox[\"m\",FontSlant->\"Italic\"]\))"; $CellContext`k$$ = 
                4; $CellContext`m$$ = 40; $CellContext`initxA$$ = 
                0.5; $CellContext`initqAA$$ = 0.5; $CellContext`showMD$$ = 
                False; $CellContext`maxTimeOut$$ = 20; $CellContext`preset$$ = 
                "Hauert Szab\[OAcute] 2005 fig5 r=0.01"), 
              "fig5 r=0.01" :> ($CellContext`a11$$ = 
                1; $CellContext`a12$$ = -0.01; $CellContext`a21$$ = 
                1.01; $CellContext`a22$$ = 0; $CellContext`update$$ = 
                16000; $CellContext`gameName$$ = 
                "Prisoner's Dilemma"; $CellContext`updateRule$$ = 
                "Fermi (set intensity \
\!\(\*StyleBox[\"m\",FontSlant->\"Italic\"]\))"; $CellContext`k$$ = 
                4; $CellContext`m$$ = 40; $CellContext`initxA$$ = 
                0.5; $CellContext`initqAA$$ = 0.5; $CellContext`showMD$$ = 
                False; $CellContext`maxTimeOut$$ = 20; $CellContext`preset$$ = 
                "Hauert Szab\[OAcute] 2005 fig5 r=0.01"), 
              "fig5 r=0.02" :> ($CellContext`a11$$ = 
                1; $CellContext`a12$$ = -0.02; $CellContext`a21$$ = 
                1.02; $CellContext`a22$$ = 0; $CellContext`update$$ = 
                17000; $CellContext`gameName$$ = 
                "Prisoner's Dilemma"; $CellContext`updateRule$$ = 
                "Fermi (set intensity \
\!\(\*StyleBox[\"m\",FontSlant->\"Italic\"]\))"; $CellContext`k$$ = 
                4; $CellContext`m$$ = 40; $CellContext`initxA$$ = 
                0.5; $CellContext`initqAA$$ = 0.5; $CellContext`showMD$$ = 
                False; $CellContext`maxTimeOut$$ = 20; $CellContext`preset$$ = 
                "Hauert Szab\[OAcute] 2005 fig5 r=0.02"), 
              "fig5 r=0.06" :> ($CellContext`a11$$ = 
                1; $CellContext`a12$$ = -0.06; $CellContext`a21$$ = 
                1.06; $CellContext`a22$$ = 0; $CellContext`update$$ = 
                18000; $CellContext`gameName$$ = 
                "Prisoner's Dilemma"; $CellContext`updateRule$$ = 
                "Fermi (set intensity \
\!\(\*StyleBox[\"m\",FontSlant->\"Italic\"]\))"; $CellContext`k$$ = 
                4; $CellContext`m$$ = 40; $CellContext`initxA$$ = 
                0.5; $CellContext`initqAA$$ = 0.5; $CellContext`showMD$$ = 
                False; $CellContext`maxTimeOut$$ = 20; $CellContext`preset$$ = 
                "Hauert Szab\[OAcute] 2005 fig5 r=0.02")}, 
            "Fu, Nowak & Hauert (2010)" -> {
             "fig4a,b u=0.02" :> ($CellContext`a11$$ = 1; $CellContext`a12$$ = 
                0; $CellContext`a21$$ = 1.02; $CellContext`a22$$ = 
                0.02; $CellContext`update$$ = 8000; $CellContext`gameName$$ = 
                "Prisoner's Dilemma"; $CellContext`updateRule$$ = 
                "Imitative pairwise difference"; $CellContext`k$$ = 
                8; $CellContext`initxA$$ = 0.01; $CellContext`initqAA$$ = 
                0.7; $CellContext`showMD$$ = False; $CellContext`preset$$ = 
                "Fu et al 2010 fig4ab u=0.02"), 
              "fig4a,b u=0.1" :> ($CellContext`a11$$ = 1; $CellContext`a12$$ = 
                0; $CellContext`a21$$ = 1.1; $CellContext`a22$$ = 
                0.1; $CellContext`update$$ = 9000; $CellContext`gameName$$ = 
                "Prisoner's Dilemma"; $CellContext`updateRule$$ = 
                "Imitative pairwise difference"; $CellContext`k$$ = 
                8; $CellContext`initxA$$ = 0.01; $CellContext`initqAA$$ = 
                0.7; $CellContext`showMD$$ = False; $CellContext`preset$$ = 
                "Fu et al 2010 fig4ab u=0.1"), Delimiter, 
              "fig4d,e v=0.05" :> ($CellContext`a11$$ = 1; $CellContext`a12$$ = 
                0.95; $CellContext`a21$$ = 1.05; $CellContext`a22$$ = 
                0; $CellContext`update$$ = 10000; $CellContext`gameName$$ = 
                "Snowdrift"; $CellContext`updateRule$$ = 
                "Imitative pairwise difference"; $CellContext`k$$ = 
                8; $CellContext`initxA$$ = 0.01; $CellContext`initqAA$$ = 
                0.7; $CellContext`showMD$$ = False; $CellContext`preset$$ = 
                "Fu et al 2010 fig4de v=0.05"), 
              "fig4d,e v=0.4" :> ($CellContext`a11$$ = 1; $CellContext`a12$$ = 
                0.6; $CellContext`a21$$ = 1.4; $CellContext`a22$$ = 
                0; $CellContext`update$$ = 11000; $CellContext`gameName$$ = 
                "Snowdrift"; $CellContext`updateRule$$ = 
                "Imitative pairwise difference"; $CellContext`k$$ = 
                8; $CellContext`initxA$$ = 0.01; $CellContext`initqAA$$ = 
                0.7; $CellContext`showMD$$ = False; $CellContext`preset$$ = 
                "Fu et al 2010 fig4de v=0.4"), Delimiter, 
              "fig6a u=0.05" :> ($CellContext`a11$$ = 1; $CellContext`a12$$ = 
                0; $CellContext`a21$$ = 1.05; $CellContext`a22$$ = 
                0.05; $CellContext`update$$ = 12000; $CellContext`gameName$$ = 
                "Prisoner's Dilemma"; $CellContext`updateRule$$ = 
                "Imitative pairwise difference"; $CellContext`k$$ = 
                8; $CellContext`initxA$$ = 0.01; $CellContext`initqAA$$ = 
                0.7; $CellContext`showMD$$ = True; $CellContext`preset$$ = 
                "Fu et al 2010 fig6a u=0.05"), 
              "fig6a u=0.15" :> ($CellContext`a11$$ = 1; $CellContext`a12$$ = 
                0; $CellContext`a21$$ = 1.15; $CellContext`a22$$ = 
                0.15; $CellContext`update$$ = 13000; $CellContext`gameName$$ = 
                "Prisoner's Dilemma"; $CellContext`updateRule$$ = 
                "Imitative pairwise difference"; $CellContext`k$$ = 
                8; $CellContext`initxA$$ = 0.01; $CellContext`initqAA$$ = 
                0.7; $CellContext`showMD$$ = True; $CellContext`preset$$ = 
                "Fu et al 2010 fig6a u=0.15"), Delimiter, 
              "fig6c v=0.5" :> ($CellContext`a11$$ = 1; $CellContext`a12$$ = 
                0.5; $CellContext`a21$$ = 1.5; $CellContext`a22$$ = 
                0; $CellContext`update$$ = 14000; $CellContext`gameName$$ = 
                "Snowdrift"; $CellContext`updateRule$$ = 
                "Imitative pairwise difference"; $CellContext`k$$ = 
                8; $CellContext`initxA$$ = 0.01; $CellContext`initqAA$$ = 
                0.7; $CellContext`showMD$$ = True; $CellContext`preset$$ = 
                "Fu et al 2010 fig6c v=0.5"), 
              "fig6c v=1" :> ($CellContext`a11$$ = 1; $CellContext`a12$$ = 
                0; $CellContext`a21$$ = 2; $CellContext`a22$$ = 
                0; $CellContext`update$$ = 15000; $CellContext`gameName$$ = 
                "Snowdrift"; $CellContext`updateRule$$ = 
                "Imitative pairwise difference"; $CellContext`k$$ = 
                8; $CellContext`initxA$$ = 0.01; $CellContext`initqAA$$ = 
                0.7; $CellContext`showMD$$ = True; $CellContext`preset$$ = 
                "Fu et al 2010 fig6c v=1")}}, Appearance -> "PopupMenu", 
           ImageSize -> {220, 20}]}, ImageSize -> 220, Alignment -> Center], 
        Delimiter, 
        Style[
        "Payoffs (\!\(\*SubscriptBox[\(\[CapitalPi]\), \(ij\)]\))", Bold, 
         Medium], 
        Row[{
          ActionMenu[
           Dynamic[$CellContext`gameName$$], {
           "Snowdrift" :> {$CellContext`a11$$ = 3, $CellContext`a12$$ = 
              1, $CellContext`a21$$ = 4, $CellContext`a22$$ = 
              0, $CellContext`update$$ = 500; $CellContext`gameName$$ = 
               "Snowdrift", $CellContext`preset$$ = "Presets"}, 
            "Prisoner's Dilemma" :> {$CellContext`a11$$ = 
              3, $CellContext`a12$$ = 0, $CellContext`a21$$ = 
              4, $CellContext`a22$$ = 
              1, $CellContext`update$$ = 1000; $CellContext`gameName$$ = 
               "Prisoner's Dilemma", $CellContext`preset$$ = "Presets"}, 
            "Coordination" :> {$CellContext`a11$$ = 2, $CellContext`a12$$ = 
              0, $CellContext`a21$$ = 0, $CellContext`a22$$ = 
              1, $CellContext`update$$ = 2000; $CellContext`gameName$$ = 
               "Coordination", $CellContext`preset$$ = "Presets"}, 
            "All 0s" :> {$CellContext`a11$$ = 0, $CellContext`a12$$ = 
              0, $CellContext`a21$$ = 0, $CellContext`a22$$ = 
              0, $CellContext`update$$ = 3000; $CellContext`gameName$$ = 
               "All 0s", $CellContext`preset$$ = "Presets"}}, Appearance -> 
           "PopupMenu", ImageSize -> {150, 20}]}, ImageSize -> 180, Alignment -> 
         Center], {{$CellContext`a11$$, 1, 
          "\!\(\*SubscriptBox[\(\[CapitalPi]\), \
\(\(A\)\(\[CenterDot]\)\)]\)"}, 
         Dynamic[InputField[
           
           Dynamic[$CellContext`a11$$, ($CellContext`a11$$ = \
$CellContext`ForceNumber[#])& ], Number, FieldSize -> 4]& ], ControlPlacement -> 
         1}, {{$CellContext`a12$$, 0.8, ""}, 
         Dynamic[InputField[
           
           Dynamic[$CellContext`a12$$, ($CellContext`a12$$ = \
$CellContext`ForceNumber[#])& ], Number, FieldSize -> 4]& ], ControlPlacement -> 
         2}, {{$CellContext`a21$$, 1.2, 
          "\!\(\*SubscriptBox[\(\[CapitalPi]\), \
\(\(B\)\(\[CenterDot]\)\)]\)"}, 
         Dynamic[InputField[
           
           Dynamic[$CellContext`a21$$, ($CellContext`a21$$ = \
$CellContext`ForceNumber[#])& ], Number, FieldSize -> 4]& ], ControlPlacement -> 
         3}, {{$CellContext`a22$$, 0, ""}, 
         Dynamic[InputField[
           
           Dynamic[$CellContext`a22$$, ($CellContext`a22$$ = \
$CellContext`ForceNumber[#])& ], Number, FieldSize -> 4]& ], ControlPlacement -> 
         4}, 
        Grid[{{"              ", 
           Manipulate`Place[1], 
           Manipulate`Place[2]}, {"", 
           Manipulate`Place[3], 
           Manipulate`Place[4]}}, Alignment -> Right], 
        Button[
        "Update", 
         Increment[$CellContext`update$$]; $CellContext`gameName$$ = 
          "Predefined games"; $CellContext`preset$$ = "Presets", ImageSize -> 
         180], Delimiter, 
        Style[
        "Degree of regular network", Bold, 
         Medium], {{$CellContext`k$$, 8, 
          "\!\(\*StyleBox[\"k\",FontSlant->\"Italic\"]\)"}, 2, 10, 1, 
         ImageSize -> Small, Appearance -> "Labeled"}, 
        Delimiter, {{$CellContext`updateRule$$, 
          "Imitative pairwise difference", ""}, {
         "Imitative pairwise difference", "Imitate if better, all nbrs", 
          "Fermi (set intensity \
\!\(\*StyleBox[\"m\",FontSlant->\"Italic\"]\))", "Best neighbor"}, 
         ControlType -> PopupMenu, MenuStyle -> 12, ControlPlacement -> 5}, 
        Grid[{{
           Style["Decision rule", Bold, Medium]}, {
           Manipulate`Place[5]}}, Alignment -> 
         Left], {{$CellContext`m$$, 1, 
          "Fermi's \!\(\*StyleBox[\"m\",FontSlant->\"Italic\"]\)"}, 0.5, 40, 
         0.01, ImageSize -> Small, Appearance -> "Labeled"}, Delimiter, 
        Style[
        "Initial conditions", Bold, 
         Medium], {{$CellContext`initxA$$, 0.5, 
          "\!\(\*SubscriptBox[StyleBox[\"x\",FontSlant->\"Italic\"], \"A\"]\)\
\!\(\*StyleBox[\"(\",FontWeight->\"Plain\"]\)\!\(\*StyleBox[\"0\",FontWeight->\
\"Plain\"]\)\!\(\*StyleBox[\")\",FontWeight->\"Plain\"]\)"}, 0.01, 0.99, 0.01,
          ImageSize -> Small, Appearance -> 
         "Labeled"}, {{$CellContext`initqAA$$, 0.5, 
          "\!\(\*SubscriptBox[StyleBox[\"q\",FontSlant->\"Italic\"], \
\"AA\"]\)\!\(\*StyleBox[\"(\",FontWeight->\"Plain\"]\)\!\(\*StyleBox[\"0\",\
FontWeight->\"Plain\"]\)\!\(\*StyleBox[\")\",FontWeight->\"Plain\"]\)"}, 0.01,
          0.99, 0.01, ImageSize -> Small, Appearance -> "Labeled"}, Delimiter, 
        Style[
        "Mean Dynamic (MD)", Bold, 
         Medium], {{$CellContext`showMD$$, True, "Show MD"}, {True, False}, 
         ImageSize -> Small, Appearance -> "Labeled"}, Delimiter, 
        Style[
        "Time allowed for computations", Bold, 
         Medium], {{$CellContext`maxTimeOut$$, 1, "maxTimeOut (s)"}, 1, 20, 1,
          ImageSize -> Small, Appearance -> "Labeled"}}, 
      "Options" :> {
       TrackedSymbols :> {$CellContext`update$$, $CellContext`updateRule$$, \
$CellContext`k$$, $CellContext`m$$, $CellContext`initxA$$, \
$CellContext`initqAA$$, $CellContext`showMD$$, $CellContext`maxTimeOut$$}, 
        Alignment -> Top, ControlPlacement -> Left, SynchronousUpdating -> 
        False, ContinuousAction -> True, AppearanceElements -> None}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{1200., {302., 310.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    Initialization:>({$CellContext`maxTime = 100000, $CellContext`limitingxPA = 
       0.00004, $CellContext`actualFinalTimePA = 
       115.61973684384570856239663723798541004744`20., \
$CellContext`actualFinalTimeMD = 
       115.61973684384570856239663723798541004744`20., $CellContext`PB[
         Pattern[$CellContext`kA, 
          Blank[]], 
         Pattern[$CellContext`k, 
          Blank[]], 
         Pattern[$CellContext`qAB, 
          Blank[]]] := 
       Binomial[$CellContext`k, $CellContext`kA] \
$CellContext`qAB^$CellContext`kA (
          1 - $CellContext`qAB)^($CellContext`k - $CellContext`kA), \
$CellContext`FB[
         Pattern[$CellContext`kA$, 
          Blank[]], 
         Pattern[$CellContext`k$, 
          Blank[]], 
         Pattern[$CellContext`maxDiff$, 
          Blank[]], 
         Pattern[$CellContext`m$, 
          Blank[]], 
         Pattern[$CellContext`payoffs$, 
          Blank[]], 
         Pattern[$CellContext`qAA$, 
          Blank[]], 
         Pattern[$CellContext`qAB$, 
          Blank[]]] := 
       Module[{$CellContext`\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$, \
$CellContext`\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$}, {$CellContext`\
\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$, $CellContext`\[CapitalPi]BA$, \
$CellContext`\[CapitalPi]BB$} = $CellContext`payoffs$; 
         Switch[FE`updateRule$$141, 
           "Imitate if better, all nbrs", ($CellContext`kA$/$CellContext`k$) 
           Sum[
             Piecewise[{{
                $CellContext`PAOneB[$CellContext`i, $CellContext`k$, \
$CellContext`qAA$], $CellContext`\[CapitalPi]A[$CellContext`i, \
$CellContext`k$, $CellContext`\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$] > \
$CellContext`\[CapitalPi]B[$CellContext`kA$, $CellContext`k$, $CellContext`\
\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$]}}, 0], {$CellContext`i, 
              0, $CellContext`k$ - 1}], 
           "Fermi (set intensity \
\!\(\*StyleBox[\"m\",FontSlant->\"Italic\"]\))", \
($CellContext`kA$/$CellContext`k$) 
           Sum[$CellContext`PAOneB[$CellContext`i, $CellContext`k$, \
$CellContext`qAA$] (
              Exp[$CellContext`m$ $CellContext`\[CapitalPi]A[$CellContext`i, \
$CellContext`k$, $CellContext`\[CapitalPi]AA$, \
$CellContext`\[CapitalPi]AB$]]/(
              Exp[$CellContext`m$ \
$CellContext`\[CapitalPi]B[$CellContext`kA$, $CellContext`k$, $CellContext`\
\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$]] + 
              Exp[$CellContext`m$ $CellContext`\[CapitalPi]A[$CellContext`i, \
$CellContext`k$, $CellContext`\[CapitalPi]AA$, \
$CellContext`\[CapitalPi]AB$]])), {$CellContext`i, 0, $CellContext`k$ - 1}], 
           "Imitative pairwise difference", ($CellContext`kA$/$CellContext`k$)
             Sum[$CellContext`PAOneB[$CellContext`i, $CellContext`k$, \
$CellContext`qAA$] \
($CellContext`BePositive[$CellContext`\[CapitalPi]A[$CellContext`i, \
$CellContext`k$, $CellContext`\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$] - \
$CellContext`\[CapitalPi]B[$CellContext`kA$, $CellContext`k$, $CellContext`\
\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$]]/$CellContext`maxDiff$), \
{$CellContext`i, 0, $CellContext`k$ - 1}], "Best neighbor", 
           Switch[$CellContext`kA$, 0, 0, $CellContext`k$, 
            Sum[
             Piecewise[{{
                $CellContext`ProbabilityBestPayoffAmongANbrsBOneA[
                 $CellContext`\[CapitalPi]A[$CellContext`i, $CellContext`k$, \
$CellContext`\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$], \
$CellContext`kA$, $CellContext`k$, $CellContext`payoffs$, $CellContext`qAA$], \
$CellContext`\[CapitalPi]A[$CellContext`i, $CellContext`k$, $CellContext`\
\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$] > \
$CellContext`\[CapitalPi]B[$CellContext`kA$, $CellContext`k$, $CellContext`\
\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$]}}, 0], {$CellContext`i, 
              0, $CellContext`k$ - 1}], 
            Blank[], 
            Sum[
             Piecewise[{{$CellContext`ProbabilityBestPayoffAmongANbrsBOneA[
                  $CellContext`\[CapitalPi]A[$CellContext`i, $CellContext`k$, \
$CellContext`\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$], \
$CellContext`kA$, $CellContext`k$, $CellContext`payoffs$, $CellContext`qAA$] \
$CellContext`StrictCumulativeProbabilityBestPayoffAmongBNbrsBOneB[
                  $CellContext`\[CapitalPi]A[$CellContext`i, $CellContext`k$, \
$CellContext`\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$], \
$CellContext`kA$, $CellContext`k$, $CellContext`payoffs$, $CellContext`qAB$], \
$CellContext`\[CapitalPi]A[$CellContext`i, $CellContext`k$, $CellContext`\
\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$] > \
$CellContext`\[CapitalPi]B[$CellContext`kA$, $CellContext`k$, $CellContext`\
\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$]}}, 0], {$CellContext`i, 
              0, $CellContext`k$ - 1}]]]], 
       Attributes[$CellContext`kA$] = {Temporary}, 
       Attributes[$CellContext`k$] = {Temporary}, 
       Attributes[$CellContext`maxDiff$] = {Temporary}, 
       Attributes[$CellContext`m$] = {Temporary}, 
       Attributes[$CellContext`payoffs$] = {Temporary}, 
       Attributes[$CellContext`qAA$] = {Temporary}, 
       Attributes[$CellContext`qAB$] = {Temporary}, 
       Attributes[$CellContext`\[CapitalPi]AA$] = {Temporary}, 
       Attributes[$CellContext`\[CapitalPi]AB$] = {Temporary}, 
       Attributes[$CellContext`\[CapitalPi]BA$] = {Temporary}, 
       Attributes[$CellContext`\[CapitalPi]BB$] = {
        Temporary}, $CellContext`PAOneB[
         Pattern[$CellContext`kA, 
          Blank[]], 
         Pattern[$CellContext`k, 
          Blank[]], 
         Pattern[$CellContext`qAA, 
          Blank[]]] := 
       Binomial[$CellContext`k - 
          1, $CellContext`kA] $CellContext`qAA^$CellContext`kA (
          1 - $CellContext`qAA)^($CellContext`k - 
          1 - $CellContext`kA), $CellContext`\[CapitalPi]A[
         Pattern[$CellContext`x, 
          Blank[]], 
         Pattern[$CellContext`\[CapitalPi]AA, 
          Blank[]], 
         Pattern[$CellContext`\[CapitalPi]AB, 
          Blank[]]] := $CellContext`x $CellContext`\[CapitalPi]AA + (
          1 - $CellContext`x) $CellContext`\[CapitalPi]AB, $CellContext`\
\[CapitalPi]A[
         Pattern[$CellContext`kA, 
          Blank[]], 
         Pattern[$CellContext`k, 
          Blank[]], 
         Pattern[$CellContext`\[CapitalPi]AA, 
          Blank[]], 
         Pattern[$CellContext`\[CapitalPi]AB, 
          
          Blank[]]] := ($CellContext`kA $CellContext`\[CapitalPi]AA + \
($CellContext`k - $CellContext`kA) \
$CellContext`\[CapitalPi]AB)/$CellContext`k, $CellContext`\[CapitalPi]B[
         Pattern[$CellContext`x, 
          Blank[]], 
         Pattern[$CellContext`\[CapitalPi]BA, 
          Blank[]], 
         Pattern[$CellContext`\[CapitalPi]BB, 
          Blank[]]] := $CellContext`x $CellContext`\[CapitalPi]BA + (
          1 - $CellContext`x) $CellContext`\[CapitalPi]BB, $CellContext`\
\[CapitalPi]B[
         Pattern[$CellContext`kA, 
          Blank[]], 
         Pattern[$CellContext`k, 
          Blank[]], 
         Pattern[$CellContext`\[CapitalPi]BA, 
          Blank[]], 
         Pattern[$CellContext`\[CapitalPi]BB, 
          
          Blank[]]] := ($CellContext`kA $CellContext`\[CapitalPi]BA + \
($CellContext`k - $CellContext`kA) \
$CellContext`\[CapitalPi]BB)/$CellContext`k, $CellContext`BePositive[
         Pattern[$CellContext`x, 
          Blank[]]] := 
       Piecewise[{{
          0, $CellContext`x < 0}, {$CellContext`x, $CellContext`x >= 
           0}}], $CellContext`ProbabilityBestPayoffAmongANbrsBOneA[
         Pattern[$CellContext`x, 
          Blank[]], 
         Pattern[$CellContext`kA, 
          Blank[]], 
         Pattern[$CellContext`k, 
          Blank[]], 
         Pattern[$CellContext`payoffs, 
          Blank[]], 
         Pattern[$CellContext`qAA, 
          
          Blank[]]] := \
$CellContext`CumulativeProbabilityBestPayoffAmongANbrsBOneA[$CellContext`x, \
$CellContext`kA, $CellContext`k, $CellContext`payoffs, $CellContext`qAA] - \
$CellContext`StrictCumulativeProbabilityBestPayoffAmongANbrsBOneA[$\
CellContext`x, $CellContext`kA, $CellContext`k, $CellContext`payoffs, \
$CellContext`qAA], $CellContext`CumulativeProbabilityBestPayoffAmongANbrsBOneA[
         Pattern[$CellContext`x, 
          Blank[]], 
         Pattern[$CellContext`kA, 
          Blank[]], 
         Pattern[$CellContext`k, 
          Blank[]], 
         Pattern[$CellContext`payoffs, 
          Blank[]], 
         Pattern[$CellContext`qAA, 
          Blank[]]] := 
       Module[{$CellContext`\[CapitalPi]AA, $CellContext`\[CapitalPi]AB, \
$CellContext`\[CapitalPi]BA, $CellContext`\[CapitalPi]BB}, {$CellContext`\
\[CapitalPi]AA, $CellContext`\[CapitalPi]AB, $CellContext`\[CapitalPi]BA, \
$CellContext`\[CapitalPi]BB} = $CellContext`payoffs; Sum[
            Piecewise[{{
               $CellContext`PAOneB[$CellContext`i, $CellContext`k, \
$CellContext`qAA], $CellContext`\[CapitalPi]A[$CellContext`i, $CellContext`k, \
$CellContext`\[CapitalPi]AA, $CellContext`\[CapitalPi]AB] <= $CellContext`x}},
              0], {$CellContext`i, 0, $CellContext`k - 
             1}]^$CellContext`kA], \
$CellContext`StrictCumulativeProbabilityBestPayoffAmongANbrsBOneA[
         Pattern[$CellContext`x, 
          Blank[]], 
         Pattern[$CellContext`kA, 
          Blank[]], 
         Pattern[$CellContext`k, 
          Blank[]], 
         Pattern[$CellContext`payoffs, 
          Blank[]], 
         Pattern[$CellContext`qAA, 
          Blank[]]] := 
       Module[{$CellContext`\[CapitalPi]AA, $CellContext`\[CapitalPi]AB, \
$CellContext`\[CapitalPi]BA, $CellContext`\[CapitalPi]BB}, {$CellContext`\
\[CapitalPi]AA, $CellContext`\[CapitalPi]AB, $CellContext`\[CapitalPi]BA, \
$CellContext`\[CapitalPi]BB} = $CellContext`payoffs; Sum[
            Piecewise[{{
               $CellContext`PAOneB[$CellContext`i, $CellContext`k, \
$CellContext`qAA], $CellContext`\[CapitalPi]A[$CellContext`i, $CellContext`k, \
$CellContext`\[CapitalPi]AA, $CellContext`\[CapitalPi]AB] < $CellContext`x}}, 
             0], {$CellContext`i, 0, $CellContext`k - 
             1}]^$CellContext`kA], \
$CellContext`StrictCumulativeProbabilityBestPayoffAmongBNbrsBOneB[
         Pattern[$CellContext`x, 
          Blank[]], 
         Pattern[$CellContext`kA, 
          Blank[]], 
         Pattern[$CellContext`k, 
          Blank[]], 
         Pattern[$CellContext`payoffs, 
          Blank[]], 
         Pattern[$CellContext`qAB, 
          Blank[]]] := 
       Module[{$CellContext`\[CapitalPi]AA, $CellContext`\[CapitalPi]AB, \
$CellContext`\[CapitalPi]BA, $CellContext`\[CapitalPi]BB}, {$CellContext`\
\[CapitalPi]AA, $CellContext`\[CapitalPi]AB, $CellContext`\[CapitalPi]BA, \
$CellContext`\[CapitalPi]BB} = $CellContext`payoffs; Sum[
            Piecewise[{{
               $CellContext`PBOneB[$CellContext`i, $CellContext`k, \
$CellContext`qAB], $CellContext`\[CapitalPi]B[$CellContext`i, $CellContext`k, \
$CellContext`\[CapitalPi]BA, $CellContext`\[CapitalPi]BB] < $CellContext`x}}, 
             0], {$CellContext`i, 0, $CellContext`k - 
             1}]^($CellContext`k - $CellContext`kA)], $CellContext`PBOneB[
         Pattern[$CellContext`kA, 
          Blank[]], 
         Pattern[$CellContext`k, 
          Blank[]], 
         Pattern[$CellContext`qAB, 
          Blank[]]] := 
       Binomial[$CellContext`k - 
          1, $CellContext`kA] $CellContext`qAB^$CellContext`kA (
          1 - $CellContext`qAB)^($CellContext`k - 
          1 - $CellContext`kA), $CellContext`PA[
         Pattern[$CellContext`kA, 
          Blank[]], 
         Pattern[$CellContext`k, 
          Blank[]], 
         Pattern[$CellContext`qAA, 
          Blank[]]] := 
       Binomial[$CellContext`k, $CellContext`kA] \
$CellContext`qAA^$CellContext`kA (
          1 - $CellContext`qAA)^($CellContext`k - $CellContext`kA), \
$CellContext`FA[
         Pattern[$CellContext`kA$, 
          Blank[]], 
         Pattern[$CellContext`k$, 
          Blank[]], 
         Pattern[$CellContext`maxDiff$, 
          Blank[]], 
         Pattern[$CellContext`m$, 
          Blank[]], 
         Pattern[$CellContext`payoffs$, 
          Blank[]], 
         Pattern[$CellContext`qAA$, 
          Blank[]], 
         Pattern[$CellContext`qAB$, 
          Blank[]]] := 
       Module[{$CellContext`\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$, \
$CellContext`\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$}, {$CellContext`\
\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$, $CellContext`\[CapitalPi]BA$, \
$CellContext`\[CapitalPi]BB$} = $CellContext`payoffs$; 
         Switch[FE`updateRule$$141, 
           "Imitate if better, all nbrs", (($CellContext`k$ - \
$CellContext`kA$)/$CellContext`k$) Sum[
             Piecewise[{{
                $CellContext`PBOneA[$CellContext`i, $CellContext`k$, \
$CellContext`qAB$], $CellContext`\[CapitalPi]B[$CellContext`i, \
$CellContext`k$, $CellContext`\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$] > \
$CellContext`\[CapitalPi]A[$CellContext`kA$, $CellContext`k$, $CellContext`\
\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$]}}, 0], {$CellContext`i, 
              1, $CellContext`k$}], 
           "Fermi (set intensity \
\!\(\*StyleBox[\"m\",FontSlant->\"Italic\"]\))", (($CellContext`k$ - \
$CellContext`kA$)/$CellContext`k$) 
           Sum[$CellContext`PBOneA[$CellContext`i, $CellContext`k$, \
$CellContext`qAB$] (
              Exp[$CellContext`m$ $CellContext`\[CapitalPi]B[$CellContext`i, \
$CellContext`k$, $CellContext`\[CapitalPi]BA$, \
$CellContext`\[CapitalPi]BB$]]/(
              Exp[$CellContext`m$ \
$CellContext`\[CapitalPi]A[$CellContext`kA$, $CellContext`k$, $CellContext`\
\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$]] + 
              Exp[$CellContext`m$ $CellContext`\[CapitalPi]B[$CellContext`i, \
$CellContext`k$, $CellContext`\[CapitalPi]BA$, \
$CellContext`\[CapitalPi]BB$]])), {$CellContext`i, 1, $CellContext`k$}], 
           "Imitative pairwise difference", (($CellContext`k$ - \
$CellContext`kA$)/$CellContext`k$) 
           Sum[$CellContext`PBOneA[$CellContext`i, $CellContext`k$, \
$CellContext`qAB$] \
($CellContext`BePositive[$CellContext`\[CapitalPi]B[$CellContext`i, \
$CellContext`k$, $CellContext`\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$] - \
$CellContext`\[CapitalPi]A[$CellContext`kA$, $CellContext`k$, $CellContext`\
\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$]]/$CellContext`maxDiff$), \
{$CellContext`i, 1, $CellContext`k$}], "Best neighbor", 
           Switch[$CellContext`kA$, 0, 
            Sum[
             Piecewise[{{
                $CellContext`ProbabilityBestPayoffAmongBNbrsAOneB[
                 $CellContext`\[CapitalPi]B[$CellContext`i, $CellContext`k$, \
$CellContext`\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$], \
$CellContext`kA$, $CellContext`k$, $CellContext`payoffs$, $CellContext`qAB$], \
$CellContext`\[CapitalPi]B[$CellContext`i, $CellContext`k$, $CellContext`\
\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$] > \
$CellContext`\[CapitalPi]A[$CellContext`kA$, $CellContext`k$, $CellContext`\
\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$]}}, 0], {$CellContext`i, 
              1, $CellContext`k$}], $CellContext`k$, 0, 
            Blank[], 
            Sum[
             Piecewise[{{$CellContext`ProbabilityBestPayoffAmongBNbrsAOneB[
                  $CellContext`\[CapitalPi]B[$CellContext`i, $CellContext`k$, \
$CellContext`\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$], \
$CellContext`kA$, $CellContext`k$, $CellContext`payoffs$, $CellContext`qAB$] \
$CellContext`StrictCumulativeProbabilityBestPayoffAmongANbrsAOneA[
                  $CellContext`\[CapitalPi]B[$CellContext`i, $CellContext`k$, \
$CellContext`\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$], \
$CellContext`kA$, $CellContext`k$, $CellContext`payoffs$, $CellContext`qAA$], \
$CellContext`\[CapitalPi]B[$CellContext`i, $CellContext`k$, $CellContext`\
\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$] > \
$CellContext`\[CapitalPi]A[$CellContext`kA$, $CellContext`k$, $CellContext`\
\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$]}}, 0], {$CellContext`i, 
              1, $CellContext`k$}]]]], $CellContext`PBOneA[
         Pattern[$CellContext`kA, 
          Blank[]], 
         Pattern[$CellContext`k, 
          Blank[]], 
         Pattern[$CellContext`qAB, 
          Blank[]]] := 
       Binomial[$CellContext`k - 1, $CellContext`kA - 
          1] $CellContext`qAB^($CellContext`kA - 1) (
          1 - $CellContext`qAB)^($CellContext`k - $CellContext`kA), \
$CellContext`ProbabilityBestPayoffAmongBNbrsAOneB[
         Pattern[$CellContext`x, 
          Blank[]], 
         Pattern[$CellContext`kA, 
          Blank[]], 
         Pattern[$CellContext`k, 
          Blank[]], 
         Pattern[$CellContext`payoffs, 
          Blank[]], 
         Pattern[$CellContext`qAB, 
          
          Blank[]]] := \
$CellContext`CumulativeProbabilityBestPayoffAmongBNbrsAOneB[$CellContext`x, \
$CellContext`kA, $CellContext`k, $CellContext`payoffs, $CellContext`qAB] - \
$CellContext`StrictCumulativeProbabilityBestPayoffAmongBNbrsAOneB[$\
CellContext`x, $CellContext`kA, $CellContext`k, $CellContext`payoffs, \
$CellContext`qAB], $CellContext`CumulativeProbabilityBestPayoffAmongBNbrsAOneB[
         Pattern[$CellContext`x, 
          Blank[]], 
         Pattern[$CellContext`kA, 
          Blank[]], 
         Pattern[$CellContext`k, 
          Blank[]], 
         Pattern[$CellContext`payoffs, 
          Blank[]], 
         Pattern[$CellContext`qAB, 
          Blank[]]] := 
       Module[{$CellContext`\[CapitalPi]AA, $CellContext`\[CapitalPi]AB, \
$CellContext`\[CapitalPi]BA, $CellContext`\[CapitalPi]BB}, {$CellContext`\
\[CapitalPi]AA, $CellContext`\[CapitalPi]AB, $CellContext`\[CapitalPi]BA, \
$CellContext`\[CapitalPi]BB} = $CellContext`payoffs; Sum[
            Piecewise[{{
               $CellContext`PBOneA[$CellContext`i, $CellContext`k, \
$CellContext`qAB], $CellContext`\[CapitalPi]B[$CellContext`i, $CellContext`k, \
$CellContext`\[CapitalPi]BA, $CellContext`\[CapitalPi]BB] <= $CellContext`x}},
              0], {$CellContext`i, 
             1, $CellContext`k}]^($CellContext`k - $CellContext`kA)], \
$CellContext`StrictCumulativeProbabilityBestPayoffAmongBNbrsAOneB[
         Pattern[$CellContext`x, 
          Blank[]], 
         Pattern[$CellContext`kA, 
          Blank[]], 
         Pattern[$CellContext`k, 
          Blank[]], 
         Pattern[$CellContext`payoffs, 
          Blank[]], 
         Pattern[$CellContext`qAB, 
          Blank[]]] := 
       Module[{$CellContext`\[CapitalPi]AA, $CellContext`\[CapitalPi]AB, \
$CellContext`\[CapitalPi]BA, $CellContext`\[CapitalPi]BB}, {$CellContext`\
\[CapitalPi]AA, $CellContext`\[CapitalPi]AB, $CellContext`\[CapitalPi]BA, \
$CellContext`\[CapitalPi]BB} = $CellContext`payoffs; Sum[
            Piecewise[{{
               $CellContext`PBOneA[$CellContext`i, $CellContext`k, \
$CellContext`qAB], $CellContext`\[CapitalPi]B[$CellContext`i, $CellContext`k, \
$CellContext`\[CapitalPi]BA, $CellContext`\[CapitalPi]BB] < $CellContext`x}}, 
             0], {$CellContext`i, 
             1, $CellContext`k}]^($CellContext`k - $CellContext`kA)], \
$CellContext`StrictCumulativeProbabilityBestPayoffAmongANbrsAOneA[
         Pattern[$CellContext`x, 
          Blank[]], 
         Pattern[$CellContext`kA, 
          Blank[]], 
         Pattern[$CellContext`k, 
          Blank[]], 
         Pattern[$CellContext`payoffs, 
          Blank[]], 
         Pattern[$CellContext`qAA, 
          Blank[]]] := 
       Module[{$CellContext`\[CapitalPi]AA, $CellContext`\[CapitalPi]AB, \
$CellContext`\[CapitalPi]BA, $CellContext`\[CapitalPi]BB}, {$CellContext`\
\[CapitalPi]AA, $CellContext`\[CapitalPi]AB, $CellContext`\[CapitalPi]BA, \
$CellContext`\[CapitalPi]BB} = $CellContext`payoffs; Sum[
            Piecewise[{{
               $CellContext`PAOneA[$CellContext`i, $CellContext`k, \
$CellContext`qAA], $CellContext`\[CapitalPi]A[$CellContext`i, $CellContext`k, \
$CellContext`\[CapitalPi]AA, $CellContext`\[CapitalPi]AB] < $CellContext`x}}, 
             0], {$CellContext`i, 
             1, $CellContext`k}]^$CellContext`kA], $CellContext`PAOneA[
         Pattern[$CellContext`kA, 
          Blank[]], 
         Pattern[$CellContext`k, 
          Blank[]], 
         Pattern[$CellContext`qAA, 
          Blank[]]] := 
       Binomial[$CellContext`k - 1, $CellContext`kA - 
          1] $CellContext`qAA^($CellContext`kA - 1) (
          1 - $CellContext`qAA)^($CellContext`k - $CellContext`kA), \
$CellContext`pairApproximationSolution = {
         InterpolatingFunction[{{0, 100000.`20.}}, {
          5, 3, 1, {36}, {4}, 0, 0, 0, 0, Automatic, {}, {}, False}, {{
           0, 0.06291884849242601440151018165750686831`20., 
            0.20050501384802961644162898680048792811`20., 
            0.68651445955283215333194391928408564401`20., 
            2.22918041603514566575348189654684839602`20., 
            4.41868954099898368274296099363982374813`20., 
            9.98417513167896352722768208194425902534`20., 
            16.67875705849998932471101656418399524804`20., 
            22.43730043973343153688974338718927979488`20., 
            27.89404371923709078598011389111935395088`20., 
            33.88544800136378925922451627197799139521`20., 
            38.84657953275722702372947958950073347395`20., 
            48.46031052570229269747477523245056717697`20., 
            56.73665425181491252549647987069759079923`20., 
            67.07187435890898051916156821234533847971`20., 
            80.82400275387702637244387788414287402275`20., 
            102.33354049432556316582008464768532393135`20., 
            110.5422895396932363801587995205576475568`20., 
            128.22750324479946082826830182719740455895`20., 
            166.32914115170761134722877063973101879282`20., 
            248.41663160538434349061591936845425504558`20., 
            425.26876865644658797171094243485182506355`20., 
            806.28514772552809316131563056018796739446`20., 
            1627.16005226229541459518711784742032990537`20., 
            3395.68142277291785940613734851139603004898`20., 
            6932.72416379416274902803780983934743033618`20., 
            14006.8096458366525282718387324952502309106`20., 
            24006.80964583665252827183873249525023102815`20., 
            34006.8096458366525282718387324952502311457`20., 
            44006.80964583665252827183873249525023126325`20., 
            54006.8096458366525282718387324952502313808`20., 
            64006.80964583665252827183873249525023149835`20., 
            74006.8096458366525282718387324952502316159`20., 
            84006.80964583665252827183873249525023173345`20., 
            94006.809645836652528271838732495250231851`20., 100000.`20.}}, {{
           0.5`20., -0.13671378438266760782959061233969097572`20.}, {
           0.49163453363380668142862126990986961444`20., \
-0.1292802166570050014071849287664387348`20.}, {
           0.47488055603235396890082703571226576235`20., \
-0.11460155650430025291594602964031373695`20.}, {
           0.42930476760747310867667679714577529959`20., \
-0.07584099377249637627368245229014383992`20.}, {
           0.36460125599481983365632471838243057281`20., \
-0.01858600419684510825551236588287285167`20.}, {
           0.35762704562925282883117293810764534211`20., 
            0.00707364146023414237582883014751243672`20.}, {
           0.43493952969198719670586793523787332616`20., 
            0.01471750682314829454859944997445864617`20.}, {
           0.50600536539730219772802538453132032556`20., 
            0.00660680951001874290201109870614532597`20.}, {
           0.53122858242006244344105465105303025384`20., 
            0.00270877990897184213121640014503261197`20.}, {
           0.5412530489741505159928004456902302233`20., 
            0.00118450466639879404514220478542536677`20.}, {
           0.54597619286860305337836452983041821226`20., 
            0.0004963446906735878353869529997751359`20.}, {
           0.54774133356030183892756028866946482095`20., 
            0.00024530827403505498627351246924224941`20.}, {
           0.54903374343444615733710874934337845295`20., 
            0.00006443117179749241707758282907056788`20.}, {
           0.54934889350052197952760142471098924236`20., 
            0.00002031052441372496181241311277565063`20.}, {
           0.5494598942055620877410289183971905154`20., 
            4.85581837780429775792677679991346`20.*^-6}, {
           0.54948945439703444099087104361473811663`20., 
            7.2985607426087542547899013759542`20.*^-7}, {
           0.54949304003745823245783793311539513139`20., 
            5.3287347069034511600832346674995`20.*^-7}, {
           0.54949451416048518710482747796564949288`20., 
            4.079986276812002301414122419094`20.*^-8}, {
           0.54949472063449169555018201225492374103`20., 
            2.13027312566342888239122417245`20.*^-9}, {
           0.54949473630863447213631788868530238651`20., \
-2.3715786496483487244486526123539436965169550164`20.*^-12}, {
           0.54949473629212278579711761644569200246`20., 
            6.494592325139713347665794001940992820207183`20.*^-16}, {
           0.54949473629212848720076132305161972025`20., 
            8.9874961717488045985130312646863837796678`20.*^-18}, {
           0.5494947362921287892017808895469008748`20., 
            9.73677402453371566058707187486102054285`20.*^-20}, {
           0.54949473629212878927668777289954665841`20., 0}, {
           0.54949473629212878927668777289954665841`20., 0}, {
           0.54949473629212878927668777289954665841`20., 0}, {
           0.54949473629212878927668777289954665841`20., 0}, {
           0.54949473629212878927668777289954665841`20., 0}, {
           0.54949473629212878927668777289954665841`20., 0}, {
           0.54949473629212878927668777289954665841`20., 0}, {
           0.54949473629212878927668777289954665841`20., 0}, {
           0.54949473629212878927668777289954665841`20., 0}, {
           0.54949473629212878927668777289954665841`20., 0}, {
           0.54949473629212878927668777289954665841`20., 0}, {
           0.54949473629212878927668777289954665841`20., 0}, {
           0.54949473629212878927668777289954665841`20., 0}}, {Automatic}], 
         InterpolatingFunction[{{0, 100000.`20.}}, {
          5, 3, 1, {36}, {4}, 0, 0, 0, 0, Automatic, {}, {}, False}, {{
           0, 0.06291884849242601440151018165750686831`20., 
            0.20050501384802961644162898680048792811`20., 
            0.68651445955283215333194391928408564401`20., 
            2.22918041603514566575348189654684839602`20., 
            4.41868954099898368274296099363982374813`20., 
            9.98417513167896352722768208194425902534`20., 
            16.67875705849998932471101656418399524804`20., 
            22.43730043973343153688974338718927979488`20., 
            27.89404371923709078598011389111935395088`20., 
            33.88544800136378925922451627197799139521`20., 
            38.84657953275722702372947958950073347395`20., 
            48.46031052570229269747477523245056717697`20., 
            56.73665425181491252549647987069759079923`20., 
            67.07187435890898051916156821234533847971`20., 
            80.82400275387702637244387788414287402275`20., 
            102.33354049432556316582008464768532393135`20., 
            110.5422895396932363801587995205576475568`20., 
            128.22750324479946082826830182719740455895`20., 
            166.32914115170761134722877063973101879282`20., 
            248.41663160538434349061591936845425504558`20., 
            425.26876865644658797171094243485182506355`20., 
            806.28514772552809316131563056018796739446`20., 
            1627.16005226229541459518711784742032990537`20., 
            3395.68142277291785940613734851139603004898`20., 
            6932.72416379416274902803780983934743033618`20., 
            14006.8096458366525282718387324952502309106`20., 
            24006.80964583665252827183873249525023102815`20., 
            34006.8096458366525282718387324952502311457`20., 
            44006.80964583665252827183873249525023126325`20., 
            54006.8096458366525282718387324952502313808`20., 
            64006.80964583665252827183873249525023149835`20., 
            74006.8096458366525282718387324952502316159`20., 
            84006.80964583665252827183873249525023173345`20., 
            94006.809645836652528271838732495250231851`20., 100000.`20.}}, {{
           0.5`20., -0.0117137843826676078295906123396907544`20.}, {
           0.49936797409851486187390849228126774986`20., \
-0.00842843484846469982011075364802334934`20.}, {
           0.49864894593910471885536308050515575188`20., \
-0.00223327345032206457600314214299912652`20.}, {
           0.50141318982455431624917727120290165127`20., 
            0.01197343150207712091164332901958232527`20.}, {
           0.53215170230251414831497115884409391248`20., 
            0.02291805858804579773376746256209256559`20.}, {
           0.57753213776936656207516127595346249341`20., 
            0.01763158893269153867524479960068421026`20.}, {
           0.64125364830683574925484913940451856174`20., 
            0.00722347384018874705871731062410057107`20.}, {
           0.67275893201743273970835342153292617672`20., 
            0.00283741003146657563315724575033854839`20.}, {
           0.68385521262249509924673479101262273246`20., 
            0.00123420151055831151538169268570824305`20.}, {
           0.68852146465215600098198289977899324752`20., 
            0.00056438750366541884845639845835008094`20.}, {
           0.69080084606168372228266280186264412704`20., 
            0.00024229975407981388009255672054812646`20.}, {
           0.69166710436199768330947471002411455841`20., 
            0.00012098921748036476113682963737056023`20.}, {
           0.6923073376105453229079300666364594662`20., 
            0.00003183763587250704175729865983204296`20.}, {
           0.69246368697873509959710901846367556223`20., 
            0.00001007790562395020744942014742385225`20.}, {
           0.69251889450303239724038567259218181769`20., 
            2.40760455253410875088000802830203`20.*^-6}, {
           0.69253358471724122677894089845617582237`20., 
            3.6529843393309138206456578655809`20.*^-7}, {
           0.69253577809350473223277553944725823362`20., 
            1.0250661826562810266920532543488`20.*^-7}, {
           0.69253612258414730863294773870900508882`20., 
            1.48614818349550365142136806802`20.*^-8}, {
           0.69253621184495532010531566334246809485`20., 
            1.0845453381114736576344172195505655844333460389888`20.*^-9}, {
           0.69253621970940023004742590093968191397`20., \
-1.1370347215026119478496550201762140144628924461`20.*^-12}, {
           0.69253621970128584099031386603563026936`20., 
            4.290699175142610967362984081344583228653936`20.*^-16}, {
           0.6925362197012888850106546974594348059`20., 
            2.74474447615566065084612946802257258295785`20.*^-17}, {
           0.69253621970128908018749697519818248742`20., 0}, {
           0.69253621970128908010797086682785889087`20., 0}, {
           0.69253621970128908010797086682785889087`20., 0}, {
           0.69253621970128908010797086682785889087`20., 0}, {
           0.69253621970128908010797086682785889087`20., 0}, {
           0.69253621970128908010797086682785889087`20., 0}, {
           0.69253621970128908010797086682785889087`20., 0}, {
           0.69253621970128908010797086682785889087`20., 0}, {
           0.69253621970128908010797086682785889087`20., 0}, {
           0.69253621970128908010797086682785889087`20., 0}, {
           0.69253621970128908010797086682785889087`20., 0}, {
           0.69253621970128908010797086682785889087`20., 0}, {
           0.69253621970128908010797086682785889087`20., 0}, {
           0.69253621970128908010797086682785889087`20., 0}}, {
          Automatic}]}, $CellContext`meanDynamicSolution = 
       InterpolatingFunction[{{0., 100000.}}, {
         5, 7, 1, {40}, {4}, 0, 0, 0, 0, Automatic, {}, {}, 
          False}, CompressedData["
1:eJxd0KFOw3AQx/EWUUwT7BJIAIchq5wg/Z2aWlgyA64LZGammOkumSYVe4A+
wh5hXXiAatSYwUy0ISRMkN743d9xyeWjvifu+ikdTU48z/P/9sb7N1LH5ssp
zMdz5+DW2Y+db/fm3E/M8io1x1FmRr3c7NwVZhivzABrc4GKzjfY0vIDNR03
UBodcCbMf3FJwxZdGihAF4qhMFckwlyRCnNFJswVuTBXFMJcsRLmirUwV1TC
XJ/fhbkud87Zp/NhLzynF43z9cvZfjvTH7E/TA9yBBsNaJc=
         "], {
         Developer`PackedArrayForm, {0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 
          22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 
          56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80}, CompressedData["
1:eJxTTMoPSmVkYGAIYICBB/YMKGCUP8qnDx8AaAsu0w==
          "]}, {Automatic}], $CellContext`ExpectedChange[
         Pattern[$CellContext`maxDiff$, 
          Blank[]], 
         Pattern[$CellContext`mR$, 
          Blank[]], 
         Pattern[$CellContext`payoffs$, 
          Blank[]], 
         Pattern[$CellContext`\[Rho]A$, 
          Blank[]]] := 
       Module[{$CellContext`\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$, \
$CellContext`\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$, $CellContext`\
\[Rho]B$ = 
          1 - $CellContext`\[Rho]A$}, {$CellContext`\[CapitalPi]AA$, \
$CellContext`\[CapitalPi]AB$, $CellContext`\[CapitalPi]BA$, $CellContext`\
\[CapitalPi]BB$} = $CellContext`payoffs$; 
         Switch[FE`updateRule$$141, 
           "Imitate if better, all nbrs", $CellContext`\[Rho]B$ $CellContext`\
\[Rho]A$ Piecewise[{{
              1, $CellContext`\[CapitalPi]A[$CellContext`\[Rho]A$, \
$CellContext`\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$] > $CellContext`\
\[CapitalPi]B[$CellContext`\[Rho]A$, $CellContext`\[CapitalPi]BA$, \
$CellContext`\[CapitalPi]BB$]}, {-1, $CellContext`\[CapitalPi]A[$CellContext`\
\[Rho]A$, $CellContext`\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$] < \
$CellContext`\[CapitalPi]B[$CellContext`\[Rho]A$, \
$CellContext`\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$]}}, 0], 
           "Fermi (set intensity \
\!\(\*StyleBox[\"m\",FontSlant->\"Italic\"]\))", $CellContext`\[Rho]B$ \
$CellContext`\[Rho]A$ ((
             Exp[FE`m$$141 $CellContext`\[CapitalPi]A[$CellContext`\[Rho]A$, \
$CellContext`\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$]] - Exp[
             FE`m$$141 $CellContext`\[CapitalPi]B[$CellContext`\[Rho]A$, \
$CellContext`\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$]])/(
            Exp[FE`m$$141 $CellContext`\[CapitalPi]A[$CellContext`\[Rho]A$, \
$CellContext`\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$]] + 
            Exp[FE`m$$141 $CellContext`\[CapitalPi]B[$CellContext`\[Rho]A$, \
$CellContext`\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$]])), 
           "Imitative pairwise difference", $CellContext`\[Rho]B$ \
$CellContext`\[Rho]A$ (($CellContext`\[CapitalPi]A[$CellContext`\[Rho]A$, \
$CellContext`\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$] - $CellContext`\
\[CapitalPi]B[$CellContext`\[Rho]A$, $CellContext`\[CapitalPi]BA$, \
$CellContext`\[CapitalPi]BB$])/$CellContext`maxDiff$), 
           "Best neighbor", $CellContext`\[Rho]B$ Piecewise[{{
                $CellContext`BePositive[$CellContext`\[CapitalPi]A[$\
CellContext`\[Rho]A$, $CellContext`\[CapitalPi]AA$, \
$CellContext`\[CapitalPi]AB$] - \
$CellContext`\[CapitalPi]B[$CellContext`\[Rho]A$, \
$CellContext`\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$]], $CellContext`\
\[Rho]A$ > 0}}, 0] - $CellContext`\[Rho]A$ Piecewise[{{
               $CellContext`BePositive[$CellContext`\[CapitalPi]B[$\
CellContext`\[Rho]A$, $CellContext`\[CapitalPi]BA$, \
$CellContext`\[CapitalPi]BB$] - \
$CellContext`\[CapitalPi]A[$CellContext`\[Rho]A$, \
$CellContext`\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$]], $CellContext`\
\[Rho]B$ > 0}}, 0]]], $CellContext`ExpectedChange[
         Pattern[$CellContext`x, 
          Blank[]], 
         Pattern[$CellContext`A, 
          Blank[]], 
         Pattern[$CellContext`\[Alpha], 
          Blank[]], 
         Pattern[$CellContext`parameter, 
          Blank[]], 
         Pattern[$CellContext`m, 
          Blank[]], 
         Pattern[$CellContext`f, 
          Blank[]]] := (
          1 - $CellContext`m) $CellContext`f[$CellContext`x, $CellContext`A, \
$CellContext`\[Alpha], $CellContext`parameter] + $CellContext`m (
          ConstantArray[1/3, 3] - $CellContext`x), 
       Attributes[$CellContext`mR$] = {Temporary}, 
       Attributes[$CellContext`\[Rho]A$] = {Temporary}, 
       Attributes[$CellContext`\[Rho]B$] = {
        Temporary}, $CellContext`f = -1& , \
$CellContext`meanDynamicSolutionImitateIfBetterAllNbrs = 
       Function[{$CellContext`t$}, 
         Piecewise[{{
            Min[1/(2 ((1 - 1/2)/E^$CellContext`t$ + 1/2)), 
             If[
              And[
              0 < $CellContext`interiorEq$12275 < 1, 
               1/2 < $CellContext`interiorEq$12275], \
$CellContext`interiorEq$12275, 1]], $CellContext`\[CapitalPi]A[
             1/2, $CellContext`\[CapitalPi]AA$12275, \
$CellContext`\[CapitalPi]AB$12275] > $CellContext`\[CapitalPi]B[
             1/2, $CellContext`\[CapitalPi]BA$12275, \
$CellContext`\[CapitalPi]BB$12275]}, {
            Max[1/(2 (E^$CellContext`t$ (1 - 1/2) + 1/2)), 
             If[
              And[
              0 < $CellContext`interiorEq$12275 < 1, 
               1/2 > $CellContext`interiorEq$12275], \
$CellContext`interiorEq$12275, 0]], $CellContext`\[CapitalPi]A[
             1/2, $CellContext`\[CapitalPi]AA$12275, \
$CellContext`\[CapitalPi]AB$12275] < $CellContext`\[CapitalPi]B[
             1/2, $CellContext`\[CapitalPi]BA$12275, \
$CellContext`\[CapitalPi]BB$12275]}}, 1/2]], 
       Attributes[$CellContext`t$] = {Temporary}, 
       Attributes[$CellContext`interiorEq$12275] = {
        Temporary}, $CellContext`interiorEq$12275 = -1, 
       Attributes[$CellContext`\[CapitalPi]AA$12275] = {
        Temporary}, $CellContext`\[CapitalPi]AA$12275 = 1, 
       Attributes[$CellContext`\[CapitalPi]AB$12275] = {
        Temporary}, $CellContext`\[CapitalPi]AB$12275 = 0, 
       Attributes[$CellContext`\[CapitalPi]BA$12275] = {
        Temporary}, $CellContext`\[CapitalPi]BA$12275 = 1, 
       Attributes[$CellContext`\[CapitalPi]BB$12275] = {
        Temporary}, $CellContext`\[CapitalPi]BB$12275 = 
       0, $CellContext`MDsolutionImitateIfBetterAllNbrs[
         Pattern[$CellContext`initialxA, 
          Blank[]], 
         Pattern[$CellContext`payoffs, 
          Blank[]]] := 
       Module[{$CellContext`\[CapitalPi]AA, $CellContext`\[CapitalPi]AB, \
$CellContext`\[CapitalPi]BA, $CellContext`\[CapitalPi]BB, \
$CellContext`interiorEq}, {$CellContext`\[CapitalPi]AA, $CellContext`\
\[CapitalPi]AB, $CellContext`\[CapitalPi]BA, $CellContext`\[CapitalPi]BB} = \
$CellContext`payoffs; $CellContext`interiorEq = 
          If[$CellContext`\[CapitalPi]AA - $CellContext`\[CapitalPi]AB - \
$CellContext`\[CapitalPi]BA + $CellContext`\[CapitalPi]BB == 
            0, -1, ($CellContext`\[CapitalPi]BB - \
$CellContext`\[CapitalPi]AB)/($CellContext`\[CapitalPi]AA - $CellContext`\
\[CapitalPi]AB - $CellContext`\[CapitalPi]BA + $CellContext`\[CapitalPi]BB)]; 
         Function[{$CellContext`t}, 
           Piecewise[{{
              
              Min[$CellContext`initialxA/((1 - $CellContext`initialxA)/
                E^$CellContext`t + $CellContext`initialxA), 
               If[
                And[
                0 < $CellContext`interiorEq < 
                 1, $CellContext`initialxA < $CellContext`interiorEq], \
$CellContext`interiorEq, 
                1]], $CellContext`\[CapitalPi]A[$CellContext`initialxA, \
$CellContext`\[CapitalPi]AA, $CellContext`\[CapitalPi]AB] > $CellContext`\
\[CapitalPi]B[$CellContext`initialxA, $CellContext`\[CapitalPi]BA, \
$CellContext`\[CapitalPi]BB]}, {
              
              Max[$CellContext`initialxA/(
               E^$CellContext`t (
                 1 - $CellContext`initialxA) + $CellContext`initialxA), 
               If[
                And[
                0 < $CellContext`interiorEq < 
                 1, $CellContext`initialxA > $CellContext`interiorEq], \
$CellContext`interiorEq, 
                0]], $CellContext`\[CapitalPi]A[$CellContext`initialxA, \
$CellContext`\[CapitalPi]AA, $CellContext`\[CapitalPi]AB] < $CellContext`\
\[CapitalPi]B[$CellContext`initialxA, $CellContext`\[CapitalPi]BA, \
$CellContext`\[CapitalPi]BB]}}, $CellContext`initialxA]]], \
$CellContext`actualFinalTime = 
       115.61973684384570856239663723798541004744`20., \
$CellContext`ForceNumber[
         Pattern[$CellContext`n, 
          Blank[]]] := If[
         NumberQ[$CellContext`n], $CellContext`n, 0], Off[
         MessageName[General, "munfl"]]; $CellContext`ForceNumber[
          Pattern[$CellContext`n, 
           Blank[]]] := If[
          NumberQ[$CellContext`n], $CellContext`n, 
          0]; $CellContext`\[CapitalPi]A[
          Pattern[$CellContext`x, 
           Blank[]], 
          Pattern[$CellContext`\[CapitalPi]AA, 
           Blank[]], 
          Pattern[$CellContext`\[CapitalPi]AB, 
           Blank[]]] := $CellContext`x $CellContext`\[CapitalPi]AA + (
           1 - $CellContext`x) $CellContext`\[CapitalPi]AB; $CellContext`\
\[CapitalPi]B[
          Pattern[$CellContext`x, 
           Blank[]], 
          Pattern[$CellContext`\[CapitalPi]BA, 
           Blank[]], 
          Pattern[$CellContext`\[CapitalPi]BB, 
           Blank[]]] := $CellContext`x $CellContext`\[CapitalPi]BA + (
           1 - $CellContext`x) $CellContext`\[CapitalPi]BB; $CellContext`\
\[CapitalPi]A[
          Pattern[$CellContext`kA, 
           Blank[]], 
          Pattern[$CellContext`k, 
           Blank[]], 
          Pattern[$CellContext`\[CapitalPi]AA, 
           Blank[]], 
          Pattern[$CellContext`\[CapitalPi]AB, 
           
           Blank[]]] := ($CellContext`kA $CellContext`\[CapitalPi]AA + \
($CellContext`k - $CellContext`kA) \
$CellContext`\[CapitalPi]AB)/$CellContext`k; $CellContext`\[CapitalPi]B[
          Pattern[$CellContext`kA, 
           Blank[]], 
          Pattern[$CellContext`k, 
           Blank[]], 
          Pattern[$CellContext`\[CapitalPi]BA, 
           Blank[]], 
          Pattern[$CellContext`\[CapitalPi]BB, 
           
           Blank[]]] := ($CellContext`kA $CellContext`\[CapitalPi]BA + \
($CellContext`k - $CellContext`kA) \
$CellContext`\[CapitalPi]BB)/$CellContext`k; $CellContext`ExpectedChange[
          Pattern[$CellContext`maxDiff$, 
           Blank[]], 
          Pattern[$CellContext`mR$, 
           Blank[]], 
          Pattern[$CellContext`payoffs$, 
           Blank[]], 
          Pattern[$CellContext`\[Rho]A$, 
           Blank[]]] := 
        Module[{$CellContext`\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$, \
$CellContext`\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$, $CellContext`\
\[Rho]B$ = 
           1 - $CellContext`\[Rho]A$}, {$CellContext`\[CapitalPi]AA$, \
$CellContext`\[CapitalPi]AB$, $CellContext`\[CapitalPi]BA$, $CellContext`\
\[CapitalPi]BB$} = $CellContext`payoffs$; 
          Switch[$CellContext`updateRule$$, 
            "Imitate if better, all nbrs", $CellContext`\[Rho]B$ \
$CellContext`\[Rho]A$ 
            Piecewise[{{
               1, $CellContext`\[CapitalPi]A[$CellContext`\[Rho]A$, \
$CellContext`\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$] > $CellContext`\
\[CapitalPi]B[$CellContext`\[Rho]A$, $CellContext`\[CapitalPi]BA$, \
$CellContext`\[CapitalPi]BB$]}, {-1, $CellContext`\[CapitalPi]A[$CellContext`\
\[Rho]A$, $CellContext`\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$] < \
$CellContext`\[CapitalPi]B[$CellContext`\[Rho]A$, \
$CellContext`\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$]}}, 0], 
            "Fermi (set intensity \!\(\*StyleBox[\"m\",FontSlant->\"Italic\"]\
\))", $CellContext`\[Rho]B$ $CellContext`\[Rho]A$ ((
              Exp[$CellContext`m$$ $CellContext`\[CapitalPi]A[$CellContext`\
\[Rho]A$, $CellContext`\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$]] - 
              Exp[$CellContext`m$$ $CellContext`\[CapitalPi]B[$CellContext`\
\[Rho]A$, $CellContext`\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$]])/(
             Exp[$CellContext`m$$ $CellContext`\[CapitalPi]A[$CellContext`\
\[Rho]A$, $CellContext`\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$]] + 
             Exp[$CellContext`m$$ $CellContext`\[CapitalPi]B[$CellContext`\
\[Rho]A$, $CellContext`\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$]])), 
            "Imitative pairwise difference", $CellContext`\[Rho]B$ \
$CellContext`\[Rho]A$ (($CellContext`\[CapitalPi]A[$CellContext`\[Rho]A$, \
$CellContext`\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$] - $CellContext`\
\[CapitalPi]B[$CellContext`\[Rho]A$, $CellContext`\[CapitalPi]BA$, \
$CellContext`\[CapitalPi]BB$])/$CellContext`maxDiff$), 
            "Best neighbor", $CellContext`\[Rho]B$ Piecewise[{{
                 $CellContext`BePositive[$CellContext`\[CapitalPi]A[$\
CellContext`\[Rho]A$, $CellContext`\[CapitalPi]AA$, \
$CellContext`\[CapitalPi]AB$] - \
$CellContext`\[CapitalPi]B[$CellContext`\[Rho]A$, \
$CellContext`\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$]], $CellContext`\
\[Rho]A$ > 0}}, 0] - $CellContext`\[Rho]A$ Piecewise[{{
                $CellContext`BePositive[$CellContext`\[CapitalPi]B[$\
CellContext`\[Rho]A$, $CellContext`\[CapitalPi]BA$, \
$CellContext`\[CapitalPi]BB$] - \
$CellContext`\[CapitalPi]A[$CellContext`\[Rho]A$, \
$CellContext`\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$]], $CellContext`\
\[Rho]B$ > 0}}, 0]]]; $CellContext`MDsolutionImitateIfBetterAllNbrs[
          Pattern[$CellContext`initialxA, 
           Blank[]], 
          Pattern[$CellContext`payoffs, 
           Blank[]]] := 
        Module[{$CellContext`\[CapitalPi]AA, $CellContext`\[CapitalPi]AB, \
$CellContext`\[CapitalPi]BA, $CellContext`\[CapitalPi]BB, \
$CellContext`interiorEq}, {$CellContext`\[CapitalPi]AA, $CellContext`\
\[CapitalPi]AB, $CellContext`\[CapitalPi]BA, $CellContext`\[CapitalPi]BB} = \
$CellContext`payoffs; $CellContext`interiorEq = 
           If[$CellContext`\[CapitalPi]AA - $CellContext`\[CapitalPi]AB - \
$CellContext`\[CapitalPi]BA + $CellContext`\[CapitalPi]BB == 
             0, -1, ($CellContext`\[CapitalPi]BB - \
$CellContext`\[CapitalPi]AB)/($CellContext`\[CapitalPi]AA - $CellContext`\
\[CapitalPi]AB - $CellContext`\[CapitalPi]BA + $CellContext`\[CapitalPi]BB)]; 
          Function[{$CellContext`t}, 
            Piecewise[{{
               
               Min[$CellContext`initialxA/(
                E^(-$CellContext`t) (
                  1 - $CellContext`initialxA) + $CellContext`initialxA), 
                If[
                 And[
                 0 < $CellContext`interiorEq < 
                  1, $CellContext`initialxA < $CellContext`interiorEq], \
$CellContext`interiorEq, 
                 1]], $CellContext`\[CapitalPi]A[$CellContext`initialxA, \
$CellContext`\[CapitalPi]AA, $CellContext`\[CapitalPi]AB] > $CellContext`\
\[CapitalPi]B[$CellContext`initialxA, $CellContext`\[CapitalPi]BA, \
$CellContext`\[CapitalPi]BB]}, {
               
               Max[$CellContext`initialxA/(
                E^$CellContext`t (
                  1 - $CellContext`initialxA) + $CellContext`initialxA), 
                If[
                 And[
                 0 < $CellContext`interiorEq < 
                  1, $CellContext`initialxA > $CellContext`interiorEq], \
$CellContext`interiorEq, 
                 0]], $CellContext`\[CapitalPi]A[$CellContext`initialxA, \
$CellContext`\[CapitalPi]AA, $CellContext`\[CapitalPi]AB] < $CellContext`\
\[CapitalPi]B[$CellContext`initialxA, $CellContext`\[CapitalPi]BA, \
$CellContext`\[CapitalPi]BB]}}, $CellContext`initialxA]]]; $CellContext`PA[
          Pattern[$CellContext`kA, 
           Blank[]], 
          Pattern[$CellContext`k, 
           Blank[]], 
          Pattern[$CellContext`qAA, 
           Blank[]]] := 
        Binomial[$CellContext`k, $CellContext`kA] \
$CellContext`qAA^$CellContext`kA (
           1 - $CellContext`qAA)^($CellContext`k - $CellContext`kA); \
$CellContext`PB[
          Pattern[$CellContext`kA, 
           Blank[]], 
          Pattern[$CellContext`k, 
           Blank[]], 
          Pattern[$CellContext`qAB, 
           Blank[]]] := 
        Binomial[$CellContext`k, $CellContext`kA] \
$CellContext`qAB^$CellContext`kA (
           1 - $CellContext`qAB)^($CellContext`k - $CellContext`kA); \
$CellContext`PAOneB[
          Pattern[$CellContext`kA, 
           Blank[]], 
          Pattern[$CellContext`k, 
           Blank[]], 
          Pattern[$CellContext`qAA, 
           Blank[]]] := 
        Binomial[$CellContext`k - 
           1, $CellContext`kA] $CellContext`qAA^$CellContext`kA (
           1 - $CellContext`qAA)^($CellContext`k - 
           1 - $CellContext`kA); $CellContext`PBOneA[
          Pattern[$CellContext`kA, 
           Blank[]], 
          Pattern[$CellContext`k, 
           Blank[]], 
          Pattern[$CellContext`qAB, 
           Blank[]]] := 
        Binomial[$CellContext`k - 1, $CellContext`kA - 
           1] $CellContext`qAB^($CellContext`kA - 1) (
           1 - $CellContext`qAB)^($CellContext`k - $CellContext`kA); \
$CellContext`PAOneA[
          Pattern[$CellContext`kA, 
           Blank[]], 
          Pattern[$CellContext`k, 
           Blank[]], 
          Pattern[$CellContext`qAA, 
           Blank[]]] := 
        Binomial[$CellContext`k - 1, $CellContext`kA - 
           1] $CellContext`qAA^($CellContext`kA - 1) (
           1 - $CellContext`qAA)^($CellContext`k - $CellContext`kA); \
$CellContext`PBOneB[
          Pattern[$CellContext`kA, 
           Blank[]], 
          Pattern[$CellContext`k, 
           Blank[]], 
          Pattern[$CellContext`qAB, 
           Blank[]]] := 
        Binomial[$CellContext`k - 
           1, $CellContext`kA] $CellContext`qAB^$CellContext`kA (
           1 - $CellContext`qAB)^($CellContext`k - 
           1 - $CellContext`kA); $CellContext`FA[
          Pattern[$CellContext`kA$, 
           Blank[]], 
          Pattern[$CellContext`k$, 
           Blank[]], 
          Pattern[$CellContext`maxDiff$, 
           Blank[]], 
          Pattern[$CellContext`m$, 
           Blank[]], 
          Pattern[$CellContext`payoffs$, 
           Blank[]], 
          Pattern[$CellContext`qAA$, 
           Blank[]], 
          Pattern[$CellContext`qAB$, 
           Blank[]]] := 
        Module[{$CellContext`\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$, \
$CellContext`\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$}, {$CellContext`\
\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$, $CellContext`\[CapitalPi]BA$, \
$CellContext`\[CapitalPi]BB$} = $CellContext`payoffs$; 
          Switch[$CellContext`updateRule$$, 
            "Imitate if better, all nbrs", (($CellContext`k$ - \
$CellContext`kA$)/$CellContext`k$) Sum[
              Piecewise[{{
                 $CellContext`PBOneA[$CellContext`i, $CellContext`k$, \
$CellContext`qAB$], $CellContext`\[CapitalPi]B[$CellContext`i, \
$CellContext`k$, $CellContext`\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$] > \
$CellContext`\[CapitalPi]A[$CellContext`kA$, $CellContext`k$, $CellContext`\
\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$]}}, 0], {$CellContext`i, 
               1, $CellContext`k$}], 
            "Fermi (set intensity \!\(\*StyleBox[\"m\",FontSlant->\"Italic\"]\
\))", (($CellContext`k$ - $CellContext`kA$)/$CellContext`k$) 
            Sum[$CellContext`PBOneA[$CellContext`i, $CellContext`k$, \
$CellContext`qAB$] (
               Exp[$CellContext`m$ $CellContext`\[CapitalPi]B[$CellContext`i, \
$CellContext`k$, $CellContext`\[CapitalPi]BA$, \
$CellContext`\[CapitalPi]BB$]]/(
               Exp[$CellContext`m$ \
$CellContext`\[CapitalPi]A[$CellContext`kA$, $CellContext`k$, $CellContext`\
\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$]] + 
               Exp[$CellContext`m$ $CellContext`\[CapitalPi]B[$CellContext`i, \
$CellContext`k$, $CellContext`\[CapitalPi]BA$, \
$CellContext`\[CapitalPi]BB$]])), {$CellContext`i, 1, $CellContext`k$}], 
            "Imitative pairwise difference", (($CellContext`k$ - \
$CellContext`kA$)/$CellContext`k$) 
            Sum[$CellContext`PBOneA[$CellContext`i, $CellContext`k$, \
$CellContext`qAB$] \
($CellContext`BePositive[$CellContext`\[CapitalPi]B[$CellContext`i, \
$CellContext`k$, $CellContext`\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$] - \
$CellContext`\[CapitalPi]A[$CellContext`kA$, $CellContext`k$, $CellContext`\
\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$]]/$CellContext`maxDiff$), \
{$CellContext`i, 1, $CellContext`k$}], "Best neighbor", 
            Switch[$CellContext`kA$, 0, 
             Sum[
              Piecewise[{{
                 $CellContext`ProbabilityBestPayoffAmongBNbrsAOneB[
                  $CellContext`\[CapitalPi]B[$CellContext`i, $CellContext`k$, \
$CellContext`\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$], \
$CellContext`kA$, $CellContext`k$, $CellContext`payoffs$, $CellContext`qAB$], \
$CellContext`\[CapitalPi]B[$CellContext`i, $CellContext`k$, $CellContext`\
\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$] > \
$CellContext`\[CapitalPi]A[$CellContext`kA$, $CellContext`k$, $CellContext`\
\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$]}}, 0], {$CellContext`i, 
               1, $CellContext`k$}], $CellContext`k$, 0, 
             Blank[], 
             Sum[
              Piecewise[{{$CellContext`ProbabilityBestPayoffAmongBNbrsAOneB[
                   $CellContext`\[CapitalPi]B[$CellContext`i, \
$CellContext`k$, $CellContext`\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$], \
$CellContext`kA$, $CellContext`k$, $CellContext`payoffs$, $CellContext`qAB$] \
$CellContext`StrictCumulativeProbabilityBestPayoffAmongANbrsAOneA[
                   $CellContext`\[CapitalPi]B[$CellContext`i, \
$CellContext`k$, $CellContext`\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$], \
$CellContext`kA$, $CellContext`k$, $CellContext`payoffs$, $CellContext`qAA$], \
$CellContext`\[CapitalPi]B[$CellContext`i, $CellContext`k$, $CellContext`\
\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$] > \
$CellContext`\[CapitalPi]A[$CellContext`kA$, $CellContext`k$, $CellContext`\
\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$]}}, 0], {$CellContext`i, 
               1, $CellContext`k$}]]]]; $CellContext`FB[
          Pattern[$CellContext`kA$, 
           Blank[]], 
          Pattern[$CellContext`k$, 
           Blank[]], 
          Pattern[$CellContext`maxDiff$, 
           Blank[]], 
          Pattern[$CellContext`m$, 
           Blank[]], 
          Pattern[$CellContext`payoffs$, 
           Blank[]], 
          Pattern[$CellContext`qAA$, 
           Blank[]], 
          Pattern[$CellContext`qAB$, 
           Blank[]]] := 
        Module[{$CellContext`\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$, \
$CellContext`\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$}, {$CellContext`\
\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$, $CellContext`\[CapitalPi]BA$, \
$CellContext`\[CapitalPi]BB$} = $CellContext`payoffs$; 
          Switch[$CellContext`updateRule$$, 
            "Imitate if better, all nbrs", ($CellContext`kA$/$CellContext`k$) 
            Sum[
              Piecewise[{{
                 $CellContext`PAOneB[$CellContext`i, $CellContext`k$, \
$CellContext`qAA$], $CellContext`\[CapitalPi]A[$CellContext`i, \
$CellContext`k$, $CellContext`\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$] > \
$CellContext`\[CapitalPi]B[$CellContext`kA$, $CellContext`k$, $CellContext`\
\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$]}}, 0], {$CellContext`i, 
               0, $CellContext`k$ - 1}], 
            "Fermi (set intensity \!\(\*StyleBox[\"m\",FontSlant->\"Italic\"]\
\))", ($CellContext`kA$/$CellContext`k$) 
            Sum[$CellContext`PAOneB[$CellContext`i, $CellContext`k$, \
$CellContext`qAA$] (
               Exp[$CellContext`m$ $CellContext`\[CapitalPi]A[$CellContext`i, \
$CellContext`k$, $CellContext`\[CapitalPi]AA$, \
$CellContext`\[CapitalPi]AB$]]/(
               Exp[$CellContext`m$ \
$CellContext`\[CapitalPi]B[$CellContext`kA$, $CellContext`k$, $CellContext`\
\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$]] + 
               Exp[$CellContext`m$ $CellContext`\[CapitalPi]A[$CellContext`i, \
$CellContext`k$, $CellContext`\[CapitalPi]AA$, \
$CellContext`\[CapitalPi]AB$]])), {$CellContext`i, 0, $CellContext`k$ - 1}], 
            "Imitative pairwise difference", \
($CellContext`kA$/$CellContext`k$) 
            Sum[$CellContext`PAOneB[$CellContext`i, $CellContext`k$, \
$CellContext`qAA$] \
($CellContext`BePositive[$CellContext`\[CapitalPi]A[$CellContext`i, \
$CellContext`k$, $CellContext`\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$] - \
$CellContext`\[CapitalPi]B[$CellContext`kA$, $CellContext`k$, $CellContext`\
\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$]]/$CellContext`maxDiff$), \
{$CellContext`i, 0, $CellContext`k$ - 1}], "Best neighbor", 
            Switch[$CellContext`kA$, 0, 0, $CellContext`k$, 
             Sum[
              Piecewise[{{
                 $CellContext`ProbabilityBestPayoffAmongANbrsBOneA[
                  $CellContext`\[CapitalPi]A[$CellContext`i, $CellContext`k$, \
$CellContext`\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$], \
$CellContext`kA$, $CellContext`k$, $CellContext`payoffs$, $CellContext`qAA$], \
$CellContext`\[CapitalPi]A[$CellContext`i, $CellContext`k$, $CellContext`\
\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$] > \
$CellContext`\[CapitalPi]B[$CellContext`kA$, $CellContext`k$, $CellContext`\
\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$]}}, 0], {$CellContext`i, 
               0, $CellContext`k$ - 1}], 
             Blank[], 
             Sum[
              Piecewise[{{$CellContext`ProbabilityBestPayoffAmongANbrsBOneA[
                   $CellContext`\[CapitalPi]A[$CellContext`i, \
$CellContext`k$, $CellContext`\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$], \
$CellContext`kA$, $CellContext`k$, $CellContext`payoffs$, $CellContext`qAA$] \
$CellContext`StrictCumulativeProbabilityBestPayoffAmongBNbrsBOneB[
                   $CellContext`\[CapitalPi]A[$CellContext`i, \
$CellContext`k$, $CellContext`\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$], \
$CellContext`kA$, $CellContext`k$, $CellContext`payoffs$, $CellContext`qAB$], \
$CellContext`\[CapitalPi]A[$CellContext`i, $CellContext`k$, $CellContext`\
\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$] > \
$CellContext`\[CapitalPi]B[$CellContext`kA$, $CellContext`k$, $CellContext`\
\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$]}}, 0], {$CellContext`i, 
               0, $CellContext`k$ - 1}]]]]; $CellContext`BePositive[
          Pattern[$CellContext`x, 
           Blank[]]] := 
        Piecewise[{{
           0, $CellContext`x < 0}, {$CellContext`x, $CellContext`x >= 
            0}}]; $CellContext`CumulativeProbabilityBestPayoffAmongANbrsBOneA[
          Pattern[$CellContext`x, 
           Blank[]], 
          Pattern[$CellContext`kA, 
           Blank[]], 
          Pattern[$CellContext`k, 
           Blank[]], 
          Pattern[$CellContext`payoffs, 
           Blank[]], 
          Pattern[$CellContext`qAA, 
           Blank[]]] := 
        Module[{$CellContext`\[CapitalPi]AA, $CellContext`\[CapitalPi]AB, \
$CellContext`\[CapitalPi]BA, $CellContext`\[CapitalPi]BB}, {$CellContext`\
\[CapitalPi]AA, $CellContext`\[CapitalPi]AB, $CellContext`\[CapitalPi]BA, \
$CellContext`\[CapitalPi]BB} = $CellContext`payoffs; Sum[
             Piecewise[{{
                $CellContext`PAOneB[$CellContext`i, $CellContext`k, \
$CellContext`qAA], $CellContext`\[CapitalPi]A[$CellContext`i, $CellContext`k, \
$CellContext`\[CapitalPi]AA, $CellContext`\[CapitalPi]AB] <= $CellContext`x}},
               0], {$CellContext`i, 0, $CellContext`k - 
              1}]^$CellContext`kA]; \
$CellContext`StrictCumulativeProbabilityBestPayoffAmongANbrsBOneA[
          Pattern[$CellContext`x, 
           Blank[]], 
          Pattern[$CellContext`kA, 
           Blank[]], 
          Pattern[$CellContext`k, 
           Blank[]], 
          Pattern[$CellContext`payoffs, 
           Blank[]], 
          Pattern[$CellContext`qAA, 
           Blank[]]] := 
        Module[{$CellContext`\[CapitalPi]AA, $CellContext`\[CapitalPi]AB, \
$CellContext`\[CapitalPi]BA, $CellContext`\[CapitalPi]BB}, {$CellContext`\
\[CapitalPi]AA, $CellContext`\[CapitalPi]AB, $CellContext`\[CapitalPi]BA, \
$CellContext`\[CapitalPi]BB} = $CellContext`payoffs; Sum[
             Piecewise[{{
                $CellContext`PAOneB[$CellContext`i, $CellContext`k, \
$CellContext`qAA], $CellContext`\[CapitalPi]A[$CellContext`i, $CellContext`k, \
$CellContext`\[CapitalPi]AA, $CellContext`\[CapitalPi]AB] < $CellContext`x}}, 
              0], {$CellContext`i, 0, $CellContext`k - 
              1}]^$CellContext`kA]; \
$CellContext`ProbabilityBestPayoffAmongANbrsBOneA[
          Pattern[$CellContext`x, 
           Blank[]], 
          Pattern[$CellContext`kA, 
           Blank[]], 
          Pattern[$CellContext`k, 
           Blank[]], 
          Pattern[$CellContext`payoffs, 
           Blank[]], 
          Pattern[$CellContext`qAA, 
           
           Blank[]]] := \
$CellContext`CumulativeProbabilityBestPayoffAmongANbrsBOneA[$CellContext`x, \
$CellContext`kA, $CellContext`k, $CellContext`payoffs, $CellContext`qAA] - \
$CellContext`StrictCumulativeProbabilityBestPayoffAmongANbrsBOneA[$\
CellContext`x, $CellContext`kA, $CellContext`k, $CellContext`payoffs, \
$CellContext`qAA]; $CellContext`CumulativeProbabilityBestPayoffAmongBNbrsBOneB[
          Pattern[$CellContext`x, 
           Blank[]], 
          Pattern[$CellContext`kA, 
           Blank[]], 
          Pattern[$CellContext`k, 
           Blank[]], 
          Pattern[$CellContext`payoffs, 
           Blank[]], 
          Pattern[$CellContext`qAB, 
           Blank[]]] := 
        Module[{$CellContext`\[CapitalPi]AA, $CellContext`\[CapitalPi]AB, \
$CellContext`\[CapitalPi]BA, $CellContext`\[CapitalPi]BB}, {$CellContext`\
\[CapitalPi]AA, $CellContext`\[CapitalPi]AB, $CellContext`\[CapitalPi]BA, \
$CellContext`\[CapitalPi]BB} = $CellContext`payoffs; Sum[
             Piecewise[{{
                $CellContext`PBOneB[$CellContext`i, $CellContext`k, \
$CellContext`qAB], $CellContext`\[CapitalPi]B[$CellContext`i, $CellContext`k, \
$CellContext`\[CapitalPi]BA, $CellContext`\[CapitalPi]BB] <= $CellContext`x}},
               0], {$CellContext`i, 0, $CellContext`k - 
              1}]^($CellContext`k - $CellContext`kA)]; \
$CellContext`StrictCumulativeProbabilityBestPayoffAmongBNbrsBOneB[
          Pattern[$CellContext`x, 
           Blank[]], 
          Pattern[$CellContext`kA, 
           Blank[]], 
          Pattern[$CellContext`k, 
           Blank[]], 
          Pattern[$CellContext`payoffs, 
           Blank[]], 
          Pattern[$CellContext`qAB, 
           Blank[]]] := 
        Module[{$CellContext`\[CapitalPi]AA, $CellContext`\[CapitalPi]AB, \
$CellContext`\[CapitalPi]BA, $CellContext`\[CapitalPi]BB}, {$CellContext`\
\[CapitalPi]AA, $CellContext`\[CapitalPi]AB, $CellContext`\[CapitalPi]BA, \
$CellContext`\[CapitalPi]BB} = $CellContext`payoffs; Sum[
             Piecewise[{{
                $CellContext`PBOneB[$CellContext`i, $CellContext`k, \
$CellContext`qAB], $CellContext`\[CapitalPi]B[$CellContext`i, $CellContext`k, \
$CellContext`\[CapitalPi]BA, $CellContext`\[CapitalPi]BB] < $CellContext`x}}, 
              0], {$CellContext`i, 0, $CellContext`k - 
              1}]^($CellContext`k - $CellContext`kA)]; \
$CellContext`ProbabilityBestPayoffAmongBNbrsBOneB[
          Pattern[$CellContext`x, 
           Blank[]], 
          Pattern[$CellContext`kA, 
           Blank[]], 
          Pattern[$CellContext`k, 
           Blank[]], 
          Pattern[$CellContext`payoffs, 
           Blank[]], 
          Pattern[$CellContext`qAB, 
           
           Blank[]]] := \
$CellContext`CumulativeProbabilityBestPayoffAmongBNbrsBOneB[$CellContext`x, \
$CellContext`kA, $CellContext`k, $CellContext`payoffs, $CellContext`qAB] - \
$CellContext`StrictCumulativeProbabilityBestPayoffAmongBNbrsBOneB[$\
CellContext`x, $CellContext`kA, $CellContext`k, $CellContext`payoffs, \
$CellContext`qAB]; $CellContext`CumulativeProbabilityBestPayoffAmongBNbrsAOneB[
          Pattern[$CellContext`x, 
           Blank[]], 
          Pattern[$CellContext`kA, 
           Blank[]], 
          Pattern[$CellContext`k, 
           Blank[]], 
          Pattern[$CellContext`payoffs, 
           Blank[]], 
          Pattern[$CellContext`qAB, 
           Blank[]]] := 
        Module[{$CellContext`\[CapitalPi]AA, $CellContext`\[CapitalPi]AB, \
$CellContext`\[CapitalPi]BA, $CellContext`\[CapitalPi]BB}, {$CellContext`\
\[CapitalPi]AA, $CellContext`\[CapitalPi]AB, $CellContext`\[CapitalPi]BA, \
$CellContext`\[CapitalPi]BB} = $CellContext`payoffs; Sum[
             Piecewise[{{
                $CellContext`PBOneA[$CellContext`i, $CellContext`k, \
$CellContext`qAB], $CellContext`\[CapitalPi]B[$CellContext`i, $CellContext`k, \
$CellContext`\[CapitalPi]BA, $CellContext`\[CapitalPi]BB] <= $CellContext`x}},
               0], {$CellContext`i, 
              1, $CellContext`k}]^($CellContext`k - $CellContext`kA)]; \
$CellContext`StrictCumulativeProbabilityBestPayoffAmongBNbrsAOneB[
          Pattern[$CellContext`x, 
           Blank[]], 
          Pattern[$CellContext`kA, 
           Blank[]], 
          Pattern[$CellContext`k, 
           Blank[]], 
          Pattern[$CellContext`payoffs, 
           Blank[]], 
          Pattern[$CellContext`qAB, 
           Blank[]]] := 
        Module[{$CellContext`\[CapitalPi]AA, $CellContext`\[CapitalPi]AB, \
$CellContext`\[CapitalPi]BA, $CellContext`\[CapitalPi]BB}, {$CellContext`\
\[CapitalPi]AA, $CellContext`\[CapitalPi]AB, $CellContext`\[CapitalPi]BA, \
$CellContext`\[CapitalPi]BB} = $CellContext`payoffs; Sum[
             Piecewise[{{
                $CellContext`PBOneA[$CellContext`i, $CellContext`k, \
$CellContext`qAB], $CellContext`\[CapitalPi]B[$CellContext`i, $CellContext`k, \
$CellContext`\[CapitalPi]BA, $CellContext`\[CapitalPi]BB] < $CellContext`x}}, 
              0], {$CellContext`i, 
              1, $CellContext`k}]^($CellContext`k - $CellContext`kA)]; \
$CellContext`ProbabilityBestPayoffAmongBNbrsAOneB[
          Pattern[$CellContext`x, 
           Blank[]], 
          Pattern[$CellContext`kA, 
           Blank[]], 
          Pattern[$CellContext`k, 
           Blank[]], 
          Pattern[$CellContext`payoffs, 
           Blank[]], 
          Pattern[$CellContext`qAB, 
           
           Blank[]]] := \
$CellContext`CumulativeProbabilityBestPayoffAmongBNbrsAOneB[$CellContext`x, \
$CellContext`kA, $CellContext`k, $CellContext`payoffs, $CellContext`qAB] - \
$CellContext`StrictCumulativeProbabilityBestPayoffAmongBNbrsAOneB[$\
CellContext`x, $CellContext`kA, $CellContext`k, $CellContext`payoffs, \
$CellContext`qAB]; $CellContext`CumulativeProbabilityBestPayoffAmongANbrsAOneA[
          Pattern[$CellContext`x, 
           Blank[]], 
          Pattern[$CellContext`kA, 
           Blank[]], 
          Pattern[$CellContext`k, 
           Blank[]], 
          Pattern[$CellContext`payoffs, 
           Blank[]], 
          Pattern[$CellContext`qAA, 
           Blank[]]] := 
        Module[{$CellContext`\[CapitalPi]AA, $CellContext`\[CapitalPi]AB, \
$CellContext`\[CapitalPi]BA, $CellContext`\[CapitalPi]BB}, {$CellContext`\
\[CapitalPi]AA, $CellContext`\[CapitalPi]AB, $CellContext`\[CapitalPi]BA, \
$CellContext`\[CapitalPi]BB} = $CellContext`payoffs; Sum[
             Piecewise[{{
                $CellContext`PAOneA[$CellContext`i, $CellContext`k, \
$CellContext`qAA], $CellContext`\[CapitalPi]A[$CellContext`i, $CellContext`k, \
$CellContext`\[CapitalPi]AA, $CellContext`\[CapitalPi]AB] <= $CellContext`x}},
               0], {$CellContext`i, 
              1, $CellContext`k}]^$CellContext`kA]; \
$CellContext`StrictCumulativeProbabilityBestPayoffAmongANbrsAOneA[
          Pattern[$CellContext`x, 
           Blank[]], 
          Pattern[$CellContext`kA, 
           Blank[]], 
          Pattern[$CellContext`k, 
           Blank[]], 
          Pattern[$CellContext`payoffs, 
           Blank[]], 
          Pattern[$CellContext`qAA, 
           Blank[]]] := 
        Module[{$CellContext`\[CapitalPi]AA, $CellContext`\[CapitalPi]AB, \
$CellContext`\[CapitalPi]BA, $CellContext`\[CapitalPi]BB}, {$CellContext`\
\[CapitalPi]AA, $CellContext`\[CapitalPi]AB, $CellContext`\[CapitalPi]BA, \
$CellContext`\[CapitalPi]BB} = $CellContext`payoffs; Sum[
             Piecewise[{{
                $CellContext`PAOneA[$CellContext`i, $CellContext`k, \
$CellContext`qAA], $CellContext`\[CapitalPi]A[$CellContext`i, $CellContext`k, \
$CellContext`\[CapitalPi]AA, $CellContext`\[CapitalPi]AB] < $CellContext`x}}, 
              0], {$CellContext`i, 
              1, $CellContext`k}]^$CellContext`kA]; \
$CellContext`ProbabilityBestPayoffAmongANbrsAOneA[
          Pattern[$CellContext`x, 
           Blank[]], 
          Pattern[$CellContext`kA, 
           Blank[]], 
          Pattern[$CellContext`k, 
           Blank[]], 
          Pattern[$CellContext`payoffs, 
           Blank[]], 
          Pattern[$CellContext`qAA, 
           
           Blank[]]] := \
$CellContext`CumulativeProbabilityBestPayoffAmongANbrsAOneA[$CellContext`x, \
$CellContext`kA, $CellContext`k, $CellContext`payoffs, $CellContext`qAA] - \
$CellContext`StrictCumulativeProbabilityBestPayoffAmongANbrsAOneA[$\
CellContext`x, $CellContext`kA, $CellContext`k, $CellContext`payoffs, \
$CellContext`qAA]; Null}; Typeset`initDone$$ = True),
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellLabel->"Out[2]=",ExpressionUUID->"9435b60f-9635-44aa-ac53-506e5de91023"],

Cell["\<\
You can also use this notebook to replicate some of the results in the \
following papers:\
\>", "Text",ExpressionUUID->"021aea6b-5e2b-4058-85f8-5552c48ddfc5"],

Cell[TextData[{
 StyleBox["Hauert, C. and Doebeli, M. (2004). Spatial structure often \
inhibits the evolution of cooperation in the snowdrift game. ", "Item"],
 StyleBox["Nature", "Item",
  FontSlant->"Italic"],
 StyleBox[", 428:643\[Dash]646. http://dx.doi.org/10.1038/nature02360", "Item"]
}], "Item",ExpressionUUID->"cff5d4dc-3f61-4bdd-8771-9f7b6b96d81f"],

Cell[TextData[{
 StyleBox["Hauert, C. and Szab\[OAcute], G. (2005). Game theory and physics. \
", "Item"],
 StyleBox["American Journal of Physics", "Item",
  FontSlant->"Italic"],
 StyleBox[", 73(5):405\[Dash]414. https://doi.org/10.1119/1.1848514", "Item"]
}], "Item",ExpressionUUID->"2ca8f976-df16-491d-9adf-ee3a9cf8a092"],

Cell[TextData[{
 StyleBox["Fu, F., Nowak, M. A., and Hauert, C. (2010). Invasion and \
expansion of cooperators in lattice populations: Prisoner\[CloseCurlyQuote]s \
dilemma vs. snowdrift games. ", "Item"],
 StyleBox["Journal of Theoretical Biology", "Item",
  FontSlant->"Italic"],
 StyleBox[", \
266(3):358\[Dash]366.\[NonBreakingSpace]https://doi.org/10.1016/j.jtbi.2010.\
06.042", "Item"]
}], "Item",ExpressionUUID->"c3352103-912e-4d0d-a932-79dfb6d96bba"],

Cell[TextData[{
 "Please, note that the menu \[OpenCurlyDoubleQuote]Presets for replication\
\[CloseCurlyDoubleQuote] only works for versions 13.3 or higher of \
Mathematica and Wolfram Player. You can download the Wolfram Player for free \
at https://www.wolfram.com/player/.\n\nIf you find this notebook useful, we \
would appreciate it if you cited it as follows: \[LineSeparator]Izquierdo, \
Luis R.; Izquierdo, Segismundo S.; Hauert, Christoph (2024). Pair \
approximation for 2x2 symmetric games on regular networks. Software. DOI: ",
 ButtonBox["10.5281/zenodo.10975164",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.5281/zenodo.10975164"], None},
  ButtonNote->"https://doi.org/10.5281/zenodo.10975164"],
 ". "
}], "Text",ExpressionUUID->"6ceadfdc-305c-40ae-91bb-bfcef2ce55de"],

Cell[CellGroupData[{

Cell["License: GPLv3", "Section",ExpressionUUID->"55447b59-612e-4591-8e42-22aa94d55bf5"],

Cell[TextData[{
 "This is a ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " notebook created to solve \nthe pair approximation in 2x2 symmetric games \
on regular networks.\nCopyright (C) 2024.\n",
 ButtonBox["Luis R. Izquierdo",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://luis.izqui.org"], None},
  ButtonNote->"http://luis.izqui.org"],
 ", ",
 ButtonBox["Segismundo S. Izquierdo",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://www.segis.izqui.org"], None},
  ButtonNote->"http://www.segis.izqui.org"],
 " and ",
 ButtonBox["Christoph Hauert",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://personal.math.ubc.ca/~hauert/"], None},
  ButtonNote->"https://personal.math.ubc.ca/~hauert/"],
 ".\n \nThis program is free software: you can redistribute it and/or modify\n\
it under the terms of the GNU General Public License as published by\nthe \
Free Software Foundation, either version 3 of the License, or\n(at your \
option) any later version.\n\nThis program is distributed in the hope that it \
will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty \
of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  \[LineSeparator]See \
the GNU General Public License for more details.\n\nYou can find a copy of \
the GNU General Public License \nat ",
 ButtonBox["https://www.gnu.org/licenses/gpl.html",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://www.gnu.org/licenses/gpl.html"], None},
  ButtonNote->"https://www.gnu.org/licenses/gpl.html"],
 ".\n\nWe gratefully acknowledge financial support from \nthe Spanish State \
Research Agency \n(PID2020-118906GB-I00/AEI/10.13039/501100011033), \nfrom \
the Regional Government of Castilla y Le\[OAcute]n and the EU-FEDER program \n\
(CLU-2019-04 \[Dash] BIOECOUVA Unit of Excellence of the University of \
Valladolid), \nand from the Spanish Ministry of Universities (PRX22/00064 and \
PRX22/00065). \n\nContact information: \nLuis R. Izquierdo \nUniversity of \
Burgos, Spain. \nwebsite: ",
 ButtonBox["http://www.luis.izqui.org",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://www.luis.izqui.org"], None},
  ButtonNote->"http://www.luis.izqui.org"]
}], "Text",ExpressionUUID->"3e570553-cd0b-47f0-bf9b-dcd4a5acb375"]
}, Closed]],

Cell[CellGroupData[{

Cell["Source code", "Section",ExpressionUUID->"d7fc9b4c-924e-445b-8538-aebcffdbf017"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", " ", 
      RowBox[{
      "\[Rho]A", ",", "\[Rho]B", ",", "qAA", ",", "xAA", ",", "qAB", ",", 
       "qBA", ",", "payoffs", ",", "initialxA", ",", "initialqAA", ",", 
       "rulesToAddt", ",", "t", ",", 
       RowBox[{"maxTime", "=", "100000"}], ",", 
       RowBox[{"tolerance", "=", 
        RowBox[{"10", "^", 
         RowBox[{"-", "8"}]}]}], ",", 
       RowBox[{"accuracyGoal", "=", "6"}], ",", " ", "maxDiff", ",", "mR", 
       ",", 
       RowBox[{"errorPA", "=", "False"}], ",", 
       RowBox[{"errorMD", "=", "False"}], ",", " ", 
       RowBox[{"tooLong", "=", "False"}], ",", "limitingxPA", ",", " ", 
       "limitingqPA", ",", "limitingxMD", ",", 
       RowBox[{"epsilon", "=", 
        RowBox[{"10", "^", 
         RowBox[{"-", "4"}]}]}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"payoffs", "=", 
       RowBox[{"Rationalize", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a11", ",", "a12", ",", "a21", ",", "a22"}], "}"}], ",", 
         "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"initialxA", ",", "initialqAA"}], "}"}], "=", 
       RowBox[{"Rationalize", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"initxA", ",", "initqAA"}], "}"}], ",", "0"}], "]"}]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "We", " ", "define", " ", "actualFinalTime", " ", "and", " ", 
        "actualFinalTimeMD", " ", "with", " ", "such", " ", "long", " ", 
        "names", " ", "and", " ", "as", " ", "global", " ", "variables", " ", 
        "to", " ", "be", " ", "able", " ", "to", " ", "use", " ", "them", " ",
         "inside", " ", "the", " ", "nested", " ", "Manipulate", " ", "to", 
        " ", "zoom", " ", "in", " ", "the", " ", "Plot"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"actualFinalTimePA", "=", "maxTime"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"actualFinalTimeMD", "=", "maxTime"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Basic", " ", "variables"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"xAA", "=", " ", 
       RowBox[{"\[Rho]A", " ", "qAA"}]}], " ", ";", "\[IndentingNewLine]", 
      RowBox[{"\[Rho]B", "=", 
       RowBox[{"1", "-", "\[Rho]A"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"qBA", "=", 
       RowBox[{"(", 
        RowBox[{"1", "-", "qAA"}], " ", ")"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"qAB", "=", 
       RowBox[{
        FractionBox["\[Rho]A", 
         RowBox[{"1", "-", "\[Rho]A"}]], 
        RowBox[{"(", 
         RowBox[{"1", "-", "qAA"}], " ", ")"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "The", " ", "following", " ", "two", " ", "lines", " ", "are", " ", 
        "for", " ", "imitative", " ", "pairwise", " ", "difference", " ", 
        "only"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"maxDiff", "=", 
       RowBox[{"Max", "@", 
        RowBox[{"Outer", "[", 
         RowBox[{"Subtract", ",", "payoffs", ",", "payoffs"}], "]"}]}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"maxDiff", "==", "0"}], ",", 
        RowBox[{"maxDiff", "=", "1"}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "To", " ", "avoid", " ", "division", " ", "by", " ", "zero", " ", "in",
         " ", "case", " ", "all", " ", "payoffs", " ", "are", " ", "equal"}], 
       "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"mR", "=", 
       RowBox[{"Rationalize", "[", 
        RowBox[{"m", ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Differential", " ", "equations"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"rulesToAddt", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Rho]A", "'"}], "->", 
          RowBox[{
           RowBox[{"\[Rho]A", "'"}], "[", "t", "]"}]}], ",", 
         RowBox[{"\[Rho]A", "->", 
          RowBox[{"\[Rho]A", "[", "t", "]"}]}], ",", 
         RowBox[{"qAA", " ", "->", 
          RowBox[{"qAA", " ", "[", "t", "]"}]}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"xAA", "'"}], "=", 
       RowBox[{
        RowBox[{"\[Rho]B", 
         RowBox[{
          SubsuperscriptBox["\[Sum]", 
           RowBox[{"kA", "=", "0"}], "k"], 
          RowBox[{
           RowBox[{"PB", "[", 
            RowBox[{"kA", ",", "k", ",", "qAB"}], "]"}], 
           RowBox[{"FB", "[", 
            RowBox[{
            "kA", ",", "k", ",", "maxDiff", ",", "mR", ",", "payoffs", ",", 
             "qAA", ",", "qAB"}], "]"}], 
           FractionBox[
            RowBox[{"2", "kA"}], "k"]}]}]}], "  ", "-", 
        RowBox[{"\[Rho]A", 
         RowBox[{
          SubsuperscriptBox["\[Sum]", 
           RowBox[{"kA", "=", "0"}], "k"], 
          RowBox[{
           RowBox[{"PA", "[", 
            RowBox[{"kA", ",", "k", ",", "qAA"}], "]"}], 
           RowBox[{"FA", "[", 
            RowBox[{
            "kA", ",", "k", ",", "maxDiff", ",", "mR", ",", "payoffs", ",", 
             "qAA", ",", "qAB"}], "]"}], 
           FractionBox[
            RowBox[{"2", "kA"}], "k"]}]}]}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "We", " ", "define", " ", "pairApproximationSolution", " ", "with", 
        " ", "such", " ", "a", " ", "long", " ", "name", " ", "and", " ", 
        "as", " ", "a", " ", "global", " ", "variable", " ", "to", " ", "be", 
        " ", "able", " ", "to", " ", "use", " ", "it", " ", "inside", " ", 
        "the", " ", "nested", " ", "Manipulate", " ", "to", " ", "zoom", " ", 
        "in", " ", "the", " ", "Plot"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"pairApproximationSolution", "=", 
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"$MaxExtraPrecision", "=", "1000"}], "}"}], ",", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"$MaxExtraPrecision", "=", "1000"}], "}"}], " ", "is", 
           " ", "to", " ", "deal", " ", "with", " ", "some", " ", "cases", 
           " ", "with", " ", "Fermi"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"TimeConstrained", "[", 
          RowBox[{
           RowBox[{"Quiet", "@", 
            RowBox[{"Check", "[", 
             RowBox[{
              RowBox[{"NDSolveValue", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"\[Rho]A", "'"}], "[", "t", "]"}], "==", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"\[Rho]B", 
                    RowBox[{
                    SubsuperscriptBox["\[Sum]", 
                    RowBox[{"kA", "=", "0"}], "k"], 
                    RowBox[{
                    RowBox[{"PB", "[", 
                    RowBox[{"kA", ",", "k", ",", "qAB"}], "]"}], 
                    RowBox[{"FB", "[", 
                    RowBox[{
                    "kA", ",", "k", ",", "maxDiff", ",", "mR", ",", "payoffs",
                     ",", "qAA", ",", "qAB"}], "]"}]}]}]}], "-", 
                    RowBox[{"\[Rho]A", 
                    RowBox[{
                    SubsuperscriptBox["\[Sum]", 
                    RowBox[{"kA", "=", "0"}], "k"], 
                    RowBox[{
                    RowBox[{"PA", "[", 
                    RowBox[{"kA", ",", "k", ",", "qAA"}], "]"}], 
                    RowBox[{"FA", "[", 
                    RowBox[{
                    "kA", ",", "k", ",", "maxDiff", ",", "mR", ",", "payoffs",
                     ",", "qAA", ",", "qAB"}], "]"}]}]}]}]}], "/.", 
                    "rulesToAddt"}], ")"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"qAA", " ", "'"}], "[", "t", "]"}], "==", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    FractionBox[
                    RowBox[{"xAA", "'"}], "\[Rho]A"], "-", 
                    RowBox[{
                    FractionBox["xAA", 
                    SuperscriptBox["\[Rho]A", "2"]], 
                    RowBox[{"\[Rho]A", "'"}]}]}], "/.", "rulesToAddt"}], 
                    ")"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"\[Rho]A", "[", "0", "]"}], "==", "initialxA"}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"qAA", " ", "[", "0", "]"}], "==", "initialqAA"}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{"WhenEvent", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Norm", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"\[Rho]A", "'"}], "[", "t", "]"}], ",", 
                    RowBox[{
                    RowBox[{"qAA", " ", "'"}], "[", "t", "]"}]}], "}"}], 
                    "]"}], "-", "tolerance"}], "<", "0"}], "}"}], ",", " ", 
                    RowBox[{"\"\<StopIntegration\>\"", ";", 
                    RowBox[{"actualFinalTimePA", "=", "t"}]}]}], "]"}]}], 
                 "}"}], ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"\[Rho]A", ",", "qAA"}], " ", "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"t", ",", "0", ",", "maxTime"}], "}"}], ",", 
                RowBox[{"AccuracyGoal", "\[Rule]", "accuracyGoal"}], ",", 
                RowBox[{"MaxSteps", "->", "Infinity"}], ",", 
                RowBox[{"WorkingPrecision", "\[Rule]", "20"}], ",", 
                RowBox[{"Method", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                   "\"\<TimeIntegration\>\"", "->", 
                    "\"\<StiffnessSwitching\>\""}], ",", 
                   RowBox[{"\"\<EquationSimplification\>\"", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Solve\>\"", ",", " ", 
                    RowBox[{"\"\<TimeConstraint\>\"", "\[Rule]", "10"}]}], 
                    "}"}]}]}], "}"}]}]}], "]"}], ",", 
              RowBox[{
               RowBox[{"errorPA", "=", "True"}], ";", 
               RowBox[{"actualFinalTimePA", "=", "10"}], ";", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "1"}], "&"}], ",", 
                 RowBox[{
                  RowBox[{"-", "1"}], "&"}]}], "}"}]}]}], "]"}]}], 
           "\[IndentingNewLine]", ",", "maxTimeOut"}], "]"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Method", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<StiffnessSwitching\>\"", ",", 
           RowBox[{"\"\<DiscontinuityProcessing\>\"", "\[Rule]", "False"}]}], 
          "}"}]}], ","}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"We", " ", "include", " ", "Method"}], "\[Rule]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<DiscontinuityProcessing\>\"", "\[Rule]", "False"}], 
          "}"}], " ", "to", " ", "avoid", " ", 
         RowBox[{"error", ":", " ", 
          RowBox[{"NDSolve", "::", "smpf"}], ":", 
          RowBox[{
          "Failure", " ", "to", " ", "project", " ", "onto", " ", "the", " ", 
           "discontinuity", " ", "surface", " ", "when", " ", "computing", 
           " ", "Filippov", " ", "continuation", " ", "at", " ", "time", " ", 
           "0"}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"We", " ", "include", " ", "Method"}], "\[Rule]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "\"\<StiffnessSwitching\>\"", "}"}], " ", "and", " ", 
           "WorkingPrecision"}], "\[Rule]", 
          RowBox[{"20", " ", "to", " ", "avoid", " ", 
           RowBox[{"error", ":", " ", 
            RowBox[{"NDSolve", "::", "ndsz"}], ":", 
            RowBox[{
            "\"\<At xxx, step size is effectively zero; singularity or stiff \
system suspected.\>\"", "\[IndentingNewLine]", "See", " ", 
             RowBox[{"https", ":"}]}]}]}]}]}], "//", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"mathematica", ".", "stackexchange", ".", "com"}], "/", 
            "questions"}], "/", "158458"}], "/", "how"}], "-", "to", "-", 
         "evade", "-", "singularity", "-", "or", "-", "stiff", "-", "system", 
         "-", "suspected", "-", "in", "-", "ndsolve"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Method", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "\"\<TimeIntegration\>\"", "->", "\"\<StiffnessSwitching\>\""}], 
          ",", 
          RowBox[{"\"\<EquationSimplification\>\"", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<Solve\>\"", ",", " ", 
             RowBox[{"\"\<TimeConstraint\>\"", "\[Rule]", "10"}]}], "}"}]}]}],
          "}"}]}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "If", " ", "NDSolveValue", " ", "takes", " ", "too", " ", "long"}], 
        ",", " ", 
        RowBox[{"pairApproximationSolution", " ", "==", " ", "$Aborted"}]}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"pairApproximationSolution", "===", "$Aborted"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"tooLong", "=", "True"}], ";", "\[IndentingNewLine]", 
         RowBox[{"pairApproximationSolution", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "1"}], "&"}], ",", 
            RowBox[{
             RowBox[{"-", "1"}], "&"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"actualFinalTimePA", "=", "0"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"actualFinalTimeMD", "=", 
       RowBox[{"Max", "[", 
        RowBox[{"10", ",", "actualFinalTimePA"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"We", " ", "impose", " ", "that", " ", "actualFinalTimeMD"}],
          " ", ">=", " ", "10"}], ",", " ", 
        RowBox[{
         RowBox[{"because", " ", "if", " ", "updateRule"}], " ", "=", " ", 
         RowBox[{
         "\"\<Imitate if better, all nbrs\>\"", " ", "we", " ", "do", " ", 
          "not", " ", "solve", " ", "the", " ", "MD", " ", "with", " ", 
          "NDSolve"}]}], ",", " ", 
        RowBox[{
         RowBox[{"sometimes", " ", "actualFinalTimePA"}], " ", "<", " ", 
         "10"}], ",", " ", 
        RowBox[{
        "but", " ", "the", " ", "solution", " ", "of", " ", "the", " ", "MD", 
         " ", "has", " ", "not", " ", 
         RowBox[{"converged", ".", " ", "The"}], " ", "value", " ", "of", " ",
          "10", " ", "is", " ", "arbitrary"}], ",", " ", 
        RowBox[{"but", " ", "it", " ", "seems", " ", "to", " ", "work", " ", 
         RowBox[{"fine", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Below", " ", "we", " ", "define", " ", "meanDynamicSolution", " ", 
        "with", " ", "such", " ", "a", " ", "long", " ", "name", " ", "and", 
        " ", "as", " ", "a", " ", "global", " ", "variable", " ", "to", " ", 
        "be", " ", "able", " ", "to", " ", "use", " ", "it", " ", "inside", 
        " ", "the", " ", "nested", " ", "Manipulate", " ", "to", " ", "zoom", 
        " ", "in", " ", "the", " ", "Plot"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"meanDynamicSolution", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"updateRule", "!=", "\"\<Imitate if better, all nbrs\>\""}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"Quiet", "@", 
          RowBox[{"Check", "[", 
           RowBox[{
            RowBox[{"NDSolveValue", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Rho]A", "'"}], "[", "t", "]"}], "==", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"ExpectedChange", "[", 
                    RowBox[{
                    "maxDiff", ",", "mR", ",", "payoffs", ",", "\[Rho]A"}], 
                    "]"}], "/.", "rulesToAddt"}], ")"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"\[Rho]A", "[", "0", "]"}], "==", "initialxA"}], ",",
                 "\[IndentingNewLine]", 
                RowBox[{"WhenEvent", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"\[Rho]A", "'"}], "[", "t", "]"}], "]"}], "-", 
                    "tolerance"}], "<", "0"}], ",", " ", 
                  RowBox[{"\"\<StopIntegration\>\"", ";", 
                   RowBox[{"actualFinalTimeMD", "=", "t"}]}]}], "]"}]}], 
               "}"}], ",", "\[IndentingNewLine]", "\[Rho]A", ",", 
              RowBox[{"{", 
               RowBox[{"t", ",", "0", ",", "maxTime"}], "}"}], ",", 
              RowBox[{"AccuracyGoal", "\[Rule]", "accuracyGoal"}], ",", 
              RowBox[{"MaxSteps", "->", "Infinity"}], ",", 
              RowBox[{"Method", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\"\<StiffnessSwitching\>\"", ",", 
                 RowBox[{
                 "\"\<DiscontinuityProcessing\>\"", "\[Rule]", "False"}]}], 
                "}"}]}]}], "]"}], "\[IndentingNewLine]", ",", 
            RowBox[{
             RowBox[{"errorMD", "=", "True"}], ";", 
             RowBox[{"actualFinalTimeMD", "=", "10"}], ";", 
             RowBox[{
              RowBox[{"-", "1"}], "&"}]}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"-", "1"}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Below", " ", "we", " ", "define", " ", 
        "meanDynamicSolutionImitateIfBetterAllNbrs", " ", "with", " ", "such",
         " ", "a", " ", "long", " ", "name", " ", "and", " ", "as", " ", "a", 
        " ", "global", " ", "variable", " ", "to", " ", "be", " ", "able", 
        " ", "to", " ", "use", " ", "it", " ", "inside", " ", "the", " ", 
        "nested", " ", "Manipulate", " ", "to", " ", "zoom", " ", "in", " ", 
        "the", " ", "Plot"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"meanDynamicSolutionImitateIfBetterAllNbrs", "=", 
       RowBox[{"MDsolutionImitateIfBetterAllNbrs", "[", 
        RowBox[{"initialxA", ",", "payoffs"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "update", ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "This", " ", "is", " ", "a", " ", "trick", " ", "to", " ", "make", " ",
         "the", " ", "\"\<update\>\"", " ", "button", " ", "work"}], " ", 
       "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"actualFinalTime", "=", 
       RowBox[{"Max", "[", 
        RowBox[{"actualFinalTimePA", ",", "actualFinalTimeMD"}], "]"}]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"limitingxPA", "=", 
       RowBox[{"Chop", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"First", "[", "pairApproximationSolution", "]"}], "[", 
          "actualFinalTime", "]"}], ",", 
         RowBox[{"10", "^", 
          RowBox[{"-", "5"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"limitingqPA", "=", 
       RowBox[{"Chop", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Last", "[", "pairApproximationSolution", "]"}], "[", 
          "actualFinalTime", "]"}], ",", 
         RowBox[{"10", "^", 
          RowBox[{"-", "5"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Not", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"0", "-", "epsilon"}], "<=", "limitingxPA", "<=", 
              RowBox[{"1", "+", "epsilon"}]}], ")"}], "&&", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"0", "-", "epsilon"}], "<=", "limitingqPA", "<=", 
              RowBox[{"1", "+", "epsilon"}]}], ")"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"errorPA", "=", "True"}], ";", "\[IndentingNewLine]", 
           RowBox[{"pairApproximationSolution", "=", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "1"}], "&"}], ",", 
              RowBox[{
               RowBox[{"-", "1"}], "&"}]}], "}"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"limitingxMD", "=", 
       RowBox[{"meanDynamicSolution", "[", "actualFinalTime", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"updateRule", "!=", "\"\<Imitate if better, all nbrs\>\""}], 
         "&&", "showMD", "&&", 
         RowBox[{"Not", "[", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"0", "-", "epsilon"}], "<=", "limitingxMD", "<=", 
            RowBox[{"1", "+", "epsilon"}]}], ")"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"errorMD", "=", "True"}], ";", "\[IndentingNewLine]", 
         RowBox[{"meanDynamicSolution", "=", 
          RowBox[{
           RowBox[{"-", "1"}], "&"}]}], ";"}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Pane", "[", 
       RowBox[{"Grid", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", "PLOT", " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "Show", " ", "PA", " ", "if", " ", "not", " ", "error", " ", 
               "and", " ", "not", " ", "tooLong"}], ",", " ", "and", ",", " ", 
              RowBox[{"if", " ", "showMD"}], ",", " ", 
              RowBox[{"then", " ", "MD", " ", "too"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Item", "[", 
              RowBox[{
               RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Plot", "[", 
                  RowBox[{
                   RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Evaluate", "@", 
                    RowBox[{"MapThread", "[", 
                    RowBox[{"Tooltip", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", "t2", "]"}], "&"}], ",", 
                    "pairApproximationSolution"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<\[Rho]A\>\"", ",", "\"\<qAA\>\""}], "}"}]}], 
                    "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Evaluate", "@", 
                    RowBox[{"Tooltip", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{"showMD", ",", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    "updateRule", "==", 
                    "\"\<Imitate if better, all nbrs\>\""}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    "meanDynamicSolutionImitateIfBetterAllNbrs", "[", "t2", 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"meanDynamicSolution", "[", "t2", "]"}]}], 
                    "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"-", "1"}]}], "]"}], ",", "\"\<MD\>\""}], 
                    "]"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"t2", ",", "0", ",", 
                    RowBox[{"actualFinalTime", "/", 
                    RowBox[{"z", "^", "2"}]}]}], "}"}], ",", 
                   RowBox[{"PlotLegends", "\[Rule]", 
                    RowBox[{"LineLegend", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Directive", "[", 
                    RowBox[{
                    
                    TemplateBox[<|
                    "color" -> RGBColor[0.368417, 0.506779, 0.709798]|>,
                    "RGBColorSwatchTemplate"], ",", 
                    RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"Directive", "[", 
                    RowBox[{
                    
                    TemplateBox[<|
                    "color" -> RGBColor[0.880722, 0.611041, 0.142051]|>,
                    "RGBColorSwatchTemplate"], ",", 
                    RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"Directive", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{"showMD", ",", "Black", ",", "White"}], "]"}], 
                    ",", 
                    RowBox[{"AbsoluteThickness", "[", "2", "]"}], ",", 
                    "Dashed"}], "]"}]}], "}"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{"showMD", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<\!\(\*SubscriptBox[\(x\), \(A\)]\)\>\"", ",", 
                    "\"\<\!\(\*SubscriptBox[\(q\), \(AA\)]\)\>\"", ",", 
                    "\"\<MD\>\""}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<\!\(\*SubscriptBox[\(x\), \(A\)]\)\>\"", ",", 
                    "\"\<\!\(\*SubscriptBox[\(q\), \(AA\)]\)\>\"", ",", 
                    "\"\<\>\""}], "}"}]}], "]"}]}], "]"}]}], ",", 
                   RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
                   RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "Automatic"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "0.01"}], ",", "1.01"}], "}"}]}], "}"}]}], 
                   ",", 
                   RowBox[{"AxesLabel", "->", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<\!\(\*StyleBox[\"t\",FontSlant->\"Italic\"]\)\>\"", 
                    ",", "None"}], "}"}]}], ",", 
                   RowBox[{"PlotStyle", "->", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Directive", "[", 
                    RowBox[{
                    
                    TemplateBox[<|
                    "color" -> RGBColor[0.368417, 0.506779, 0.709798]|>,
                    "RGBColorSwatchTemplate"], ",", 
                    RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], 
                    ",", " ", 
                    RowBox[{"Directive", "[", 
                    RowBox[{
                    
                    TemplateBox[<|
                    "color" -> RGBColor[0.880722, 0.611041, 0.142051]|>,
                    "RGBColorSwatchTemplate"], ",", 
                    RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], 
                    ",", " ", 
                    RowBox[{"Directive", "[", 
                    RowBox[{"Black", ",", 
                    RowBox[{"AbsoluteThickness", "[", "2", "]"}], ",", 
                    "Dashed"}], "]"}]}], "}"}]}], ",", 
                   RowBox[{"ImageSize", "\[Rule]", "450"}]}], "]"}], 
                 "\[IndentingNewLine]", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"z", ",", "1", ",", "\"\<zoom\>\""}], "}"}], ",", 
                   "1", ",", "100"}], "}"}], ",", 
                 RowBox[{"SynchronousUpdating", "\[Rule]", "True"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"ContinuousAction", "\[Rule]", "True"}], ",", 
                 RowBox[{"AppearanceElements", "\[Rule]", "None"}], ",", 
                 RowBox[{"Paneled", "\[Rule]", "False"}]}], "]"}], ",", 
               RowBox[{"Alignment", "->", "Center"}]}], "]"}], ",", 
             "SpanFromLeft", ",", "SpanFromLeft"}], "\[IndentingNewLine]", 
            "}"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"FIRST", " ", "ROW"}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Not", "[", "errorPA", "]"}], "&&", 
                  RowBox[{"Not", "[", "tooLong", "]"}]}], ")"}], "||", 
                RowBox[{"(", 
                 RowBox[{"showMD", "&&", 
                  RowBox[{"Not", "[", "errorMD", "]"}]}], ")"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Row", "[", 
                RowBox[{"{", 
                 RowBox[{
                 "\"\<Numerical integration stopped at \
\!\(\*StyleBox[\"t\",FontSlant->\"Italic\"]\)=\>\"", ",", 
                  RowBox[{"ScientificForm", "[", 
                   RowBox[{
                    RowBox[{"N", "@", 
                    RowBox[{"Floor", "@", "actualFinalTime"}]}], ",", "3"}], 
                   "]"}], ",", " ", "\"\< because \>\"", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"actualFinalTime", "<", "maxTime"}], ",", 
                    "\"\<all computed values stabilized at that time\>\"", 
                    ",", "\"\<that is the maximum time set for \
integration\>\""}], "]"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
               "\"\<\>\""}], "]"}], ",", "SpanFromLeft", ",", 
             "SpanFromLeft"}], "\[IndentingNewLine]", "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"SECOND", " ", "ROW"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"THIRD", " ", "ROW"}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"\"\<Pair Approximation\>\"", ",", "Black", ",", "14"}],
               "]"}], ",", "\[IndentingNewLine]", "\"\<\>\"", ",", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{"showMD", ",", 
               RowBox[{"Style", "[", 
                RowBox[{
                "\"\<Mean Dynamic (MD)\>\"", ",", "Black", ",", "14"}], "]"}],
                ",", "\"\<\>\""}], "]"}]}], "\[IndentingNewLine]", "}"}], 
           "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"FOURTH", " ", "ROW"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"R2", ",", " ", "c1"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{"errorPA", ",", "\[IndentingNewLine]", 
               RowBox[{"Style", "[", 
                RowBox[{
                "\"\<Numerical instability\>\"", ",", "Red", ",", "12"}], 
                "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{"tooLong", ",", " ", "\[IndentingNewLine]", 
                 RowBox[{"Style", "[", 
                  RowBox[{
                  "\"\<Solving the pair approximation\>\"", ",", "Red", ",", 
                   "12"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{"Everything", " ", "ok"}], "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{"Style", "[", 
                  RowBox[{
                   RowBox[{"Row", "[", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    "\"\<\!\(\*SubscriptBox[StyleBox[\"x\",FontSlant->\"\
Italic\"], \"A\"]\)(\!\(\*StyleBox[\"t\",FontSlant->\"Italic\"]\)=\>\"", ",", 
                    RowBox[{"ScientificForm", "[", 
                    RowBox[{
                    RowBox[{"N", "@", 
                    RowBox[{"Floor", "@", "actualFinalTime"}]}], ",", "3"}], 
                    "]"}], ",", "\"\<) = \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{"limitingxPA", ",", "3"}], "]"}]}], 
                    "\[IndentingNewLine]", "}"}], "]"}], ",", 
                   RowBox[{"Darker", "[", "Blue", "]"}], ",", "12"}], "]"}]}],
                 "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}],
              ",", "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{"R2", ",", " ", "c2"}], " ", "*)"}], 
             "\[IndentingNewLine]", "\"\<\>\"", ",", "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{"R2", ",", " ", "c3"}], " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{"showMD", ",", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{"errorMD", ",", "\[IndentingNewLine]", 
                 RowBox[{"Style", "[", 
                  RowBox[{
                  "\"\<Numerical instability\>\"", ",", "Red", ",", "12"}], 
                  "]"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
                 RowBox[{"Style", "[", 
                  RowBox[{
                   RowBox[{"Row", "[", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    "\"\<\!\(\*SubscriptBox[StyleBox[\"x\",FontSlant->\"\
Italic\"], \"A\"]\)(\!\(\*StyleBox[\"t\",FontSlant->\"Italic\"]\)=\>\"", ",", 
                    RowBox[{"ScientificForm", "[", 
                    RowBox[{
                    RowBox[{"N", "@", 
                    RowBox[{"Floor", "@", "actualFinalTime"}]}], ",", "3"}], 
                    "]"}], ",", "\"\<) = \>\"", ",", "\[IndentingNewLine]", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"Chop", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    "updateRule", "==", 
                    "\"\<Imitate if better, all nbrs\>\""}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Quiet", "@", 
                    RowBox[{"N", "[", 
                    RowBox[{
                    "meanDynamicSolutionImitateIfBetterAllNbrs", "[", 
                    "actualFinalTime", "]"}], "]"}]}], ",", "limitingxMD"}], 
                    "]"}], "\[IndentingNewLine]", ",", 
                    RowBox[{"10", "^", 
                    RowBox[{"-", "5"}]}]}], "]"}], ",", "3"}], "]"}]}], 
                    "\[IndentingNewLine]", "}"}], "]"}], ",", "Black", ",", 
                   "12"}], "]"}]}], "\[IndentingNewLine]", "]"}], 
               "\[IndentingNewLine]", ",", "\"\<\>\""}], "]"}]}], 
            "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"FIFTH", " ", "ROW"}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"R3", ",", " ", "c1"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{"errorPA", ",", "\[IndentingNewLine]", 
               RowBox[{"Style", "[", 
                RowBox[{
                "\"\<Please, try changing the initial conditions\>\"", ",", 
                 "Black", ",", "10"}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{"tooLong", ",", " ", "\[IndentingNewLine]", 
                 RowBox[{"Style", "[", 
                  RowBox[{
                   RowBox[{"\"\<takes longer than maxTimeOut = \>\"", "<>", 
                    RowBox[{"ToString", "[", "maxTimeOut", "]"}], "<>", 
                    "\"\<s.\>\""}], ",", "Red", ",", "12"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{
                   RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"maxTimeOut", "<", "20"}], ",", 
                    "\"\<You may wish to increase maxTimeOut\>\"", ",", 
                    "\"\<\>\""}], "]"}], ",", "10"}], "]"}], ","}], "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{"Everything", " ", "ok"}], "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{"Style", "[", 
                  RowBox[{
                   RowBox[{"Row", "[", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    "\"\<\!\(\*SubscriptBox[StyleBox[\"q\",FontSlant->\"\
Italic\"], \"AA\"]\)(\!\(\*StyleBox[\"t\",FontSlant->\"Italic\"]\)=\>\"", ",", 
                    RowBox[{"ScientificForm", "[", 
                    RowBox[{
                    RowBox[{"N", "@", 
                    RowBox[{"Floor", "@", "actualFinalTime"}]}], ",", "3"}], 
                    "]"}], ",", "\"\<) = \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{"limitingqPA", ",", "3"}], "]"}]}], 
                    "\[IndentingNewLine]", "}"}], "]"}], ",", 
                   RowBox[{"Darker", "[", "Orange", "]"}], ",", "12"}], 
                  "]"}]}], "\[IndentingNewLine]", "]"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{"R3", ",", " ", "c2"}], " ", "*)"}], 
             "\[IndentingNewLine]", "\"\<\>\"", ",", "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{"R3", ",", " ", "c3"}], " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"showMD", "&&", "errorMD"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Style", "[", 
                RowBox[{
                "\"\<Please, try changing initial cond.\>\"", ",", "Black", 
                 ",", "10"}], "]"}], ",", "\[IndentingNewLine]", "\"\<\>\""}],
               "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}],
           "\[IndentingNewLine]", "}"}], ",", 
         RowBox[{"Alignment", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"Left", ",", "Center", ",", "Right"}], "}"}], "}"}]}]}], 
        "]"}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}],
    ",", " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "End", " ", "of", " ", "Module", " ", "right", " ", "after", " ", 
     "Manipulate"}], " ", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"MANIPULATE", " ", "PARAMETERS"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "We", " ", "want", " ", "all", " ", "parameteres", " ", "to", " ", "be", 
      " ", "controlled", " ", "by", " ", "Manipulate"}], ",", " ", 
     RowBox[{
     "but", " ", "we", " ", "also", " ", "want", " ", "to", " ", "customize", 
      " ", "the", " ", 
      RowBox[{"interface", ".", " ", "Because"}], " ", "of", " ", "this"}], 
     ",", " ", 
     RowBox[{
     "we", " ", "define", " ", "all", " ", "parameters", " ", "here", " ", 
      "following", " ", "the", " ", "Manipulate", " ", "approach"}], ",", " ", 
     RowBox[{
      RowBox[{"but", " ", "with", " ", "ControlType"}], "\[Rule]", "None"}], 
     ",", " ", 
     RowBox[{
     "and", " ", "we", " ", "create", " ", "our", " ", "customized", " ", 
      "controls", " ", "later"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"preset", ",", "\"\<Hauert Doebeli 2004 fig1b r=0.2\>\""}], 
      "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a11", ",", "1"}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a12", ",", "0.8"}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a21", ",", "1.2"}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a22", ",", "0"}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"gameName", ",", "\"\<Snowdrift\>\""}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"k", ",", "4"}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", " ", 
   RowBox[{"(*", " ", "degree", " ", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"update", ",", "0"}], "}"}], ",", "0", ",", "100", ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"updateRule", ",", "\"\<Imitative pairwise difference\>\""}], 
      "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", ",", "1"}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"initxA", ",", "0.5"}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"initqAA", ",", "0.5"}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"showMD", ",", "True"}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"maxTimeOut", ",", "1"}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"CUSTOMIZED", " ", "INTERFACE", " ", "FOR", " ", "PARAMETERS"}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Style", "[", 
    RowBox[{"\"\<Presets for replication\>\"", ",", "Bold", ",", "Medium"}], 
    "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Row", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ActionMenu", "[", 
       RowBox[{
        RowBox[{"Dynamic", "[", "preset", "]"}], ",", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\"\<Hauert & Doebeli (2004)\>\"", "->", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"\"\<fig1b r=0.2\>\"", "\[RuleDelayed]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"a11", "=", "1"}], ";", 
                RowBox[{"a12", "=", "0.8"}], ";", 
                RowBox[{"a21", "=", "1.2"}], ";", 
                RowBox[{"a22", "=", "0"}], ";", 
                RowBox[{"update", "=", "1000"}], ";", 
                RowBox[{"gameName", "=", "\"\<Snowdrift\>\""}], ";", 
                RowBox[{
                "updateRule", "=", "\"\<Imitative pairwise difference\>\""}], 
                ";", 
                RowBox[{"k", "=", "4"}], ";", 
                RowBox[{"initxA", "=", "0.5"}], ";", 
                RowBox[{"initqAA", "=", "0.5"}], ";", 
                RowBox[{"showMD", "=", "True"}], ";", 
                RowBox[{
                "preset", "=", "\"\<Hauert Doebeli 2004 fig1b r=0.2\>\""}]}], 
               ")"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"\"\<fig1b r=0.5\>\"", "\[RuleDelayed]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"a11", "=", "1"}], ";", 
                RowBox[{"a12", "=", "0.5"}], ";", 
                RowBox[{"a21", "=", "1.5"}], ";", 
                RowBox[{"a22", "=", "0"}], ";", 
                RowBox[{"update", "=", "2000"}], ";", 
                RowBox[{"gameName", "=", "\"\<Snowdrift\>\""}], ";", 
                RowBox[{
                "updateRule", "=", "\"\<Imitative pairwise difference\>\""}], 
                ";", 
                RowBox[{"k", "=", "4"}], ";", 
                RowBox[{"initxA", "=", "0.5"}], ";", 
                RowBox[{"initqAA", "=", "0.5"}], ";", 
                RowBox[{"showMD", "=", "True"}], ";", 
                RowBox[{
                "preset", "=", "\"\<Hauert Doebeli 2004 fig1b r=0.5\>\""}]}], 
               ")"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"\"\<fig1b r=0.9\>\"", "\[RuleDelayed]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"a11", "=", "1"}], ";", 
                RowBox[{"a12", "=", "0.1"}], ";", 
                RowBox[{"a21", "=", "1.9"}], ";", 
                RowBox[{"a22", "=", "0"}], ";", 
                RowBox[{"update", "=", "3000"}], ";", 
                RowBox[{"gameName", "=", "\"\<Snowdrift\>\""}], ";", 
                RowBox[{
                "updateRule", "=", "\"\<Imitative pairwise difference\>\""}], 
                ";", 
                RowBox[{"k", "=", "4"}], ";", 
                RowBox[{"initxA", "=", "0.5"}], ";", 
                RowBox[{"initqAA", "=", "0.5"}], ";", 
                RowBox[{"showMD", "=", "True"}], ";", 
                RowBox[{
                "preset", "=", "\"\<Hauert Doebeli 2004 fig1b r=0.9\>\""}]}], 
               ")"}]}], ",", "\[IndentingNewLine]", "Delimiter", ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<fig1d r=0.2\>\"", "\[RuleDelayed]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"a11", "=", "1"}], ";", 
                RowBox[{"a12", "=", "0.8"}], ";", 
                RowBox[{"a21", "=", "1.2"}], ";", 
                RowBox[{"a22", "=", "0"}], ";", 
                RowBox[{"update", "=", "5000"}], ";", 
                RowBox[{"gameName", "=", "\"\<Snowdrift\>\""}], ";", 
                RowBox[{
                "updateRule", "=", "\"\<Imitative pairwise difference\>\""}], 
                ";", 
                RowBox[{"k", "=", "8"}], ";", 
                RowBox[{"initxA", "=", "0.5"}], ";", 
                RowBox[{"initqAA", "=", "0.5"}], ";", 
                RowBox[{"showMD", "=", "True"}], ";", 
                RowBox[{
                "preset", "=", "\"\<Hauert Doebeli 2004 fig1d r=0.2\>\""}]}], 
               ")"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"\"\<fig1d r=0.5\>\"", "\[RuleDelayed]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"a11", "=", "1"}], ";", 
                RowBox[{"a12", "=", "0.5"}], ";", 
                RowBox[{"a21", "=", "1.5"}], ";", 
                RowBox[{"a22", "=", "0"}], ";", 
                RowBox[{"update", "=", "6000"}], ";", 
                RowBox[{"gameName", "=", "\"\<Snowdrift\>\""}], ";", 
                RowBox[{
                "updateRule", "=", "\"\<Imitative pairwise difference\>\""}], 
                ";", 
                RowBox[{"k", "=", "8"}], ";", 
                RowBox[{"initxA", "=", "0.5"}], ";", 
                RowBox[{"initqAA", "=", "0.5"}], ";", 
                RowBox[{"showMD", "=", "True"}], ";", 
                RowBox[{
                "preset", "=", "\"\<Hauert Doebeli 2004 fig1d r=0.5\>\""}]}], 
               ")"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"\"\<fig1d r=0.9\>\"", "\[RuleDelayed]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"a11", "=", "1"}], ";", 
                RowBox[{"a12", "=", "0.1"}], ";", 
                RowBox[{"a21", "=", "1.9"}], ";", 
                RowBox[{"a22", "=", "0"}], ";", 
                RowBox[{"update", "=", "7000"}], ";", 
                RowBox[{"gameName", "=", "\"\<Snowdrift\>\""}], ";", 
                RowBox[{
                "updateRule", "=", "\"\<Imitative pairwise difference\>\""}], 
                ";", 
                RowBox[{"k", "=", "8"}], ";", 
                RowBox[{"initxA", "=", "0.5"}], ";", 
                RowBox[{"initqAA", "=", "0.5"}], ";", 
                RowBox[{"showMD", "=", "True"}], ";", 
                RowBox[{
                "preset", "=", "\"\<Hauert Doebeli 2004 fig1d r=0.9\>\""}]}], 
               ")"}]}]}], "\[IndentingNewLine]", "}"}]}], 
          "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<Hauert & Szab\[OAcute] (2005)\>\"", "->", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"\"\<fig5 r=0\>\"", "\[RuleDelayed]", 
              RowBox[{"(", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"a11", "=", "1"}], ";", 
                RowBox[{"a12", "=", "0"}], ";", 
                RowBox[{"a21", "=", "1"}], ";", 
                RowBox[{"a22", "=", "0"}], ";", 
                RowBox[{"update", "=", "15500"}], ";", 
                RowBox[{"gameName", "=", "\"\<Weak Prisoner's D\>\""}], ";", 
                RowBox[{
                "updateRule", "=", 
                 "\"\<Fermi (set intensity \
\!\(\*StyleBox[\"m\",FontSlant->\"Italic\"]\))\>\""}], ";", 
                RowBox[{"k", "=", "4"}], ";", 
                RowBox[{"m", "=", "40"}], ";", 
                RowBox[{"initxA", "=", "0.5"}], ";", 
                RowBox[{"initqAA", "=", "0.5"}], ";", 
                RowBox[{"showMD", "=", "False"}], ";", 
                RowBox[{"maxTimeOut", "=", "20"}], ";", 
                RowBox[{
                "preset", "=", 
                 "\"\<Hauert Szab\[OAcute] 2005 fig5 r=0.01\>\""}]}], ")"}]}],
              ",", "\[IndentingNewLine]", 
             RowBox[{"\"\<fig5 r=0.01\>\"", "\[RuleDelayed]", 
              RowBox[{"(", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"a11", "=", "1"}], ";", 
                RowBox[{"a12", "=", 
                 RowBox[{"-", ".01"}]}], ";", 
                RowBox[{"a21", "=", "1.01"}], ";", 
                RowBox[{"a22", "=", "0"}], ";", 
                RowBox[{"update", "=", "16000"}], ";", 
                RowBox[{"gameName", "=", "\"\<Prisoner's Dilemma\>\""}], ";", 
                RowBox[{
                "updateRule", "=", 
                 "\"\<Fermi (set intensity \
\!\(\*StyleBox[\"m\",FontSlant->\"Italic\"]\))\>\""}], ";", 
                RowBox[{"k", "=", "4"}], ";", 
                RowBox[{"m", "=", "40"}], ";", 
                RowBox[{"initxA", "=", "0.5"}], ";", 
                RowBox[{"initqAA", "=", "0.5"}], ";", 
                RowBox[{"showMD", "=", "False"}], ";", 
                RowBox[{"maxTimeOut", "=", "20"}], ";", 
                RowBox[{
                "preset", "=", 
                 "\"\<Hauert Szab\[OAcute] 2005 fig5 r=0.01\>\""}]}], ")"}]}],
              ",", "\[IndentingNewLine]", 
             RowBox[{"\"\<fig5 r=0.02\>\"", "\[RuleDelayed]", 
              RowBox[{"(", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"a11", "=", "1"}], ";", 
                RowBox[{"a12", "=", 
                 RowBox[{"-", ".02"}]}], ";", 
                RowBox[{"a21", "=", "1.02"}], ";", 
                RowBox[{"a22", "=", "0"}], ";", 
                RowBox[{"update", "=", "17000"}], ";", 
                RowBox[{"gameName", "=", "\"\<Prisoner's Dilemma\>\""}], ";", 
                RowBox[{
                "updateRule", "=", 
                 "\"\<Fermi (set intensity \
\!\(\*StyleBox[\"m\",FontSlant->\"Italic\"]\))\>\""}], ";", 
                RowBox[{"k", "=", "4"}], ";", 
                RowBox[{"m", "=", "40"}], ";", 
                RowBox[{"initxA", "=", "0.5"}], ";", 
                RowBox[{"initqAA", "=", "0.5"}], ";", 
                RowBox[{"showMD", "=", "False"}], ";", 
                RowBox[{"maxTimeOut", "=", "20"}], ";", 
                RowBox[{
                "preset", "=", 
                 "\"\<Hauert Szab\[OAcute] 2005 fig5 r=0.02\>\""}]}], ")"}]}],
              ",", "\[IndentingNewLine]", 
             RowBox[{"\"\<fig5 r=0.06\>\"", "\[RuleDelayed]", 
              RowBox[{"(", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"a11", "=", "1"}], ";", 
                RowBox[{"a12", "=", 
                 RowBox[{"-", ".06"}]}], ";", 
                RowBox[{"a21", "=", "1.06"}], ";", 
                RowBox[{"a22", "=", "0"}], ";", 
                RowBox[{"update", "=", "18000"}], ";", 
                RowBox[{"gameName", "=", "\"\<Prisoner's Dilemma\>\""}], ";", 
                RowBox[{
                "updateRule", "=", 
                 "\"\<Fermi (set intensity \
\!\(\*StyleBox[\"m\",FontSlant->\"Italic\"]\))\>\""}], ";", 
                RowBox[{"k", "=", "4"}], ";", 
                RowBox[{"m", "=", "40"}], ";", 
                RowBox[{"initxA", "=", "0.5"}], ";", 
                RowBox[{"initqAA", "=", "0.5"}], ";", 
                RowBox[{"showMD", "=", "False"}], ";", 
                RowBox[{"maxTimeOut", "=", "20"}], ";", 
                RowBox[{
                "preset", "=", 
                 "\"\<Hauert Szab\[OAcute] 2005 fig5 r=0.02\>\""}]}], 
               ")"}]}]}], "\[IndentingNewLine]", "}"}]}], 
          "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<Fu, Nowak & Hauert (2010)\>\"", "->", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"\"\<fig4a,b u=0.02\>\"", "\[RuleDelayed]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"a11", "=", "1"}], ";", 
                RowBox[{"a12", "=", "0"}], ";", 
                RowBox[{"a21", "=", "1.02"}], ";", 
                RowBox[{"a22", "=", "0.02"}], ";", 
                RowBox[{"update", "=", "8000"}], ";", 
                RowBox[{"gameName", "=", "\"\<Prisoner's Dilemma\>\""}], ";", 
                RowBox[{
                "updateRule", "=", "\"\<Imitative pairwise difference\>\""}], 
                ";", 
                RowBox[{"k", "=", "8"}], ";", 
                RowBox[{"initxA", "=", "0.01"}], ";", 
                RowBox[{"initqAA", "=", "0.7"}], ";", 
                RowBox[{"showMD", "=", "False"}], ";", 
                RowBox[{
                "preset", "=", "\"\<Fu et al 2010 fig4ab u=0.02\>\""}]}], 
               ")"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"\"\<fig4a,b u=0.1\>\"", "\[RuleDelayed]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"a11", "=", "1"}], ";", 
                RowBox[{"a12", "=", "0"}], ";", 
                RowBox[{"a21", "=", "1.1"}], ";", 
                RowBox[{"a22", "=", "0.1"}], ";", 
                RowBox[{"update", "=", "9000"}], ";", 
                RowBox[{"gameName", "=", "\"\<Prisoner's Dilemma\>\""}], ";", 
                RowBox[{
                "updateRule", "=", "\"\<Imitative pairwise difference\>\""}], 
                ";", 
                RowBox[{"k", "=", "8"}], ";", 
                RowBox[{"initxA", "=", "0.01"}], ";", 
                RowBox[{"initqAA", "=", "0.7"}], ";", 
                RowBox[{"showMD", "=", "False"}], ";", 
                RowBox[{
                "preset", "=", "\"\<Fu et al 2010 fig4ab u=0.1\>\""}]}], 
               ")"}]}], ",", "\[IndentingNewLine]", "Delimiter", ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<fig4d,e v=0.05\>\"", "\[RuleDelayed]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"a11", "=", "1"}], ";", 
                RowBox[{"a12", "=", "0.95"}], ";", 
                RowBox[{"a21", "=", "1.05"}], ";", 
                RowBox[{"a22", "=", "0"}], ";", 
                RowBox[{"update", "=", "10000"}], ";", 
                RowBox[{"gameName", "=", "\"\<Snowdrift\>\""}], ";", 
                RowBox[{
                "updateRule", "=", "\"\<Imitative pairwise difference\>\""}], 
                ";", 
                RowBox[{"k", "=", "8"}], ";", 
                RowBox[{"initxA", "=", "0.01"}], ";", 
                RowBox[{"initqAA", "=", "0.7"}], ";", 
                RowBox[{"showMD", "=", "False"}], ";", 
                RowBox[{
                "preset", "=", "\"\<Fu et al 2010 fig4de v=0.05\>\""}]}], 
               ")"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"\"\<fig4d,e v=0.4\>\"", "\[RuleDelayed]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"a11", "=", "1"}], ";", 
                RowBox[{"a12", "=", "0.6"}], ";", 
                RowBox[{"a21", "=", "1.4"}], ";", 
                RowBox[{"a22", "=", "0"}], ";", 
                RowBox[{"update", "=", "11000"}], ";", 
                RowBox[{"gameName", "=", "\"\<Snowdrift\>\""}], ";", 
                RowBox[{
                "updateRule", "=", "\"\<Imitative pairwise difference\>\""}], 
                ";", 
                RowBox[{"k", "=", "8"}], ";", 
                RowBox[{"initxA", "=", "0.01"}], ";", 
                RowBox[{"initqAA", "=", "0.7"}], ";", 
                RowBox[{"showMD", "=", "False"}], ";", 
                RowBox[{
                "preset", "=", "\"\<Fu et al 2010 fig4de v=0.4\>\""}]}], 
               ")"}]}], ",", "\[IndentingNewLine]", "Delimiter", ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<fig6a u=0.05\>\"", "\[RuleDelayed]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"a11", "=", "1"}], ";", 
                RowBox[{"a12", "=", "0"}], ";", 
                RowBox[{"a21", "=", "1.05"}], ";", 
                RowBox[{"a22", "=", "0.05"}], ";", 
                RowBox[{"update", "=", "12000"}], ";", 
                RowBox[{"gameName", "=", "\"\<Prisoner's Dilemma\>\""}], ";", 
                RowBox[{
                "updateRule", "=", "\"\<Imitative pairwise difference\>\""}], 
                ";", 
                RowBox[{"k", "=", "8"}], ";", 
                RowBox[{"initxA", "=", "0.01"}], ";", 
                RowBox[{"initqAA", "=", "0.7"}], ";", 
                RowBox[{"showMD", "=", "True"}], ";", 
                RowBox[{
                "preset", "=", "\"\<Fu et al 2010 fig6a u=0.05\>\""}]}], 
               ")"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"\"\<fig6a u=0.15\>\"", "\[RuleDelayed]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"a11", "=", "1"}], ";", 
                RowBox[{"a12", "=", "0"}], ";", 
                RowBox[{"a21", "=", "1.15"}], ";", 
                RowBox[{"a22", "=", "0.15"}], ";", 
                RowBox[{"update", "=", "13000"}], ";", 
                RowBox[{"gameName", "=", "\"\<Prisoner's Dilemma\>\""}], ";", 
                RowBox[{
                "updateRule", "=", "\"\<Imitative pairwise difference\>\""}], 
                ";", 
                RowBox[{"k", "=", "8"}], ";", 
                RowBox[{"initxA", "=", "0.01"}], ";", 
                RowBox[{"initqAA", "=", "0.7"}], ";", 
                RowBox[{"showMD", "=", "True"}], ";", 
                RowBox[{
                "preset", "=", "\"\<Fu et al 2010 fig6a u=0.15\>\""}]}], 
               ")"}]}], ",", "\[IndentingNewLine]", "Delimiter", ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<fig6c v=0.5\>\"", "\[RuleDelayed]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"a11", "=", "1"}], ";", 
                RowBox[{"a12", "=", "0.5"}], ";", 
                RowBox[{"a21", "=", "1.5"}], ";", 
                RowBox[{"a22", "=", "0"}], ";", 
                RowBox[{"update", "=", "14000"}], ";", 
                RowBox[{"gameName", "=", "\"\<Snowdrift\>\""}], ";", 
                RowBox[{
                "updateRule", "=", "\"\<Imitative pairwise difference\>\""}], 
                ";", 
                RowBox[{"k", "=", "8"}], ";", 
                RowBox[{"initxA", "=", "0.01"}], ";", 
                RowBox[{"initqAA", "=", "0.7"}], ";", 
                RowBox[{"showMD", "=", "True"}], ";", 
                RowBox[{
                "preset", "=", "\"\<Fu et al 2010 fig6c v=0.5\>\""}]}], 
               ")"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"\"\<fig6c v=1\>\"", "\[RuleDelayed]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"a11", "=", "1"}], ";", 
                RowBox[{"a12", "=", "0"}], ";", 
                RowBox[{"a21", "=", "2"}], ";", 
                RowBox[{"a22", "=", "0"}], ";", 
                RowBox[{"update", "=", "15000"}], ";", 
                RowBox[{"gameName", "=", "\"\<Snowdrift\>\""}], ";", 
                RowBox[{
                "updateRule", "=", "\"\<Imitative pairwise difference\>\""}], 
                ";", 
                RowBox[{"k", "=", "8"}], ";", 
                RowBox[{"initxA", "=", "0.01"}], ";", 
                RowBox[{"initqAA", "=", "0.7"}], ";", 
                RowBox[{"showMD", "=", "True"}], ";", 
                RowBox[{"preset", "=", "\"\<Fu et al 2010 fig6c v=1\>\""}]}], 
               ")"}]}]}], "\[IndentingNewLine]", "}"}]}]}], 
         "\[IndentingNewLine]", "}"}], ",", 
        RowBox[{"Appearance", "\[Rule]", "\"\<PopupMenu\>\""}], ",", 
        RowBox[{"ImageSize", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"220", ",", "20"}], "}"}]}]}], "]"}], "}"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "220"}], ",", 
     RowBox[{"Alignment", "\[Rule]", "Center"}]}], "]"}], ",", 
   "\[IndentingNewLine]", "Delimiter", ",", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Style", "[", 
    RowBox[{
    "\"\<Payoffs (\!\(\*SubscriptBox[\(\[CapitalPi]\), \(ij\)]\))\>\"", ",", 
     "Bold", ",", "Medium"}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Row", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ActionMenu", "[", 
       RowBox[{
        RowBox[{"Dynamic", "[", "gameName", "]"}], ",", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\"\<Snowdrift\>\"", "\[RuleDelayed]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a11", "=", "3"}], ",", 
             RowBox[{"a12", "=", "1"}], ",", 
             RowBox[{"a21", "=", "4"}], ",", 
             RowBox[{"a22", "=", "0"}], ",", 
             RowBox[{
              RowBox[{"update", "=", "500"}], ";", 
              RowBox[{"gameName", "=", "\"\<Snowdrift\>\""}]}], ",", 
             RowBox[{"preset", "=", "\"\<Presets\>\""}]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<Prisoner's Dilemma\>\"", "\[RuleDelayed]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a11", "=", "3"}], ",", 
             RowBox[{"a12", "=", "0"}], ",", 
             RowBox[{"a21", "=", "4"}], ",", 
             RowBox[{"a22", "=", "1"}], ",", 
             RowBox[{
              RowBox[{"update", "=", "1000"}], ";", 
              RowBox[{"gameName", "=", "\"\<Prisoner's Dilemma\>\""}]}], ",", 
             RowBox[{"preset", "=", "\"\<Presets\>\""}]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<Coordination\>\"", "\[RuleDelayed]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a11", "=", "2"}], ",", 
             RowBox[{"a12", "=", "0"}], ",", 
             RowBox[{"a21", "=", "0"}], ",", 
             RowBox[{"a22", "=", "1"}], ",", 
             RowBox[{
              RowBox[{"update", "=", "2000"}], ";", 
              RowBox[{"gameName", "=", "\"\<Coordination\>\""}]}], ",", 
             RowBox[{"preset", "=", "\"\<Presets\>\""}]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<All 0s\>\"", "\[RuleDelayed]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a11", "=", "0"}], ",", 
             RowBox[{"a12", "=", "0"}], ",", 
             RowBox[{"a21", "=", "0"}], ",", 
             RowBox[{"a22", "=", "0"}], ",", 
             RowBox[{
              RowBox[{"update", "=", "3000"}], ";", 
              RowBox[{"gameName", "=", "\"\<All 0s\>\""}]}], ",", 
             RowBox[{"preset", "=", "\"\<Presets\>\""}]}], "}"}]}]}], 
         "\[IndentingNewLine]", "}"}], ",", 
        RowBox[{"Appearance", "\[Rule]", "\"\<PopupMenu\>\""}], ",", 
        RowBox[{"ImageSize", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"150", ",", "20"}], "}"}]}]}], "]"}], "}"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "180"}], ",", 
     RowBox[{"Alignment", "\[Rule]", "Center"}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Grid", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<              \>\"", ",", 
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "a11", ",", "1", ",", 
              "\"\<\!\(\*SubscriptBox[\(\[CapitalPi]\), \(\(A\)\(\[CenterDot]\
\)\)]\)\>\""}], "}"}], ",", 
            RowBox[{
             RowBox[{"InputField", "[", 
              RowBox[{
               RowBox[{"Dynamic", "[", 
                RowBox[{"a11", ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"a11", "=", 
                    RowBox[{"ForceNumber", "[", "#", "]"}]}], ")"}], "&"}]}], 
                "]"}], ",", "Number", ",", 
               RowBox[{"FieldSize", "\[Rule]", "4"}]}], "]"}], "&"}]}], "}"}],
           "]"}], " ", ",", "\[IndentingNewLine]", 
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"a12", ",", "0.8", ",", "\"\<\>\""}], "}"}], ",", 
            RowBox[{
             RowBox[{"InputField", "[", 
              RowBox[{
               RowBox[{"Dynamic", "[", 
                RowBox[{"a12", ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"a12", "=", 
                    RowBox[{"ForceNumber", "[", "#", "]"}]}], ")"}], "&"}]}], 
                "]"}], ",", "Number", ",", 
               RowBox[{"FieldSize", "\[Rule]", "4"}]}], "]"}], "&"}]}], "}"}],
           "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"\"\<\>\"", ",", 
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "a21", ",", "1.2", ",", 
              "\"\<\!\(\*SubscriptBox[\(\[CapitalPi]\), \(\(B\)\(\[CenterDot]\
\)\)]\)\>\""}], "}"}], ",", 
            RowBox[{
             RowBox[{"InputField", "[", 
              RowBox[{
               RowBox[{"Dynamic", "[", 
                RowBox[{"a21", ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"a21", "=", 
                    RowBox[{"ForceNumber", "[", "#", "]"}]}], ")"}], "&"}]}], 
                "]"}], ",", "Number", ",", 
               RowBox[{"FieldSize", "\[Rule]", "4"}]}], "]"}], "&"}]}], "}"}],
           "]"}], " ", ",", "\[IndentingNewLine]", 
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"a22", ",", "0", ",", "\"\<\>\""}], "}"}], ",", 
            RowBox[{
             RowBox[{"InputField", "[", 
              RowBox[{
               RowBox[{"Dynamic", "[", 
                RowBox[{"a22", ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"a22", "=", 
                    RowBox[{"ForceNumber", "[", "#", "]"}]}], ")"}], "&"}]}], 
                "]"}], ",", "Number", ",", 
               RowBox[{"FieldSize", "\[Rule]", "4"}]}], "]"}], "&"}]}], "}"}],
           "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}], ",", " ", 
     RowBox[{"Alignment", "\[Rule]", "Right"}]}], "]"}], 
   "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
   RowBox[{"Button", "[", 
    RowBox[{"\"\<Update\>\"", ",", 
     RowBox[{
      RowBox[{"update", "++"}], ";", 
      RowBox[{"gameName", "=", "\"\<Predefined games\>\""}], ";", 
      RowBox[{"preset", "=", "\"\<Presets\>\""}]}], ",", 
     RowBox[{"ImageSize", "->", "180"}]}], "]"}], ",", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "Delimiter", ",", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Style", "[", 
    RowBox[{"\"\<Degree of regular network\>\"", ",", "Bold", ",", "Medium"}],
     "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Control", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "k", ",", "8", ",", 
        "\"\<\!\(\*StyleBox[\"k\",FontSlant->\"Italic\"]\)\>\""}], "}"}], ",",
       "2", ",", "10", ",", "1", " ", ",", 
      RowBox[{"ImageSize", "\[Rule]", "Small"}], " ", ",", 
      RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], "]"}], 
   ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "Delimiter", ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Grid", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Style", "[", 
         RowBox[{"\"\<Decision rule\>\"", ",", "Bold", ",", "Medium"}], "]"}],
         "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"Control", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "updateRule", ",", "\"\<Imitative pairwise difference\>\"", ",", 
             "\"\<\>\""}], "}"}], ",", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
            "\"\<Imitative pairwise difference\>\"", ",", 
             "\[IndentingNewLine]", "\"\<Imitate if better, all nbrs\>\"", 
             ",", "\[IndentingNewLine]", 
             "\"\<Fermi (set intensity \
\!\(\*StyleBox[\"m\",FontSlant->\"Italic\"]\))\>\"", ",", 
             "\[IndentingNewLine]", "\"\<Best neighbor\>\""}], 
            "\[IndentingNewLine]", "}"}], ",", 
           RowBox[{"ControlType", "\[Rule]", "PopupMenu"}], ",", 
           RowBox[{"MenuStyle", "\[Rule]", "12"}]}], "}"}], "]"}], "}"}]}], 
      "\[IndentingNewLine]", "}"}], ",", 
     RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}], "\[IndentingNewLine]",
    ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Control", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "m", ",", "1", " ", ",", 
        "\"\<Fermi's \!\(\*StyleBox[\"m\",FontSlant->\"Italic\"]\)\>\""}], 
       "}"}], ",", "0.5", ",", "40", ",", "0.01", " ", ",", 
      RowBox[{"ImageSize", "\[Rule]", "Small"}], " ", ",", 
      RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], "]"}], 
   ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "Delimiter", ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Style", "[", 
    RowBox[{"\"\<Initial conditions\>\"", ",", "Bold", ",", "Medium"}], "]"}],
    ",", "\[IndentingNewLine]", 
   RowBox[{"Control", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "initxA", ",", "0.5", ",", 
        "\"\<\!\(\*SubscriptBox[StyleBox[\"x\",FontSlant->\"Italic\"], \"A\"]\
\)\!\(\*StyleBox[\"(\",FontWeight->\"Plain\"]\)\!\(\*StyleBox[\"0\",\
FontWeight->\"Plain\"]\)\!\(\*StyleBox[\")\",FontWeight->\"Plain\"]\)\>\""}], 
       "}"}], ",", "0.01", ",", "0.99", ",", "0.01", " ", ",", 
      RowBox[{"ImageSize", "\[Rule]", "Small"}], " ", ",", 
      RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], "]"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"Control", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "initqAA", ",", "0.5", ",", 
        "\"\<\!\(\*SubscriptBox[StyleBox[\"q\",FontSlant->\"Italic\"], \
\"AA\"]\)\!\(\*StyleBox[\"(\",FontWeight->\"Plain\"]\)\!\(\*StyleBox[\"0\",\
FontWeight->\"Plain\"]\)\!\(\*StyleBox[\")\",FontWeight->\"Plain\"]\)\>\""}], 
       "}"}], ",", "0.01", ",", "0.99", ",", "0.01", " ", ",", 
      RowBox[{"ImageSize", "\[Rule]", "Small"}], " ", ",", 
      RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], "]"}], 
   ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "Delimiter", ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Style", "[", 
    RowBox[{"\"\<Mean Dynamic (MD)\>\"", ",", "Bold", ",", "Medium"}], "]"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"Control", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"showMD", ",", "True", ",", "\"\<Show MD\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"True", ",", "False"}], "}"}], " ", ",", 
      RowBox[{"ImageSize", "\[Rule]", "Small"}], " ", ",", 
      RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], "]"}], 
   ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "Delimiter", ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Style", "[", 
    RowBox[{
    "\"\<Time allowed for computations\>\"", ",", "Bold", ",", "Medium"}], 
    "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Control", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"maxTimeOut", ",", "1", ",", "\"\<maxTimeOut (s)\>\""}], "}"}],
       ",", "1", ",", "20", ",", "1", ",", 
      RowBox[{"ImageSize", "\[Rule]", "Small"}], ",", 
      RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], "]"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Row", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Control", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"maxTimeOut", ",", "1", ",", "\"\<maxTimeOut\>\""}], 
            "}"}], ",", "1", ",", "20", ",", "1", ",", 
           RowBox[{"ImageSize", "\[Rule]", "Small"}]}], " ", "}"}], "]"}], 
        ",", 
        RowBox[{"Spacer", "[", "5", "]"}], ",", 
        RowBox[{"Dynamic", "@", "maxTimeOut"}], ",", "\"\<s\>\""}], "}"}], 
      "]"}], ","}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"OTHER", " ", "MANIPULATE", " ", "OPTIONS"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"SaveDefinitions", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
   RowBox[{"TrackedSymbols", "\[RuleDelayed]", 
    RowBox[{"{", 
     RowBox[{
     "update", ",", "updateRule", ",", "k", ",", "m", ",", "initxA", ",", 
      "initqAA", ",", "showMD", ",", "maxTimeOut"}], "}"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Alignment", "\[Rule]", "Top"}], " ", ",", "\[IndentingNewLine]", 
   RowBox[{"ControlPlacement", "\[Rule]", "Left"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"SynchronousUpdating", "\[Rule]", "False"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"ContinuousAction", "\[Rule]", "True"}], ",", " ", 
   "\[IndentingNewLine]", 
   RowBox[{"AppearanceElements", "\[Rule]", "None"}], "  ", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "This", " ", "conceals", " ", "the", " ", "menu", " ", "with", " ", 
      "the", " ", 
      RowBox[{"bookmarks", ".", " ", "The"}], " ", 
      "\"\<Animate bookmarks\>\"", " ", "feature", " ", "creates", " ", 
      "problems", " ", "if", " ", "bookmarks", " ", "do", " ", "not", " ", 
      "set", " ", "the", " ", "values", " ", "of", " ", "all", " ", 
      RowBox[{"parameters", ".", " ", "For"}], " ", "such", " ", "cases"}], 
     ",", " ", 
     RowBox[{
     "a", " ", "nice", " ", "workaround", " ", "is", " ", "to", " ", 
      "implement", " ", "the", " ", "\"\<bookmark\>\"", " ", "feature", " ", 
      "using", " ", "an", " ", "ActionMenu"}], ",", " ", 
     RowBox[{"as", " ", "it", " ", "is", " ", "done", " ", 
      RowBox[{"here", "."}]}]}], " ", "*)"}], ",", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", "INTIALIZATION", " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Initialization", "\[RuleDelayed]", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Off", "[", 
        RowBox[{"NDSolveValue", "::", "ndsz"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Off", "[", 
        RowBox[{"NDSolveValue", "::", "ndcf"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Off", "[", 
        RowBox[{"InterpolatingFunction", "::", "dmval"}], "]"}], ";"}], 
      "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Off", "[", 
       RowBox[{"General", "::", "munfl"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "INTERFACE", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ForceNumber", "[", "n_", "]"}], ":=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"NumberQ", "[", "n", "]"}], ",", "n", ",", "0"}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"PAYOFF", " ", "FUNCTIONS"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"For", " ", "Mean", " ", "Dynamic"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[CapitalPi]A", "[", 
        RowBox[{"x_", ",", "\[CapitalPi]AA_", ",", "\[CapitalPi]AB_"}], "]"}],
        ":=", 
       RowBox[{
        RowBox[{"x", " ", "\[CapitalPi]AA"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "x"}], ")"}], "\[CapitalPi]AB"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[CapitalPi]B", "[", 
        RowBox[{"x_", ",", "\[CapitalPi]BA_", ",", "\[CapitalPi]BB_"}], "]"}],
        ":=", 
       RowBox[{
        RowBox[{"x", " ", "\[CapitalPi]BA"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "x"}], ")"}], "\[CapitalPi]BB"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"For", " ", "Pair", " ", "approximation"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[CapitalPi]A", "[", 
        RowBox[{
        "kA_", ",", "k_", ",", "\[CapitalPi]AA_", ",", "\[CapitalPi]AB_"}], 
        "]"}], ":=", 
       FractionBox[
        RowBox[{
         RowBox[{"kA", " ", "\[CapitalPi]AA"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"k", "-", "kA"}], ")"}], "\[CapitalPi]AB"}]}], "k"]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[CapitalPi]B", "[", 
        RowBox[{
        "kA_", ",", "k_", ",", "\[CapitalPi]BA_", ",", "\[CapitalPi]BB_"}], 
        "]"}], ":=", 
       FractionBox[
        RowBox[{
         RowBox[{"kA", " ", "\[CapitalPi]BA"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"k", "-", "kA"}], ")"}], "\[CapitalPi]BB"}]}], "k"]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"MEAN", " ", "DYNAMIC"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ExpectedChange", "[", 
        RowBox[{"maxDiff_", ",", "mR_", ",", "payoffs_", ",", "\[Rho]A_"}], 
        "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\[CapitalPi]AA", ",", "\[CapitalPi]AB", ",", "\[CapitalPi]BA", ",",
            "\[CapitalPi]BB", ",", 
           RowBox[{"\[Rho]B", "=", 
            RowBox[{"1", "-", "\[Rho]A"}]}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "\[CapitalPi]AA", ",", "\[CapitalPi]AB", ",", "\[CapitalPi]BA", 
             ",", "\[CapitalPi]BB"}], "}"}], "=", "payoffs"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Switch", "[", 
           RowBox[{
           "updateRule", ",", "\[IndentingNewLine]", 
            "\"\<Imitate if better, all nbrs\>\"", ",", 
            RowBox[{"\[Rho]B", " ", "\[Rho]A", " ", 
             RowBox[{"Piecewise", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{
                    RowBox[{"\[CapitalPi]A", "[", 
                    RowBox[{
                    "\[Rho]A", ",", "\[CapitalPi]AA", ",", "\[CapitalPi]AB"}],
                     "]"}], ">", 
                    RowBox[{"\[CapitalPi]B", "[", 
                    RowBox[{
                    "\[Rho]A", ",", "\[CapitalPi]BA", ",", "\[CapitalPi]BB"}],
                     "]"}]}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "1"}], ",", 
                   RowBox[{
                    RowBox[{"\[CapitalPi]A", "[", 
                    RowBox[{
                    "\[Rho]A", ",", "\[CapitalPi]AA", ",", "\[CapitalPi]AB"}],
                     "]"}], "<", 
                    RowBox[{"\[CapitalPi]B", "[", 
                    RowBox[{
                    "\[Rho]A", ",", "\[CapitalPi]BA", ",", "\[CapitalPi]BB"}],
                     "]"}]}]}], "}"}]}], "}"}], ",", "0"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"\"\<Imitate if better, all nbrs\>\"", ",", 
              RowBox[{
               SubscriptBox["x", 
                RowBox[{"B", " "}]], "\[Rho]A", " ", 
               RowBox[{"Sign", "[", 
                RowBox[{
                 RowBox[{"\[CapitalPi]A", "[", "\[Rho]A", "]"}], "-", 
                 RowBox[{"\[CapitalPi]B", "[", "\[Rho]A", "]"}]}], "]"}]}], 
              ","}], "*)"}], "\[IndentingNewLine]", 
            "\"\<Fermi (set intensity \
\!\(\*StyleBox[\"m\",FontSlant->\"Italic\"]\))\>\"", ",", 
            RowBox[{"\[Rho]B", " ", "\[Rho]A", 
             FractionBox[
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{"m", " ", 
                 RowBox[{"\[CapitalPi]A", "[", 
                  RowBox[{
                  "\[Rho]A", ",", "\[CapitalPi]AA", ",", "\[CapitalPi]AB"}], 
                  "]"}]}], "]"}], "-", 
               RowBox[{"Exp", "[", 
                RowBox[{"m", " ", 
                 RowBox[{"\[CapitalPi]B", "[", 
                  RowBox[{
                  "\[Rho]A", ",", "\[CapitalPi]BA", ",", "\[CapitalPi]BB"}], 
                  "]"}]}], "]"}]}], 
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{"m", " ", 
                 RowBox[{"\[CapitalPi]A", "[", 
                  RowBox[{
                  "\[Rho]A", ",", "\[CapitalPi]AA", ",", "\[CapitalPi]AB"}], 
                  "]"}]}], "]"}], "+", 
               RowBox[{"Exp", "[", 
                RowBox[{"m", " ", 
                 RowBox[{"\[CapitalPi]B", "[", 
                  RowBox[{
                  "\[Rho]A", ",", "\[CapitalPi]BA", ",", "\[CapitalPi]BB"}], 
                  "]"}]}], "]"}]}]]}], ",", "\[IndentingNewLine]", 
            "\"\<Imitative pairwise difference\>\"", ",", 
            RowBox[{"\[Rho]B", " ", "\[Rho]A", 
             FractionBox[
              RowBox[{
               RowBox[{"\[CapitalPi]A", "[", 
                RowBox[{
                "\[Rho]A", ",", "\[CapitalPi]AA", ",", "\[CapitalPi]AB"}], 
                "]"}], "-", 
               RowBox[{"\[CapitalPi]B", "[", 
                RowBox[{
                "\[Rho]A", ",", "\[CapitalPi]BA", ",", "\[CapitalPi]BB"}], 
                "]"}]}], "maxDiff"]}], ",", "\[IndentingNewLine]", 
            "\"\<Best neighbor\>\"", ",", 
            RowBox[{
             RowBox[{"\[Rho]B", " ", 
              RowBox[{"Piecewise", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"BePositive", "[", 
                    RowBox[{
                    RowBox[{"\[CapitalPi]A", "[", 
                    RowBox[{
                    "\[Rho]A", ",", "\[CapitalPi]AA", ",", "\[CapitalPi]AB"}],
                     "]"}], "-", 
                    RowBox[{"\[CapitalPi]B", "[", 
                    RowBox[{
                    "\[Rho]A", ",", "\[CapitalPi]BA", ",", "\[CapitalPi]BB"}],
                     "]"}]}], "]"}], ",", 
                   RowBox[{"\[Rho]A", ">", "0"}]}], "}"}], "}"}], ",", "0"}], 
               "]"}]}], "-", 
             RowBox[{"\[Rho]A", " ", 
              RowBox[{"Piecewise", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"BePositive", "[", 
                    RowBox[{
                    RowBox[{"\[CapitalPi]B", "[", 
                    RowBox[{
                    "\[Rho]A", ",", "\[CapitalPi]BA", ",", "\[CapitalPi]BB"}],
                     "]"}], "-", 
                    RowBox[{"\[CapitalPi]A", "[", 
                    RowBox[{
                    "\[Rho]A", ",", "\[CapitalPi]AA", ",", "\[CapitalPi]AB"}],
                     "]"}]}], "]"}], ",", 
                   RowBox[{"\[Rho]B", ">", "0"}]}], "}"}], "}"}], ",", "0"}], 
               "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "Mathematica", " ", "cannot", " ", "realiably", " ", "solve", " ", 
         "the", " ", "mean", " ", "dynamic", " ", "of", " ", 
         "\"\<Imitate if better, all nbrs\>\""}], ",", " ", 
        RowBox[{
        "so", " ", "we", " ", "solved", " ", "it", " ", "analytically"}]}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"MDsolutionImitateIfBetterAllNbrs", "[", 
        RowBox[{"initialxA_", ",", "payoffs_"}], "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\[CapitalPi]AA", ",", "\[CapitalPi]AB", ",", "\[CapitalPi]BA", ",",
            "\[CapitalPi]BB", ",", "interiorEq"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "\[CapitalPi]AA", ",", "\[CapitalPi]AB", ",", "\[CapitalPi]BA", 
             ",", "\[CapitalPi]BB"}], "}"}], "=", "payoffs"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"interiorEq", "=", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
              "\[CapitalPi]AA", "-", "\[CapitalPi]AB", "-", "\[CapitalPi]BA", 
               "+", "\[CapitalPi]BB"}], "==", "0"}], ",", 
             RowBox[{"-", "1"}], ",", 
             FractionBox[
              RowBox[{"\[CapitalPi]BB", "-", "\[CapitalPi]AB"}], 
              RowBox[{
              "\[CapitalPi]AA", "-", "\[CapitalPi]AB", "-", "\[CapitalPi]BA", 
               "+", "\[CapitalPi]BB"}]]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Function", "[", 
           RowBox[{
            RowBox[{"{", "t", "}"}], ",", 
            RowBox[{"Piecewise", "[", 
             RowBox[{
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Min", "[", 
                   RowBox[{
                    FractionBox["initialxA", 
                    RowBox[{
                    RowBox[{
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"-", "t"}]], 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "initialxA"}], ")"}]}], "+", 
                    "initialxA"}]], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"And", "[", 
                    RowBox[{
                    RowBox[{"0", "<", "interiorEq", "<", "1"}], ",", 
                    RowBox[{"initialxA", "<", "interiorEq"}]}], "]"}], ",", 
                    "interiorEq", ",", "1"}], "]"}]}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"\[CapitalPi]A", "[", 
                    RowBox[{
                    "initialxA", ",", "\[CapitalPi]AA", ",", 
                    "\[CapitalPi]AB"}], "]"}], ">", 
                   RowBox[{"\[CapitalPi]B", "[", 
                    RowBox[{
                    "initialxA", ",", "\[CapitalPi]BA", ",", 
                    "\[CapitalPi]BB"}], "]"}]}]}], "}"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Max", "[", 
                   RowBox[{
                    FractionBox["initialxA", 
                    RowBox[{
                    RowBox[{
                    SuperscriptBox["\[ExponentialE]", "t"], 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "initialxA"}], ")"}]}], "+", 
                    "initialxA"}]], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"And", "[", 
                    RowBox[{
                    RowBox[{"0", "<", "interiorEq", "<", "1"}], ",", 
                    RowBox[{"initialxA", ">", "interiorEq"}]}], "]"}], ",", 
                    "interiorEq", ",", "0"}], "]"}]}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"\[CapitalPi]A", "[", 
                    RowBox[{
                    "initialxA", ",", "\[CapitalPi]AA", ",", 
                    "\[CapitalPi]AB"}], "]"}], "<", 
                   RowBox[{"\[CapitalPi]B", "[", 
                    RowBox[{
                    "initialxA", ",", "\[CapitalPi]BA", ",", 
                    "\[CapitalPi]BB"}], "]"}]}]}], "}"}]}], 
               "\[IndentingNewLine]", "}"}], ",", "initialxA"}], "]"}]}], 
           "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"NEIGHBORHOOD", " ", "CONFIGURATIONS"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"PA", "[", 
        RowBox[{"kA_", ",", "k_", ",", "qAA_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"Binomial", "[", 
         RowBox[{"k", ",", "kA"}], "]"}], 
        SuperscriptBox[
         RowBox[{"(", "qAA", ")"}], "kA"], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", "qAA"}], ")"}], 
         RowBox[{"k", "-", "kA"}]]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"PB", "[", 
        RowBox[{"kA_", ",", "k_", ",", "qAB_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"Binomial", "[", 
         RowBox[{"k", ",", "kA"}], "]"}], 
        SuperscriptBox[
         RowBox[{"(", "qAB", ")"}], "kA"], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", "qAB"}], ")"}], 
         RowBox[{"k", "-", "kA"}]]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"PAOneB", "[", 
        RowBox[{"kA_", ",", "k_", ",", "qAA_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"Binomial", "[", 
         RowBox[{
          RowBox[{"k", "-", "1"}], ",", "kA"}], "]"}], 
        SuperscriptBox[
         RowBox[{"(", "qAA", ")"}], "kA"], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", "qAA"}], ")"}], 
         RowBox[{"k", "-", "1", "-", "kA"}]]}]}], " ", ";", 
      RowBox[{"(*", " ", 
       RowBox[{"kA", " ", "<=", " ", 
        RowBox[{"k", "-", "1"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"PBOneA", "[", 
        RowBox[{"kA_", ",", "k_", ",", "qAB_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"Binomial", "[", 
         RowBox[{
          RowBox[{"k", "-", "1"}], ",", 
          RowBox[{"kA", "-", "1"}]}], "]"}], 
        SuperscriptBox[
         RowBox[{"(", "qAB", ")"}], 
         RowBox[{"kA", "-", "1"}]], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", "qAB"}], ")"}], 
         RowBox[{"k", "-", "kA"}]]}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"kA", " ", ">=", " ", "1"}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "The", " ", "following", " ", "two", " ", "functions", " ", "are", " ",
         "for", " ", "best", " ", "neighbor", " ", "only"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"PAOneA", "[", 
        RowBox[{"kA_", ",", "k_", ",", "qAA_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"Binomial", "[", 
         RowBox[{
          RowBox[{"k", "-", "1"}], ",", 
          RowBox[{"kA", "-", "1"}]}], "]"}], 
        SuperscriptBox[
         RowBox[{"(", "qAA", ")"}], 
         RowBox[{"kA", "-", "1"}]], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", "qAA"}], ")"}], 
         RowBox[{"k", "-", "kA"}]]}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"kA", " ", ">=", " ", "1"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"PBOneB", "[", 
        RowBox[{"kA_", ",", "k_", ",", "qAB_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"Binomial", "[", 
         RowBox[{
          RowBox[{"k", "-", "1"}], ",", "kA"}], "]"}], 
        SuperscriptBox[
         RowBox[{"(", "qAB", ")"}], "kA"], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", "qAB"}], ")"}], 
         RowBox[{"k", "-", "1", "-", "kA"}]]}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"kA", " ", "<=", " ", 
        RowBox[{"k", "-", "1"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"CONDITIONAL", " ", "SWITCHING", " ", "PROBABILITIES"}], " ", 
       "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FA", "[", 
        RowBox[{
        "kA_", ",", "k_", ",", "maxDiff_", ",", "m_", ",", "payoffs_", ",", 
         "qAA_", ",", "qAB_"}], "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\[CapitalPi]AA", ",", "\[CapitalPi]AB", ",", "\[CapitalPi]BA", ",",
            "\[CapitalPi]BB"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "\[CapitalPi]AA", ",", "\[CapitalPi]AB", ",", "\[CapitalPi]BA", 
             ",", "\[CapitalPi]BB"}], "}"}], "=", "payoffs"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Switch", "[", 
           RowBox[{
           "updateRule", ",", "\[IndentingNewLine]", 
            "\"\<Imitate if better, all nbrs\>\"", ",", 
            RowBox[{
             FractionBox[
              RowBox[{"k", "-", "kA"}], "k"], 
             RowBox[{
              SubsuperscriptBox["\[Sum]", 
               RowBox[{"i", "=", "1"}], "k"], 
              RowBox[{"Piecewise", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"PBOneA", "[", 
                    RowBox[{"i", ",", "k", ",", "qAB"}], "]"}], ",", 
                   RowBox[{
                    RowBox[{"\[CapitalPi]B", "[", 
                    RowBox[{
                    "i", ",", "k", ",", "\[CapitalPi]BA", ",", 
                    "\[CapitalPi]BB"}], "]"}], ">", 
                    RowBox[{"\[CapitalPi]A", "[", 
                    RowBox[{
                    "kA", ",", "k", ",", "\[CapitalPi]AA", ",", 
                    "\[CapitalPi]AB"}], "]"}]}]}], "}"}], "}"}], ",", "0"}], 
               "]"}]}]}], ",", "\[IndentingNewLine]", 
            "\"\<Fermi (set intensity \
\!\(\*StyleBox[\"m\",FontSlant->\"Italic\"]\))\>\"", ",", 
            RowBox[{
             FractionBox[
              RowBox[{"k", "-", "kA"}], "k"], 
             RowBox[{
              SubsuperscriptBox["\[Sum]", 
               RowBox[{"i", "=", "1"}], "k"], 
              RowBox[{
               RowBox[{"PBOneA", "[", 
                RowBox[{"i", ",", "k", ",", "qAB"}], "]"}], " ", 
               FractionBox[
                RowBox[{"Exp", "[", 
                 RowBox[{"m", " ", 
                  RowBox[{"\[CapitalPi]B", "[", 
                   RowBox[{
                   "i", ",", "k", ",", "\[CapitalPi]BA", ",", 
                    "\[CapitalPi]BB"}], "]"}]}], "]"}], 
                RowBox[{
                 RowBox[{"Exp", "[", 
                  RowBox[{"m", " ", 
                   RowBox[{"\[CapitalPi]A", "[", 
                    RowBox[{
                    "kA", ",", "k", ",", "\[CapitalPi]AA", ",", 
                    "\[CapitalPi]AB"}], "]"}]}], "]"}], "+", 
                 RowBox[{"Exp", "[", 
                  RowBox[{"m", " ", 
                   RowBox[{"\[CapitalPi]B", "[", 
                    RowBox[{
                    "i", ",", "k", ",", "\[CapitalPi]BA", ",", 
                    "\[CapitalPi]BB"}], "]"}]}], "]"}]}]]}]}]}], ",", 
            "\[IndentingNewLine]", "\"\<Imitative pairwise difference\>\"", 
            ",", 
            RowBox[{
             FractionBox[
              RowBox[{"k", "-", "kA"}], "k"], 
             RowBox[{
              SubsuperscriptBox["\[Sum]", 
               RowBox[{"i", "=", "1"}], "k"], 
              RowBox[{
               RowBox[{"PBOneA", "[", 
                RowBox[{"i", ",", "k", ",", "qAB"}], "]"}], 
               FractionBox[
                RowBox[{"BePositive", "[", 
                 RowBox[{
                  RowBox[{"\[CapitalPi]B", "[", 
                   RowBox[{
                   "i", ",", "k", ",", "\[CapitalPi]BA", ",", 
                    "\[CapitalPi]BB"}], "]"}], "-", 
                  RowBox[{"\[CapitalPi]A", "[", 
                   RowBox[{
                   "kA", ",", "k", ",", "\[CapitalPi]AA", ",", 
                    "\[CapitalPi]AB"}], "]"}]}], "]"}], "maxDiff"]}]}]}], ",",
             "\[IndentingNewLine]", "\"\<Best neighbor\>\"", ",", 
            RowBox[{"Switch", "[", 
             RowBox[{"kA", ",", "\[IndentingNewLine]", "0", ",", 
              RowBox[{
               SubsuperscriptBox["\[Sum]", 
                RowBox[{"i", "=", "1"}], "k"], 
               RowBox[{"Piecewise", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"ProbabilityBestPayoffAmongBNbrsAOneB", "[", 
                    RowBox[{
                    RowBox[{"\[CapitalPi]B", "[", 
                    RowBox[{
                    "i", ",", "k", ",", "\[CapitalPi]BA", ",", 
                    "\[CapitalPi]BB"}], "]"}], ",", "kA", ",", "k", ",", 
                    "payoffs", ",", "qAB"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"\[CapitalPi]B", "[", 
                    RowBox[{
                    "i", ",", "k", ",", "\[CapitalPi]BA", ",", 
                    "\[CapitalPi]BB"}], "]"}], ">", 
                    RowBox[{"\[CapitalPi]A", "[", 
                    RowBox[{
                    "kA", ",", "k", ",", "\[CapitalPi]AA", ",", 
                    "\[CapitalPi]AB"}], "]"}]}]}], "}"}], "}"}], ",", "0"}], 
                "]"}]}], ",", "\[IndentingNewLine]", "k", ",", "0", ",", 
              "\[IndentingNewLine]", "_", ",", 
              RowBox[{
               SubsuperscriptBox["\[Sum]", 
                RowBox[{"i", "=", "1"}], "k"], 
               RowBox[{"Piecewise", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"ProbabilityBestPayoffAmongBNbrsAOneB", "[", 
                    RowBox[{
                    RowBox[{"\[CapitalPi]B", "[", 
                    RowBox[{
                    "i", ",", "k", ",", "\[CapitalPi]BA", ",", 
                    "\[CapitalPi]BB"}], "]"}], ",", "kA", ",", "k", ",", 
                    "payoffs", ",", "qAB"}], "]"}], 
                    RowBox[{
                    "StrictCumulativeProbabilityBestPayoffAmongANbrsAOneA", 
                    "[", 
                    RowBox[{
                    RowBox[{"\[CapitalPi]B", "[", 
                    RowBox[{
                    "i", ",", "k", ",", "\[CapitalPi]BA", ",", 
                    "\[CapitalPi]BB"}], "]"}], ",", "kA", ",", "k", ",", 
                    "payoffs", ",", "qAA"}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"\[CapitalPi]B", "[", 
                    RowBox[{
                    "i", ",", "k", ",", "\[CapitalPi]BA", ",", 
                    "\[CapitalPi]BB"}], "]"}], ">", 
                    RowBox[{"\[CapitalPi]A", "[", 
                    RowBox[{
                    "kA", ",", "k", ",", "\[CapitalPi]AA", ",", 
                    "\[CapitalPi]AB"}], "]"}]}]}], "}"}], "}"}], ",", "0"}], 
                "]"}]}]}], "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{"kA", " ", "<=", " ", 
               RowBox[{"k", "-", "1"}]}], " ", "*)"}], 
             RowBox[{"(*", " ", 
              RowBox[{"kA", " ", ">=", " ", "1"}], " ", "*)"}], 
             "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]}],
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FB", "[", 
        RowBox[{
        "kA_", ",", "k_", ",", "maxDiff_", ",", "m_", ",", "payoffs_", ",", 
         "qAA_", ",", "qAB_"}], "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\[CapitalPi]AA", ",", "\[CapitalPi]AB", ",", "\[CapitalPi]BA", ",",
            "\[CapitalPi]BB"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "\[CapitalPi]AA", ",", "\[CapitalPi]AB", ",", "\[CapitalPi]BA", 
             ",", "\[CapitalPi]BB"}], "}"}], "=", "payoffs"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Switch", "[", 
           RowBox[{
           "updateRule", ",", "\[IndentingNewLine]", 
            "\"\<Imitate if better, all nbrs\>\"", ",", 
            RowBox[{
             FractionBox["kA", "k"], 
             RowBox[{
              SubsuperscriptBox["\[Sum]", 
               RowBox[{"i", "=", "0"}], 
               RowBox[{"k", "-", "1"}]], 
              RowBox[{"Piecewise", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"PAOneB", "[", 
                    RowBox[{"i", ",", "k", ",", "qAA"}], "]"}], ",", 
                   RowBox[{
                    RowBox[{"\[CapitalPi]A", "[", 
                    RowBox[{
                    "i", ",", "k", ",", "\[CapitalPi]AA", ",", 
                    "\[CapitalPi]AB"}], "]"}], ">", 
                    RowBox[{"\[CapitalPi]B", "[", 
                    RowBox[{
                    "kA", ",", "k", ",", "\[CapitalPi]BA", ",", 
                    "\[CapitalPi]BB"}], "]"}]}]}], "}"}], "}"}], ",", "0"}], 
               "]"}]}]}], ",", "\[IndentingNewLine]", 
            "\"\<Fermi (set intensity \
\!\(\*StyleBox[\"m\",FontSlant->\"Italic\"]\))\>\"", ",", 
            RowBox[{
             FractionBox["kA", "k"], 
             RowBox[{
              SubsuperscriptBox["\[Sum]", 
               RowBox[{"i", "=", "0"}], 
               RowBox[{"k", "-", "1"}]], 
              RowBox[{
               RowBox[{"PAOneB", "[", 
                RowBox[{"i", ",", "k", ",", "qAA"}], "]"}], " ", 
               FractionBox[
                RowBox[{"Exp", "[", 
                 RowBox[{"m", " ", 
                  RowBox[{"\[CapitalPi]A", "[", 
                   RowBox[{
                   "i", ",", "k", ",", "\[CapitalPi]AA", ",", 
                    "\[CapitalPi]AB"}], "]"}]}], "]"}], 
                RowBox[{
                 RowBox[{"Exp", "[", 
                  RowBox[{"m", " ", 
                   RowBox[{"\[CapitalPi]B", "[", 
                    RowBox[{
                    "kA", ",", "k", ",", "\[CapitalPi]BA", ",", 
                    "\[CapitalPi]BB"}], "]"}]}], "]"}], "+", 
                 RowBox[{"Exp", "[", 
                  RowBox[{"m", " ", 
                   RowBox[{"\[CapitalPi]A", "[", 
                    RowBox[{
                    "i", ",", "k", ",", "\[CapitalPi]AA", ",", 
                    "\[CapitalPi]AB"}], "]"}]}], "]"}]}]]}]}]}], ",", 
            "\[IndentingNewLine]", "\"\<Imitative pairwise difference\>\"", 
            ",", 
            RowBox[{
             FractionBox["kA", "k"], 
             RowBox[{
              SubsuperscriptBox["\[Sum]", 
               RowBox[{"i", "=", "0"}], 
               RowBox[{"k", "-", "1"}]], 
              RowBox[{
               RowBox[{"PAOneB", "[", 
                RowBox[{"i", ",", "k", ",", "qAA"}], "]"}], 
               FractionBox[
                RowBox[{"BePositive", "[", 
                 RowBox[{
                  RowBox[{"\[CapitalPi]A", "[", 
                   RowBox[{
                   "i", ",", "k", ",", "\[CapitalPi]AA", ",", 
                    "\[CapitalPi]AB"}], "]"}], "-", 
                  RowBox[{"\[CapitalPi]B", "[", 
                   RowBox[{
                   "kA", ",", "k", ",", "\[CapitalPi]BA", ",", 
                    "\[CapitalPi]BB"}], "]"}]}], "]"}], "maxDiff"]}]}]}], ",",
             "\[IndentingNewLine]", "\"\<Best neighbor\>\"", ",", 
            RowBox[{"Switch", "[", 
             RowBox[{
             "kA", ",", "\[IndentingNewLine]", "0", ",", "0", ",", 
              "\[IndentingNewLine]", "k", ",", 
              RowBox[{
               SubsuperscriptBox["\[Sum]", 
                RowBox[{"i", "=", "0"}], 
                RowBox[{"k", "-", "1"}]], 
               RowBox[{"Piecewise", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"ProbabilityBestPayoffAmongANbrsBOneA", "[", 
                    RowBox[{
                    RowBox[{"\[CapitalPi]A", "[", 
                    RowBox[{
                    "i", ",", "k", ",", "\[CapitalPi]AA", ",", 
                    "\[CapitalPi]AB"}], "]"}], ",", "kA", ",", "k", ",", 
                    "payoffs", ",", "qAA"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"\[CapitalPi]A", "[", 
                    RowBox[{
                    "i", ",", "k", ",", "\[CapitalPi]AA", ",", 
                    "\[CapitalPi]AB"}], "]"}], ">", 
                    RowBox[{"\[CapitalPi]B", "[", 
                    RowBox[{
                    "kA", ",", "k", ",", "\[CapitalPi]BA", ",", 
                    "\[CapitalPi]BB"}], "]"}]}]}], "}"}], "}"}], ",", "0"}], 
                "]"}]}], ",", "\[IndentingNewLine]", "_", ",", 
              RowBox[{
               SubsuperscriptBox["\[Sum]", 
                RowBox[{"i", "=", "0"}], 
                RowBox[{"k", "-", "1"}]], 
               RowBox[{"Piecewise", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"ProbabilityBestPayoffAmongANbrsBOneA", "[", 
                    RowBox[{
                    RowBox[{"\[CapitalPi]A", "[", 
                    RowBox[{
                    "i", ",", "k", ",", "\[CapitalPi]AA", ",", 
                    "\[CapitalPi]AB"}], "]"}], ",", "kA", ",", "k", ",", 
                    "payoffs", ",", "qAA"}], "]"}], 
                    RowBox[{
                    "StrictCumulativeProbabilityBestPayoffAmongBNbrsBOneB", 
                    "[", 
                    RowBox[{
                    RowBox[{"\[CapitalPi]A", "[", 
                    RowBox[{
                    "i", ",", "k", ",", "\[CapitalPi]AA", ",", 
                    "\[CapitalPi]AB"}], "]"}], ",", "kA", ",", "k", ",", 
                    "payoffs", ",", "qAB"}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"\[CapitalPi]A", "[", 
                    RowBox[{
                    "i", ",", "k", ",", "\[CapitalPi]AA", ",", 
                    "\[CapitalPi]AB"}], "]"}], ">", 
                    RowBox[{"\[CapitalPi]B", "[", 
                    RowBox[{
                    "kA", ",", "k", ",", "\[CapitalPi]BA", ",", 
                    "\[CapitalPi]BB"}], "]"}]}]}], "}"}], "}"}], ",", "0"}], 
                "]"}]}]}], "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{"kA", " ", "<=", " ", 
               RowBox[{"k", "-", "1"}]}], " ", "*)"}], 
             RowBox[{"(*", " ", 
              RowBox[{"kA", " ", ">=", " ", "1"}], " ", "*)"}], 
             "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]}],
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "For", " ", "imitative", " ", "pairwise", " ", "difference", " ", 
        "and", " ", "best", " ", "neighbor", " ", "MD", " ", "only"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"BePositive", "[", "x_", "]"}], ":=", 
       RowBox[{"Piecewise", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"x", "<", "0"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{"x", "\[GreaterEqual]", "0"}]}], "}"}]}], "}"}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"For", " ", "best", " ", "neighbor", " ", "only"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"CumulativeProbabilityBestPayoffAmongANbrsBOneA", "[", 
        RowBox[{"x_", ",", "kA_", ",", "k_", ",", "payoffs_", ",", "qAA_"}], 
        "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\[CapitalPi]AA", ",", "\[CapitalPi]AB", ",", "\[CapitalPi]BA", ",",
            "\[CapitalPi]BB"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "\[CapitalPi]AA", ",", "\[CapitalPi]AB", ",", "\[CapitalPi]BA", 
             ",", "\[CapitalPi]BB"}], "}"}], "=", "payoffs"}], ";", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SubsuperscriptBox["\[Sum]", 
              RowBox[{"i", "=", "0"}], 
              RowBox[{"k", "-", "1"}]], 
             RowBox[{"Piecewise", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"PAOneB", "[", 
                   RowBox[{"i", ",", "k", ",", "qAA"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"\[CapitalPi]A", "[", 
                    RowBox[{
                    "i", ",", "k", ",", "\[CapitalPi]AA", ",", 
                    "\[CapitalPi]AB"}], "]"}], "<=", "x"}]}], "}"}], "}"}], 
               ",", "0"}], "]"}]}], ")"}], "kA"]}]}], "\[IndentingNewLine]", 
        "]"}]}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{"kA", " ", ">=", " ", "1"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"StrictCumulativeProbabilityBestPayoffAmongANbrsBOneA", "[", 
        RowBox[{"x_", ",", "kA_", ",", "k_", ",", "payoffs_", ",", "qAA_"}], 
        "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\[CapitalPi]AA", ",", "\[CapitalPi]AB", ",", "\[CapitalPi]BA", ",",
            "\[CapitalPi]BB"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "\[CapitalPi]AA", ",", "\[CapitalPi]AB", ",", "\[CapitalPi]BA", 
             ",", "\[CapitalPi]BB"}], "}"}], "=", "payoffs"}], ";", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SubsuperscriptBox["\[Sum]", 
              RowBox[{"i", "=", "0"}], 
              RowBox[{"k", "-", "1"}]], 
             RowBox[{"Piecewise", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"PAOneB", "[", 
                   RowBox[{"i", ",", "k", ",", "qAA"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"\[CapitalPi]A", "[", 
                    RowBox[{
                    "i", ",", "k", ",", "\[CapitalPi]AA", ",", 
                    "\[CapitalPi]AB"}], "]"}], "<", "x"}]}], "}"}], "}"}], 
               ",", "0"}], "]"}]}], ")"}], "kA"]}]}], "\[IndentingNewLine]", 
        "]"}]}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{"kA", " ", ">=", " ", "1"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ProbabilityBestPayoffAmongANbrsBOneA", "[", 
        RowBox[{"x_", ",", "kA_", ",", "k_", ",", "payoffs_", ",", "qAA_"}], 
        "]"}], ":=", 
       RowBox[{
        RowBox[{"CumulativeProbabilityBestPayoffAmongANbrsBOneA", "[", 
         RowBox[{"x", ",", "kA", ",", "k", ",", "payoffs", ",", "qAA"}], 
         "]"}], "-", 
        RowBox[{"StrictCumulativeProbabilityBestPayoffAmongANbrsBOneA", "[", 
         RowBox[{"x", ",", "kA", ",", "k", ",", "payoffs", ",", "qAA"}], 
         "]"}]}]}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{"kA", " ", ">=", " ", "1"}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"CumulativeProbabilityBestPayoffAmongBNbrsBOneB", "[", 
        RowBox[{"x_", ",", "kA_", ",", "k_", ",", "payoffs_", ",", "qAB_"}], 
        "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\[CapitalPi]AA", ",", "\[CapitalPi]AB", ",", "\[CapitalPi]BA", ",",
            "\[CapitalPi]BB"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "\[CapitalPi]AA", ",", "\[CapitalPi]AB", ",", "\[CapitalPi]BA", 
             ",", "\[CapitalPi]BB"}], "}"}], "=", "payoffs"}], ";", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SubsuperscriptBox["\[Sum]", 
              RowBox[{"i", "=", "0"}], 
              RowBox[{"k", "-", "1"}]], 
             RowBox[{"Piecewise", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"PBOneB", "[", 
                   RowBox[{"i", ",", "k", ",", "qAB"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"\[CapitalPi]B", "[", 
                    RowBox[{
                    "i", ",", "k", ",", "\[CapitalPi]BA", ",", 
                    "\[CapitalPi]BB"}], "]"}], "<=", "x"}]}], "}"}], "}"}], 
               ",", "0"}], "]"}]}], ")"}], 
           RowBox[{"k", "-", "kA"}]]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{"kA", " ", "<=", " ", 
        RowBox[{"k", "-", "1"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"StrictCumulativeProbabilityBestPayoffAmongBNbrsBOneB", "[", 
        RowBox[{"x_", ",", "kA_", ",", "k_", ",", "payoffs_", ",", "qAB_"}], 
        "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\[CapitalPi]AA", ",", "\[CapitalPi]AB", ",", "\[CapitalPi]BA", ",",
            "\[CapitalPi]BB"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "\[CapitalPi]AA", ",", "\[CapitalPi]AB", ",", "\[CapitalPi]BA", 
             ",", "\[CapitalPi]BB"}], "}"}], "=", "payoffs"}], ";", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SubsuperscriptBox["\[Sum]", 
              RowBox[{"i", "=", "0"}], 
              RowBox[{"k", "-", "1"}]], 
             RowBox[{"Piecewise", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"PBOneB", "[", 
                   RowBox[{"i", ",", "k", ",", "qAB"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"\[CapitalPi]B", "[", 
                    RowBox[{
                    "i", ",", "k", ",", "\[CapitalPi]BA", ",", 
                    "\[CapitalPi]BB"}], "]"}], "<", "x"}]}], "}"}], "}"}], 
               ",", "0"}], "]"}]}], ")"}], 
           RowBox[{"k", "-", "kA"}]]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{"kA", " ", "<=", " ", 
        RowBox[{"k", "-", "1"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ProbabilityBestPayoffAmongBNbrsBOneB", "[", 
        RowBox[{"x_", ",", "kA_", ",", "k_", ",", "payoffs_", ",", "qAB_"}], 
        "]"}], ":=", 
       RowBox[{
        RowBox[{"CumulativeProbabilityBestPayoffAmongBNbrsBOneB", "[", 
         RowBox[{"x", ",", "kA", ",", "k", ",", "payoffs", ",", "qAB"}], 
         "]"}], "-", 
        RowBox[{"StrictCumulativeProbabilityBestPayoffAmongBNbrsBOneB", "[", 
         RowBox[{"x", ",", "kA", ",", "k", ",", "payoffs", ",", "qAB"}], 
         "]"}]}]}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{"kA", " ", "<=", " ", 
        RowBox[{"k", "-", "1"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"CumulativeProbabilityBestPayoffAmongBNbrsAOneB", "[", 
        RowBox[{"x_", ",", "kA_", ",", "k_", ",", "payoffs_", ",", "qAB_"}], 
        "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\[CapitalPi]AA", ",", "\[CapitalPi]AB", ",", "\[CapitalPi]BA", ",",
            "\[CapitalPi]BB"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "\[CapitalPi]AA", ",", "\[CapitalPi]AB", ",", "\[CapitalPi]BA", 
             ",", "\[CapitalPi]BB"}], "}"}], "=", "payoffs"}], ";", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SubsuperscriptBox["\[Sum]", 
              RowBox[{"i", "=", "1"}], "k"], 
             RowBox[{"Piecewise", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"PBOneA", "[", 
                   RowBox[{"i", ",", "k", ",", "qAB"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"\[CapitalPi]B", "[", 
                    RowBox[{
                    "i", ",", "k", ",", "\[CapitalPi]BA", ",", 
                    "\[CapitalPi]BB"}], "]"}], "<=", "x"}]}], "}"}], "}"}], 
               ",", "0"}], "]"}]}], ")"}], 
           RowBox[{"k", "-", "kA"}]]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{"kA", " ", "<=", " ", 
        RowBox[{"k", "-", "1"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"StrictCumulativeProbabilityBestPayoffAmongBNbrsAOneB", "[", 
        RowBox[{"x_", ",", "kA_", ",", "k_", ",", "payoffs_", ",", "qAB_"}], 
        "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\[CapitalPi]AA", ",", "\[CapitalPi]AB", ",", "\[CapitalPi]BA", ",",
            "\[CapitalPi]BB"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "\[CapitalPi]AA", ",", "\[CapitalPi]AB", ",", "\[CapitalPi]BA", 
             ",", "\[CapitalPi]BB"}], "}"}], "=", "payoffs"}], ";", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SubsuperscriptBox["\[Sum]", 
              RowBox[{"i", "=", "1"}], "k"], 
             RowBox[{"Piecewise", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"PBOneA", "[", 
                   RowBox[{"i", ",", "k", ",", "qAB"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"\[CapitalPi]B", "[", 
                    RowBox[{
                    "i", ",", "k", ",", "\[CapitalPi]BA", ",", 
                    "\[CapitalPi]BB"}], "]"}], "<", "x"}]}], "}"}], "}"}], 
               ",", "0"}], "]"}]}], ")"}], 
           RowBox[{"k", "-", "kA"}]]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{"kA", " ", "<=", " ", 
        RowBox[{"k", "-", "1"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ProbabilityBestPayoffAmongBNbrsAOneB", "[", 
        RowBox[{"x_", ",", "kA_", ",", "k_", ",", "payoffs_", ",", "qAB_"}], 
        "]"}], ":=", 
       RowBox[{
        RowBox[{"CumulativeProbabilityBestPayoffAmongBNbrsAOneB", "[", 
         RowBox[{"x", ",", "kA", ",", "k", ",", "payoffs", ",", "qAB"}], 
         "]"}], "-", 
        RowBox[{"StrictCumulativeProbabilityBestPayoffAmongBNbrsAOneB", "[", 
         RowBox[{"x", ",", "kA", ",", "k", ",", "payoffs", ",", "qAB"}], 
         "]"}]}]}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{"kA", " ", "<=", " ", 
        RowBox[{"k", "-", "1"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"CumulativeProbabilityBestPayoffAmongANbrsAOneA", "[", 
        RowBox[{"x_", ",", "kA_", ",", "k_", ",", "payoffs_", ",", "qAA_"}], 
        "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\[CapitalPi]AA", ",", "\[CapitalPi]AB", ",", "\[CapitalPi]BA", ",",
            "\[CapitalPi]BB"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "\[CapitalPi]AA", ",", "\[CapitalPi]AB", ",", "\[CapitalPi]BA", 
             ",", "\[CapitalPi]BB"}], "}"}], "=", "payoffs"}], ";", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SubsuperscriptBox["\[Sum]", 
              RowBox[{"i", "=", "1"}], "k"], 
             RowBox[{"Piecewise", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"PAOneA", "[", 
                   RowBox[{"i", ",", "k", ",", "qAA"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"\[CapitalPi]A", "[", 
                    RowBox[{
                    "i", ",", "k", ",", "\[CapitalPi]AA", ",", 
                    "\[CapitalPi]AB"}], "]"}], "<=", "x"}]}], "}"}], "}"}], 
               ",", "0"}], "]"}]}], ")"}], "kA"]}]}], "\[IndentingNewLine]", 
        "]"}]}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{"kA", " ", ">=", " ", "1"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"StrictCumulativeProbabilityBestPayoffAmongANbrsAOneA", "[", 
        RowBox[{"x_", ",", "kA_", ",", "k_", ",", "payoffs_", ",", "qAA_"}], 
        "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\[CapitalPi]AA", ",", "\[CapitalPi]AB", ",", "\[CapitalPi]BA", ",",
            "\[CapitalPi]BB"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "\[CapitalPi]AA", ",", "\[CapitalPi]AB", ",", "\[CapitalPi]BA", 
             ",", "\[CapitalPi]BB"}], "}"}], "=", "payoffs"}], ";", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SubsuperscriptBox["\[Sum]", 
              RowBox[{"i", "=", "1"}], "k"], 
             RowBox[{"Piecewise", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"PAOneA", "[", 
                   RowBox[{"i", ",", "k", ",", "qAA"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"\[CapitalPi]A", "[", 
                    RowBox[{
                    "i", ",", "k", ",", "\[CapitalPi]AA", ",", 
                    "\[CapitalPi]AB"}], "]"}], "<", "x"}]}], "}"}], "}"}], 
               ",", "0"}], "]"}]}], ")"}], "kA"]}]}], "\[IndentingNewLine]", 
        "]"}]}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{"kA", " ", ">=", " ", "1"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ProbabilityBestPayoffAmongANbrsAOneA", "[", 
        RowBox[{"x_", ",", "kA_", ",", "k_", ",", "payoffs_", ",", "qAA_"}], 
        "]"}], ":=", 
       RowBox[{
        RowBox[{"CumulativeProbabilityBestPayoffAmongANbrsAOneA", "[", 
         RowBox[{"x", ",", "kA", ",", "k", ",", "payoffs", ",", "qAA"}], 
         "]"}], "-", 
        RowBox[{"StrictCumulativeProbabilityBestPayoffAmongANbrsAOneA", "[", 
         RowBox[{"x", ",", "kA", ",", "k", ",", "payoffs", ",", "qAA"}], 
         "]"}]}]}], ";"}], 
     RowBox[{"(*", " ", 
      RowBox[{"kA", " ", ">=", " ", "1"}], " ", "*)"}], "\[IndentingNewLine]",
      ")"}]}]}], "\[IndentingNewLine]", "]"}]], "Input",ExpressionUUID->\
"ebe497d7-c6bb-4946-9a6d-3dd577d63d4d"]
}, Closed]]
},
ScreenStyleEnvironment->"Working",
CellGrouping->Manual,
WindowSize->{1352, 757},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
TrackCellChangeTimes->False,
SpellingDictionaries->{"CorrectWords"->{
 "assortatively", "monomorphic", "Izquierdo", "Christoph", "Hauert", 
  "Doebeli", "Fu", "Nowak", "Segismundo"}},
Magnification:>1.25 Inherited,
FrontEndVersion->"14.0 for Mac OS X ARM (64-bit) (December 12, 2023)",
StyleDefinitions->FrontEnd`FileName[{"Creative"}, "NaturalColor.nb", 
  CharacterEncoding -> "UTF-8"],
ExpressionUUID->"4e2cc03b-a333-477d-bfc5-29b2fdd3b4c9"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[1257, 32, 142, 2, 76, "Title",ExpressionUUID->"be2ab95f-49ca-4d64-983e-6549390d65ef"],
Cell[1402, 36, 630, 20, 49, "Subtitle",ExpressionUUID->"c414d9db-7737-4bde-8abd-eaa0928aedb2"],
Cell[2035, 58, 505, 11, 62, "Text",ExpressionUUID->"73c625d9-c929-477d-869c-c28f423133fc"]
}, Open  ]],
Cell[2555, 72, 119498, 2246, 646, "Output",ExpressionUUID->"9435b60f-9635-44aa-ac53-506e5de91023"],
Cell[122056, 2320, 169, 3, 38, "Text",ExpressionUUID->"021aea6b-5e2b-4058-85f8-5552c48ddfc5"],
Cell[122228, 2325, 359, 6, 60, "Item",ExpressionUUID->"cff5d4dc-3f61-4bdd-8771-9f7b6b96d81f"],
Cell[122590, 2333, 324, 6, 38, "Item",ExpressionUUID->"2ca8f976-df16-491d-9adf-ee3a9cf8a092"],
Cell[122917, 2341, 459, 9, 60, "Item",ExpressionUUID->"c3352103-912e-4d0d-a932-79dfb6d96bba"],
Cell[123379, 2352, 810, 14, 157, "Text",ExpressionUUID->"6ceadfdc-305c-40ae-91bb-bfcef2ce55de"],
Cell[CellGroupData[{
Cell[124214, 2370, 88, 0, 92, "Section",ExpressionUUID->"55447b59-612e-4591-8e42-22aa94d55bf5"],
Cell[124305, 2372, 2256, 48, 703, "Text",ExpressionUUID->"3e570553-cd0b-47f0-bf9b-dcd4a5acb375"]
}, Closed]],
Cell[CellGroupData[{
Cell[126598, 2425, 85, 0, 53, "Section",ExpressionUUID->"d7fc9b4c-924e-445b-8538-aebcffdbf017"],
Cell[126686, 2427, 127461, 2886, 19121, "Input",ExpressionUUID->"ebe497d7-c6bb-4946-9a6d-3dd577d63d4d"]
}, Closed]]
}
]
*)

