(* Content-type: application/vnd.wolfram.cdf.text *)

(*** Wolfram CDF File ***)
(* http://www.wolfram.com/cdf *)

(* CreatedBy='Mathematica 8.0' *)

(*************************************************************************)
(*                                                                       *)
(*  The Mathematica License under which this file was created prohibits  *)
(*  restricting third parties in receipt of this file from republishing  *)
(*  or redistributing it by any means, including but not limited to      *)
(*  rights management or terms of use, without the express consent of    *)
(*  Wolfram Research, Inc.                                               *)
(*                                                                       *)
(*************************************************************************)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       835,         17]
NotebookDataLength[    264563,       5501]
NotebookOptionsPosition[    263289,       5471]
NotebookOutlinePosition[    264028,       5495]
CellTagsIndexPosition[    263985,       5492]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Pair approximation for 2x2 symmetric games on regular networks\
\>", "Title",ExpressionUUID->"be2ab95f-49ca-4d64-983e-6549390d65ef"],

Cell[TextData[{
 "\nBy ",
 ButtonBox["Luis R. Izquierdo",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://luis.izqui.org"], None},
  ButtonNote->"http://luis.izqui.org"],
 ", ",
 ButtonBox["Segismundo S. Izquierdo",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://www.segis.izqui.org"], None},
  ButtonNote->"http://www.segis.izqui.org"],
 " and ",
 ButtonBox["Christoph Hauert",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://personal.math.ubc.ca/~hauert/"], None},
  ButtonNote->"https://personal.math.ubc.ca/~hauert/"],
 " "
}], "Subtitle",ExpressionUUID->"c414d9db-7737-4bde-8abd-eaa0928aedb2"],

Cell[TextData[{
 "This is a notebook created to solve the system of differential equations of \
the pair approximation explained in section 2.4 of the book ",
 ButtonBox["Agent-based Evolutionary Game Dynamics",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://wisc.pb.unizin.org/agent-based-evolutionary-game-dynamics/"],
     None},
  ButtonNote->
   "https://wisc.pb.unizin.org/agent-based-evolutionary-game-dynamics/"],
 "."
}], "Text",ExpressionUUID->"73c625d9-c929-477d-869c-c28f423133fc"]
}, Open  ]],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`a11$$ = 1, $CellContext`a12$$ = 
    0.1, $CellContext`a21$$ = 1.9, $CellContext`a22$$ = 
    0, $CellContext`gameName$$ = "Snowdrift", $CellContext`initqAA$$ = 
    0.5, $CellContext`initxA$$ = 0.5, $CellContext`k$$ = 4, $CellContext`m$$ =
     40., $CellContext`maxTimeOut$$ = 1, $CellContext`preset$$ = 
    "Hauert Doebeli 2004 fig1b r=0.9", $CellContext`showMD$$ = 
    True, $CellContext`update$$ = 3000, $CellContext`updateRule$$ = 
    "Imitative pairwise difference", Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`preset$$], "Hauert Doebeli 2004 fig1b r=0.2"}, 
      ControlType -> None}, {{
       Hold[$CellContext`a11$$], 1}, ControlType -> None}, {{
       Hold[$CellContext`a12$$], 0.8}, ControlType -> None}, {{
       Hold[$CellContext`a21$$], 1.2}, ControlType -> None}, {{
       Hold[$CellContext`a22$$], 0}, ControlType -> None}, {{
       Hold[$CellContext`gameName$$], "Snowdrift"}, ControlType -> None}, {{
       Hold[$CellContext`k$$], 4}, ControlType -> None}, {{
       Hold[$CellContext`update$$], 0}, 0, 100, ControlType -> None}, {{
       Hold[$CellContext`updateRule$$], "Imitative pairwise difference"}, 
      ControlType -> None}, {{
       Hold[$CellContext`m$$], 1}, ControlType -> None}, {{
       Hold[$CellContext`initxA$$], 0.5}, ControlType -> None}, {{
       Hold[$CellContext`initqAA$$], 0.5}, ControlType -> None}, {{
       Hold[$CellContext`showMD$$], True}, ControlType -> None}, {{
       Hold[$CellContext`maxTimeOut$$], 1}, ControlType -> None}, {
      Hold[
       Style["Presets for replication", Bold, Medium]], 
      Manipulate`Dump`ThisIsNotAControl, ControlType -> None}, {
      Hold[
       Row[{
         ActionMenu[
          Dynamic[$CellContext`preset$$], {
          "Hauert & Doebeli (2004)" -> {
            "fig1b r=0.2" :> ($CellContext`a11$$ = 1; $CellContext`a12$$ = 
               0.8; $CellContext`a21$$ = 1.2; $CellContext`a22$$ = 
               0; $CellContext`update$$ = 1000; $CellContext`gameName$$ = 
               "Snowdrift"; $CellContext`updateRule$$ = 
               "Imitative pairwise difference"; $CellContext`k$$ = 
               4; $CellContext`initxA$$ = 0.5; $CellContext`initqAA$$ = 
               0.5; $CellContext`showMD$$ = True; $CellContext`preset$$ = 
               "Hauert Doebeli 2004 fig1b r=0.2"), 
             "fig1b r=0.5" :> ($CellContext`a11$$ = 1; $CellContext`a12$$ = 
               0.5; $CellContext`a21$$ = 1.5; $CellContext`a22$$ = 
               0; $CellContext`update$$ = 2000; $CellContext`gameName$$ = 
               "Snowdrift"; $CellContext`updateRule$$ = 
               "Imitative pairwise difference"; $CellContext`k$$ = 
               4; $CellContext`initxA$$ = 0.5; $CellContext`initqAA$$ = 
               0.5; $CellContext`showMD$$ = True; $CellContext`preset$$ = 
               "Hauert Doebeli 2004 fig1b r=0.5"), 
             "fig1b r=0.9" :> ($CellContext`a11$$ = 1; $CellContext`a12$$ = 
               0.1; $CellContext`a21$$ = 1.9; $CellContext`a22$$ = 
               0; $CellContext`update$$ = 3000; $CellContext`gameName$$ = 
               "Snowdrift"; $CellContext`updateRule$$ = 
               "Imitative pairwise difference"; $CellContext`k$$ = 
               4; $CellContext`initxA$$ = 0.5; $CellContext`initqAA$$ = 
               0.5; $CellContext`showMD$$ = True; $CellContext`preset$$ = 
               "Hauert Doebeli 2004 fig1b r=0.9"), Delimiter, 
             "fig1d r=0.2" :> ($CellContext`a11$$ = 1; $CellContext`a12$$ = 
               0.8; $CellContext`a21$$ = 1.2; $CellContext`a22$$ = 
               0; $CellContext`update$$ = 5000; $CellContext`gameName$$ = 
               "Snowdrift"; $CellContext`updateRule$$ = 
               "Imitative pairwise difference"; $CellContext`k$$ = 
               8; $CellContext`initxA$$ = 0.5; $CellContext`initqAA$$ = 
               0.5; $CellContext`showMD$$ = True; $CellContext`preset$$ = 
               "Hauert Doebeli 2004 fig1d r=0.2"), 
             "fig1d r=0.5" :> ($CellContext`a11$$ = 1; $CellContext`a12$$ = 
               0.5; $CellContext`a21$$ = 1.5; $CellContext`a22$$ = 
               0; $CellContext`update$$ = 6000; $CellContext`gameName$$ = 
               "Snowdrift"; $CellContext`updateRule$$ = 
               "Imitative pairwise difference"; $CellContext`k$$ = 
               8; $CellContext`initxA$$ = 0.5; $CellContext`initqAA$$ = 
               0.5; $CellContext`showMD$$ = True; $CellContext`preset$$ = 
               "Hauert Doebeli 2004 fig1d r=0.5"), 
             "fig1d r=0.9" :> ($CellContext`a11$$ = 1; $CellContext`a12$$ = 
               0.1; $CellContext`a21$$ = 1.9; $CellContext`a22$$ = 
               0; $CellContext`update$$ = 7000; $CellContext`gameName$$ = 
               "Snowdrift"; $CellContext`updateRule$$ = 
               "Imitative pairwise difference"; $CellContext`k$$ = 
               8; $CellContext`initxA$$ = 0.5; $CellContext`initqAA$$ = 
               0.5; $CellContext`showMD$$ = True; $CellContext`preset$$ = 
               "Hauert Doebeli 2004 fig1d r=0.9")}, 
           "Hauert & Szab\[OAcute] (2005)" -> {
            "fig5 r=0" :> ($CellContext`a11$$ = 1; $CellContext`a12$$ = 
               0; $CellContext`a21$$ = 1; $CellContext`a22$$ = 
               0; $CellContext`update$$ = 15500; $CellContext`gameName$$ = 
               "Weak Prisoner's D"; $CellContext`updateRule$$ = 
               "Fermi (set intensity \!\(\*StyleBox[\"m\",FontSlant->\"Italic\
\"]\))"; $CellContext`k$$ = 4; $CellContext`m$$ = 40; $CellContext`initxA$$ = 
               0.5; $CellContext`initqAA$$ = 0.5; $CellContext`showMD$$ = 
               False; $CellContext`maxTimeOut$$ = 20; $CellContext`preset$$ = 
               "Hauert Szab\[OAcute] 2005 fig5 r=0.01"), 
             "fig5 r=0.01" :> ($CellContext`a11$$ = 
               1; $CellContext`a12$$ = -0.01; $CellContext`a21$$ = 
               1.01; $CellContext`a22$$ = 0; $CellContext`update$$ = 
               16000; $CellContext`gameName$$ = 
               "Prisoner's Dilemma"; $CellContext`updateRule$$ = 
               "Fermi (set intensity \!\(\*StyleBox[\"m\",FontSlant->\"Italic\
\"]\))"; $CellContext`k$$ = 4; $CellContext`m$$ = 40; $CellContext`initxA$$ = 
               0.5; $CellContext`initqAA$$ = 0.5; $CellContext`showMD$$ = 
               False; $CellContext`maxTimeOut$$ = 20; $CellContext`preset$$ = 
               "Hauert Szab\[OAcute] 2005 fig5 r=0.01"), 
             "fig5 r=0.02" :> ($CellContext`a11$$ = 
               1; $CellContext`a12$$ = -0.02; $CellContext`a21$$ = 
               1.02; $CellContext`a22$$ = 0; $CellContext`update$$ = 
               17000; $CellContext`gameName$$ = 
               "Prisoner's Dilemma"; $CellContext`updateRule$$ = 
               "Fermi (set intensity \!\(\*StyleBox[\"m\",FontSlant->\"Italic\
\"]\))"; $CellContext`k$$ = 4; $CellContext`m$$ = 40; $CellContext`initxA$$ = 
               0.5; $CellContext`initqAA$$ = 0.5; $CellContext`showMD$$ = 
               False; $CellContext`maxTimeOut$$ = 20; $CellContext`preset$$ = 
               "Hauert Szab\[OAcute] 2005 fig5 r=0.02"), 
             "fig5 r=0.06" :> ($CellContext`a11$$ = 
               1; $CellContext`a12$$ = -0.06; $CellContext`a21$$ = 
               1.06; $CellContext`a22$$ = 0; $CellContext`update$$ = 
               18000; $CellContext`gameName$$ = 
               "Prisoner's Dilemma"; $CellContext`updateRule$$ = 
               "Fermi (set intensity \!\(\*StyleBox[\"m\",FontSlant->\"Italic\
\"]\))"; $CellContext`k$$ = 4; $CellContext`m$$ = 40; $CellContext`initxA$$ = 
               0.5; $CellContext`initqAA$$ = 0.5; $CellContext`showMD$$ = 
               False; $CellContext`maxTimeOut$$ = 20; $CellContext`preset$$ = 
               "Hauert Szab\[OAcute] 2005 fig5 r=0.02")}, 
           "Fu, Nowak & Hauert (2010)" -> {
            "fig4a,b u=0.02" :> ($CellContext`a11$$ = 1; $CellContext`a12$$ = 
               0; $CellContext`a21$$ = 1.02; $CellContext`a22$$ = 
               0.02; $CellContext`update$$ = 8000; $CellContext`gameName$$ = 
               "Prisoner's Dilemma"; $CellContext`updateRule$$ = 
               "Imitative pairwise difference"; $CellContext`k$$ = 
               8; $CellContext`initxA$$ = 0.01; $CellContext`initqAA$$ = 
               0.7; $CellContext`showMD$$ = False; $CellContext`preset$$ = 
               "Fu et al 2010 fig4ab u=0.02"), 
             "fig4a,b u=0.1" :> ($CellContext`a11$$ = 1; $CellContext`a12$$ = 
               0; $CellContext`a21$$ = 1.1; $CellContext`a22$$ = 
               0.1; $CellContext`update$$ = 9000; $CellContext`gameName$$ = 
               "Prisoner's Dilemma"; $CellContext`updateRule$$ = 
               "Imitative pairwise difference"; $CellContext`k$$ = 
               8; $CellContext`initxA$$ = 0.01; $CellContext`initqAA$$ = 
               0.7; $CellContext`showMD$$ = False; $CellContext`preset$$ = 
               "Fu et al 2010 fig4ab u=0.1"), Delimiter, 
             "fig4d,e v=0.05" :> ($CellContext`a11$$ = 1; $CellContext`a12$$ = 
               0.95; $CellContext`a21$$ = 1.05; $CellContext`a22$$ = 
               0; $CellContext`update$$ = 10000; $CellContext`gameName$$ = 
               "Snowdrift"; $CellContext`updateRule$$ = 
               "Imitative pairwise difference"; $CellContext`k$$ = 
               8; $CellContext`initxA$$ = 0.01; $CellContext`initqAA$$ = 
               0.7; $CellContext`showMD$$ = False; $CellContext`preset$$ = 
               "Fu et al 2010 fig4de v=0.05"), 
             "fig4d,e v=0.4" :> ($CellContext`a11$$ = 1; $CellContext`a12$$ = 
               0.6; $CellContext`a21$$ = 1.4; $CellContext`a22$$ = 
               0; $CellContext`update$$ = 11000; $CellContext`gameName$$ = 
               "Snowdrift"; $CellContext`updateRule$$ = 
               "Imitative pairwise difference"; $CellContext`k$$ = 
               8; $CellContext`initxA$$ = 0.01; $CellContext`initqAA$$ = 
               0.7; $CellContext`showMD$$ = False; $CellContext`preset$$ = 
               "Fu et al 2010 fig4de v=0.4"), Delimiter, 
             "fig6a u=0.05" :> ($CellContext`a11$$ = 1; $CellContext`a12$$ = 
               0; $CellContext`a21$$ = 1.05; $CellContext`a22$$ = 
               0.05; $CellContext`update$$ = 12000; $CellContext`gameName$$ = 
               "Prisoner's Dilemma"; $CellContext`updateRule$$ = 
               "Imitative pairwise difference"; $CellContext`k$$ = 
               8; $CellContext`initxA$$ = 0.01; $CellContext`initqAA$$ = 
               0.7; $CellContext`showMD$$ = True; $CellContext`preset$$ = 
               "Fu et al 2010 fig6a u=0.05"), 
             "fig6a u=0.15" :> ($CellContext`a11$$ = 1; $CellContext`a12$$ = 
               0; $CellContext`a21$$ = 1.15; $CellContext`a22$$ = 
               0.15; $CellContext`update$$ = 13000; $CellContext`gameName$$ = 
               "Prisoner's Dilemma"; $CellContext`updateRule$$ = 
               "Imitative pairwise difference"; $CellContext`k$$ = 
               8; $CellContext`initxA$$ = 0.01; $CellContext`initqAA$$ = 
               0.7; $CellContext`showMD$$ = True; $CellContext`preset$$ = 
               "Fu et al 2010 fig6a u=0.15"), Delimiter, 
             "fig6c v=0.5" :> ($CellContext`a11$$ = 1; $CellContext`a12$$ = 
               0.5; $CellContext`a21$$ = 1.5; $CellContext`a22$$ = 
               0; $CellContext`update$$ = 14000; $CellContext`gameName$$ = 
               "Snowdrift"; $CellContext`updateRule$$ = 
               "Imitative pairwise difference"; $CellContext`k$$ = 
               8; $CellContext`initxA$$ = 0.01; $CellContext`initqAA$$ = 
               0.7; $CellContext`showMD$$ = True; $CellContext`preset$$ = 
               "Fu et al 2010 fig6c v=0.5"), 
             "fig6c v=1" :> ($CellContext`a11$$ = 1; $CellContext`a12$$ = 
               0; $CellContext`a21$$ = 2; $CellContext`a22$$ = 
               0; $CellContext`update$$ = 15000; $CellContext`gameName$$ = 
               "Snowdrift"; $CellContext`updateRule$$ = 
               "Imitative pairwise difference"; $CellContext`k$$ = 
               8; $CellContext`initxA$$ = 0.01; $CellContext`initqAA$$ = 
               0.7; $CellContext`showMD$$ = True; $CellContext`preset$$ = 
               "Fu et al 2010 fig6c v=1")}}, Appearance -> "PopupMenu", 
          ImageSize -> {220, 20}]}, ImageSize -> 220, Alignment -> Center]], 
      Manipulate`Dump`ThisIsNotAControl, ControlType -> None}, {
      Hold[
       Style[
       "Payoffs (\!\(\*SubscriptBox[\(\[CapitalPi]\), \(ij\)]\))", Bold, 
        Medium]], Manipulate`Dump`ThisIsNotAControl, ControlType -> None}, {
      Hold[
       Row[{
         ActionMenu[
          Dynamic[$CellContext`gameName$$], {
          "Snowdrift" :> {$CellContext`a11$$ = 3, $CellContext`a12$$ = 
             1, $CellContext`a21$$ = 4, $CellContext`a22$$ = 
             0, $CellContext`update$$ = 500; $CellContext`gameName$$ = 
              "Snowdrift", $CellContext`preset$$ = "Presets"}, 
           "Prisoner's Dilemma" :> {$CellContext`a11$$ = 
             3, $CellContext`a12$$ = 0, $CellContext`a21$$ = 
             4, $CellContext`a22$$ = 
             1, $CellContext`update$$ = 1000; $CellContext`gameName$$ = 
              "Prisoner's Dilemma", $CellContext`preset$$ = "Presets"}, 
           "Coordination" :> {$CellContext`a11$$ = 2, $CellContext`a12$$ = 
             0, $CellContext`a21$$ = 0, $CellContext`a22$$ = 
             1, $CellContext`update$$ = 2000; $CellContext`gameName$$ = 
              "Coordination", $CellContext`preset$$ = "Presets"}, 
           "All 0s" :> {$CellContext`a11$$ = 0, $CellContext`a12$$ = 
             0, $CellContext`a21$$ = 0, $CellContext`a22$$ = 
             0, $CellContext`update$$ = 3000; $CellContext`gameName$$ = 
              "All 0s", $CellContext`preset$$ = "Presets"}}, Appearance -> 
          "PopupMenu", ImageSize -> {150, 20}]}, ImageSize -> 180, Alignment -> 
        Center]], Manipulate`Dump`ThisIsNotAControl, ControlType -> None}, {{
       Hold[$CellContext`a11$$], 1, 
       "\!\(\*SubscriptBox[\(\[CapitalPi]\), \(\(A\)\(\[CenterDot]\)\)]\)"}, 
      Dynamic[InputField[
        Dynamic[$CellContext`a11$$, ($CellContext`a11$$ = \
$CellContext`ForceNumber[#])& ], Number, FieldSize -> 4]& ], ControlType -> 
      Automatic}, {{
       Hold[$CellContext`a12$$], 0.8, ""}, 
      Dynamic[InputField[
        Dynamic[$CellContext`a12$$, ($CellContext`a12$$ = \
$CellContext`ForceNumber[#])& ], Number, FieldSize -> 4]& ], ControlType -> 
      Automatic}, {{
       Hold[$CellContext`a21$$], 1.2, 
       "\!\(\*SubscriptBox[\(\[CapitalPi]\), \(\(B\)\(\[CenterDot]\)\)]\)"}, 
      Dynamic[InputField[
        Dynamic[$CellContext`a21$$, ($CellContext`a21$$ = \
$CellContext`ForceNumber[#])& ], Number, FieldSize -> 4]& ], ControlType -> 
      Automatic}, {{
       Hold[$CellContext`a22$$], 0, ""}, 
      Dynamic[InputField[
        Dynamic[$CellContext`a22$$, ($CellContext`a22$$ = \
$CellContext`ForceNumber[#])& ], Number, FieldSize -> 4]& ], ControlType -> 
      Automatic}, {
      Hold[
       Grid[{{"              ", 
          Manipulate`Place[1], 
          Manipulate`Place[2]}, {"", 
          Manipulate`Place[3], 
          Manipulate`Place[4]}}, Alignment -> Right]], 
      Manipulate`Dump`ThisIsNotAControl, ControlType -> None}, {
      Hold[
       Button[
       "Update", 
        Increment[$CellContext`update$$]; $CellContext`gameName$$ = 
         "Predefined games"; $CellContext`preset$$ = "Presets", ImageSize -> 
        180]], Manipulate`Dump`ThisIsNotAControl, ControlType -> None}, {
      Hold[
       Style["Degree of regular network", Bold, Medium]], 
      Manipulate`Dump`ThisIsNotAControl, ControlType -> None}, {{
       Hold[$CellContext`k$$], 8, 
       "\!\(\*StyleBox[\"k\",FontSlant->\"Italic\"]\)"}, 2, 10, 1, 
      ControlType -> Manipulator}, {{
       Hold[$CellContext`updateRule$$], "Imitative pairwise difference", 
       ""}, {"Imitative pairwise difference", "Imitate if better, all nbrs", 
       "Fermi (set intensity \!\(\*StyleBox[\"m\",FontSlant->\"Italic\"]\))", 
       "Best neighbor"}, ControlType -> PopupMenu}, {
      Hold[
       Grid[{{
          Style["Decision rule", Bold, Medium]}, {
          Manipulate`Place[5]}}, Alignment -> Left]], 
      Manipulate`Dump`ThisIsNotAControl, ControlType -> None}, {{
       Hold[$CellContext`m$$], 1, 
       "Fermi's \!\(\*StyleBox[\"m\",FontSlant->\"Italic\"]\)"}, 0.5, 40, 
      0.01, ControlType -> Manipulator}, {
      Hold[
       Style["Initial conditions", Bold, Medium]], 
      Manipulate`Dump`ThisIsNotAControl, ControlType -> None}, {{
       Hold[$CellContext`initxA$$], 0.5, 
       "\!\(\*SubscriptBox[StyleBox[\"x\",FontSlant->\"Italic\"], \
\"A\"]\)\!\(\*StyleBox[\"(\",FontWeight->\"Plain\"]\)\!\(\*StyleBox[\"0\",\
FontWeight->\"Plain\"]\)\!\(\*StyleBox[\")\",FontWeight->\"Plain\"]\)"}, 0.01,
       0.99, 0.01, ControlType -> Manipulator}, {{
       Hold[$CellContext`initqAA$$], 0.5, 
       "\!\(\*SubscriptBox[StyleBox[\"q\",FontSlant->\"Italic\"], \"AA\"]\)\!\
\(\*StyleBox[\"(\",FontWeight->\"Plain\"]\)\!\(\*StyleBox[\"0\",FontWeight->\"\
Plain\"]\)\!\(\*StyleBox[\")\",FontWeight->\"Plain\"]\)"}, 0.01, 0.99, 0.01, 
      ControlType -> Manipulator}, {
      Hold[
       Style["Mean Dynamic (MD)", Bold, Medium]], 
      Manipulate`Dump`ThisIsNotAControl, ControlType -> None}, {{
       Hold[$CellContext`showMD$$], True, "Show MD"}, {True, False}, 
      ControlType -> Checkbox}, {
      Hold[
       Style["Time allowed for computations", Bold, Medium]], 
      Manipulate`Dump`ThisIsNotAControl, ControlType -> None}, {{
       Hold[$CellContext`maxTimeOut$$], 1, "maxTimeOut (s)"}, 1, 20, 1, 
      ControlType -> Manipulator}}, Typeset`size$$ = {578., {246., 254.}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = False}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`a11$$ = 1, $CellContext`a12$$ = 
        0.8, $CellContext`a21$$ = 1.2, $CellContext`a22$$ = 
        0, $CellContext`gameName$$ = "Snowdrift", $CellContext`initqAA$$ = 
        0.5, $CellContext`initxA$$ = 0.5, $CellContext`k$$ = 
        4, $CellContext`m$$ = 1, $CellContext`maxTimeOut$$ = 
        1, $CellContext`preset$$ = 
        "Hauert Doebeli 2004 fig1b r=0.2", $CellContext`showMD$$ = 
        True, $CellContext`update$$ = 0, $CellContext`updateRule$$ = 
        "Imitative pairwise difference"}, "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`\[Rho]A$, $CellContext`\[Rho]B$, \
$CellContext`qAA$, $CellContext`xAA$, $CellContext`qAB$, $CellContext`qBA$, \
$CellContext`payoffs$, $CellContext`initialxA$, $CellContext`initialqAA$, \
$CellContext`rulesToAddt$, $CellContext`t$, $CellContext`maxTime$ = 
         100000, $CellContext`tolerance$ = 
         10^(-8), $CellContext`accuracyGoal$ = 
         6, $CellContext`maxDiff$, $CellContext`mR$, $CellContext`errorPA$ = 
         False, $CellContext`errorMD$ = False, $CellContext`tooLong$ = 
         False, $CellContext`limitingxPA$, $CellContext`limitingqPA$, \
$CellContext`limitingxMD$, $CellContext`epsilon$ = 
         10^(-4)}, $CellContext`payoffs$ = 
         Rationalize[{$CellContext`a11$$, $CellContext`a12$$, \
$CellContext`a21$$, $CellContext`a22$$}, 
           0]; {$CellContext`initialxA$, $CellContext`initialqAA$} = 
         Rationalize[{$CellContext`initxA$$, $CellContext`initqAA$$}, 
           0]; $CellContext`actualFinalTimePA = $CellContext`maxTime$; \
$CellContext`actualFinalTimeMD = $CellContext`maxTime$; $CellContext`xAA$ = \
$CellContext`\[Rho]A$ $CellContext`qAA$; $CellContext`\[Rho]B$ = 
         1 - $CellContext`\[Rho]A$; $CellContext`qBA$ = 
         1 - $CellContext`qAA$; $CellContext`qAB$ = ($CellContext`\[Rho]A$/(
           1 - $CellContext`\[Rho]A$)) (
           1 - $CellContext`qAA$); $CellContext`maxDiff$ = Max[
           Outer[Subtract, $CellContext`payoffs$, $CellContext`payoffs$]]; 
        If[$CellContext`maxDiff$ == 0, $CellContext`maxDiff$ = 
          1]; $CellContext`mR$ = 
         Rationalize[$CellContext`m$$, 0]; $CellContext`rulesToAddt$ = {
          Derivative[1][$CellContext`\[Rho]A$] -> 
           Derivative[
            1][$CellContext`\[Rho]A$][$CellContext`t$], $CellContext`\[Rho]A$ -> \
$CellContext`\[Rho]A$[$CellContext`t$], $CellContext`qAA$ -> \
$CellContext`qAA$[$CellContext`t$]}; 
        Derivative[
          1][$CellContext`xAA$] = $CellContext`\[Rho]B$ 
           Sum[$CellContext`PB[$CellContext`kA, $CellContext`k$$, \
$CellContext`qAB$] $CellContext`FB[$CellContext`kA, $CellContext`k$$, \
$CellContext`maxDiff$, $CellContext`mR$, $CellContext`payoffs$, \
$CellContext`qAA$, $CellContext`qAB$] (
              2 ($CellContext`kA/$CellContext`k$$)), {$CellContext`kA, 
              0, $CellContext`k$$}] - $CellContext`\[Rho]A$ 
          Sum[$CellContext`PA[$CellContext`kA, $CellContext`k$$, \
$CellContext`qAA$] $CellContext`FA[$CellContext`kA, $CellContext`k$$, \
$CellContext`maxDiff$, $CellContext`mR$, $CellContext`payoffs$, \
$CellContext`qAA$, $CellContext`qAB$] (
             2 ($CellContext`kA/$CellContext`k$$)), {$CellContext`kA, 
             0, $CellContext`k$$}]; $CellContext`pairApproximationSolution = 
         Block[{$MaxExtraPrecision = 1000}, 
           TimeConstrained[
            Quiet[
             Check[
              
              NDSolveValue[{
               Derivative[1][$CellContext`\[Rho]A$][$CellContext`t$] == 
                ReplaceAll[$CellContext`\[Rho]B$ 
                   Sum[$CellContext`PB[$CellContext`kA, $CellContext`k$$, \
$CellContext`qAB$] $CellContext`FB[$CellContext`kA, $CellContext`k$$, \
$CellContext`maxDiff$, $CellContext`mR$, $CellContext`payoffs$, \
$CellContext`qAA$, $CellContext`qAB$], {$CellContext`kA, 
                    0, $CellContext`k$$}] - $CellContext`\[Rho]A$ 
                  Sum[$CellContext`PA[$CellContext`kA, $CellContext`k$$, \
$CellContext`qAA$] $CellContext`FA[$CellContext`kA, $CellContext`k$$, \
$CellContext`maxDiff$, $CellContext`mR$, $CellContext`payoffs$, \
$CellContext`qAA$, $CellContext`qAB$], {$CellContext`kA, 
                    0, $CellContext`k$$}], $CellContext`rulesToAddt$], 
                Derivative[1][$CellContext`qAA$][$CellContext`t$] == 
                ReplaceAll[
                 Derivative[
                    1][$CellContext`xAA$]/$CellContext`\[Rho]A$ - \
($CellContext`xAA$/$CellContext`\[Rho]A$^2) 
                  Derivative[
                   1][$CellContext`\[Rho]A$], $CellContext`rulesToAddt$], \
$CellContext`\[Rho]A$[0] == $CellContext`initialxA$, $CellContext`qAA$[
                 0] == $CellContext`initialqAA$, 
                WhenEvent[{Norm[{
                    Derivative[1][$CellContext`\[Rho]A$][$CellContext`t$], 
                    Derivative[
                    1][$CellContext`qAA$][$CellContext`t$]}] - \
$CellContext`tolerance$ < 0}, 
                 "StopIntegration"; $CellContext`actualFinalTimePA = \
$CellContext`t$]}, {$CellContext`\[Rho]A$, $CellContext`qAA$}, \
{$CellContext`t$, 0, $CellContext`maxTime$}, 
               AccuracyGoal -> $CellContext`accuracyGoal$, MaxSteps -> 
               Infinity, WorkingPrecision -> 20, 
               Method -> {
                "TimeIntegration" -> "StiffnessSwitching", 
                 "EquationSimplification" -> {
                  "Solve", "TimeConstraint" -> 10}}], $CellContext`errorPA$ = 
               True; $CellContext`actualFinalTimePA = 
               10; {-1& , -1& }]], $CellContext`maxTimeOut$$]]; 
        If[$CellContext`pairApproximationSolution === $Aborted, \
$CellContext`tooLong$ = 
           True; $CellContext`pairApproximationSolution = {-1& , -1& }; \
$CellContext`actualFinalTimePA = 0; Null]; $CellContext`actualFinalTimeMD = 
         Max[10, $CellContext`actualFinalTimePA]; \
$CellContext`meanDynamicSolution = 
         If[$CellContext`updateRule$$ != "Imitate if better, all nbrs", 
           Quiet[
            Check[
             
             NDSolveValue[{
              Derivative[1][$CellContext`\[Rho]A$][$CellContext`t$] == 
               ReplaceAll[
                 $CellContext`ExpectedChange[$CellContext`maxDiff$, \
$CellContext`mR$, $CellContext`payoffs$, $CellContext`\[Rho]A$], \
$CellContext`rulesToAddt$], $CellContext`\[Rho]A$[
                0] == $CellContext`initialxA$, 
               WhenEvent[Abs[
                   Derivative[
                   1][$CellContext`\[Rho]A$][$CellContext`t$]] - \
$CellContext`tolerance$ < 0, 
                "StopIntegration"; $CellContext`actualFinalTimeMD = \
$CellContext`t$]}, $CellContext`\[Rho]A$, {$CellContext`t$, 
               0, $CellContext`maxTime$}, 
              AccuracyGoal -> $CellContext`accuracyGoal$, MaxSteps -> 
              Infinity, 
              Method -> {
               "StiffnessSwitching", "DiscontinuityProcessing" -> 
                False}], $CellContext`errorMD$ = 
              True; $CellContext`actualFinalTimeMD = 
              10; -1& ]], -1& ]; \
$CellContext`meanDynamicSolutionImitateIfBetterAllNbrs = \
$CellContext`MDsolutionImitateIfBetterAllNbrs[$CellContext`initialxA$, \
$CellContext`payoffs$]; $CellContext`update$$; $CellContext`actualFinalTime = 
         Max[$CellContext`actualFinalTimePA, $CellContext`actualFinalTimeMD]; \
$CellContext`limitingxPA$ = Chop[
           
           First[$CellContext`pairApproximationSolution][$CellContext`\
actualFinalTime], 10^(-5)]; $CellContext`limitingqPA$ = Chop[
           
           Last[$CellContext`pairApproximationSolution][$CellContext`\
actualFinalTime], 10^(-5)]; If[
          Not[
           And[
           0 - $CellContext`epsilon$ <= $CellContext`limitingxPA$ <= 
            1 + $CellContext`epsilon$, 
            0 - $CellContext`epsilon$ <= $CellContext`limitingqPA$ <= 
            1 + $CellContext`epsilon$]], $CellContext`errorPA$ = 
           True; $CellContext`pairApproximationSolution = {-1& , -1& }; 
          Null]; $CellContext`limitingxMD$ = \
$CellContext`meanDynamicSolution[$CellContext`actualFinalTime]; If[
          
          And[$CellContext`updateRule$$ != 
           "Imitate if better, all nbrs", $CellContext`showMD$$, 
           Not[
           0 - $CellContext`epsilon$ <= $CellContext`limitingxMD$ <= 
            1 + $CellContext`epsilon$]], $CellContext`errorMD$ = 
           True; $CellContext`meanDynamicSolution = -1& ; Null]; Pane[
          Grid[{{
             Item[
              Manipulate[
               Plot[{
                 Evaluate[
                  MapThread[Tooltip, {
                    
                    Map[#[$CellContext`t2]& , \
$CellContext`pairApproximationSolution], {"\[Rho]A", "qAA"}}]], 
                 Evaluate[
                  Tooltip[
                   If[$CellContext`showMD$$, 
                    
                    If[$CellContext`updateRule$$ == 
                    "Imitate if better, all nbrs", 
                    $CellContext`meanDynamicSolutionImitateIfBetterAllNbrs[$\
CellContext`t2], 
                    $CellContext`meanDynamicSolution[$CellContext`t2]], -1], 
                   "MD"]]}, {$CellContext`t2, 
                 0, $CellContext`actualFinalTime/$CellContext`z^2}, 
                PlotLegends -> LineLegend[{
                   Directive[
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[2]], 
                   Directive[
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[2]], 
                   Directive[
                    If[$CellContext`showMD$$, Black, White], 
                    AbsoluteThickness[2], Dashed]}, 
                  
                  If[$CellContext`showMD$$, {
                   "\!\(\*SubscriptBox[\(x\), \(A\)]\)", 
                    "\!\(\*SubscriptBox[\(q\), \(AA\)]\)", "MD"}, {
                   "\!\(\*SubscriptBox[\(x\), \(A\)]\)", 
                    "\!\(\*SubscriptBox[\(q\), \(AA\)]\)", ""}]], ImageSize -> 
                Medium, PlotRange -> {{0, Automatic}, {-0.01, 1.01}}, 
                AxesLabel -> {
                 "\!\(\*StyleBox[\"t\",FontSlant->\"Italic\"]\)", None}, 
                PlotStyle -> {
                  Directive[
                   RGBColor[0.368417, 0.506779, 0.709798], 
                   AbsoluteThickness[2]], 
                  Directive[
                   RGBColor[0.880722, 0.611041, 0.142051], 
                   AbsoluteThickness[2]], 
                  Directive[Black, 
                   AbsoluteThickness[2], Dashed]}, ImageSize -> 
                450], {{$CellContext`z, 1, "zoom"}, 1, 100}, 
               SynchronousUpdating -> True, ContinuousAction -> True, 
               AppearanceElements -> None, Paneled -> False], Alignment -> 
              Center], SpanFromLeft, SpanFromLeft}, {
             If[
              Or[
               And[
                Not[$CellContext`errorPA$], 
                Not[$CellContext`tooLong$]], 
               And[$CellContext`showMD$$, 
                Not[$CellContext`errorMD$]]], 
              
              Row[{"Numerical integration stopped at \
\!\(\*StyleBox[\"t\",FontSlant->\"Italic\"]\)=", 
                ScientificForm[
                 N[
                  Floor[$CellContext`actualFinalTime]], 3], " because ", 
                
                If[$CellContext`actualFinalTime < $CellContext`maxTime$, 
                 "all computed values stabilized at that time", 
                 "that is the maximum time set for integration"]}], ""], 
             SpanFromLeft, SpanFromLeft}, {}, {
             Style["Pair Approximation", Black, 14], "", 
             If[$CellContext`showMD$$, 
              Style["Mean Dynamic (MD)", Black, 14], ""]}, {
             If[$CellContext`errorPA$, 
              Style["Numerical instability", Red, 12], 
              If[$CellContext`tooLong$, 
               Style["Solving the pair approximation", Red, 12], 
               Style[
                
                Row[{"\!\(\*SubscriptBox[StyleBox[\"x\",FontSlant->\"Italic\"]\
, \"A\"]\)(\!\(\*StyleBox[\"t\",FontSlant->\"Italic\"]\)=", 
                  ScientificForm[
                   N[
                    Floor[$CellContext`actualFinalTime]], 3], ") = ", 
                  NumberForm[$CellContext`limitingxPA$, 3]}], 
                Darker[Blue], 12]]], "", 
             If[$CellContext`showMD$$, 
              If[$CellContext`errorMD$, 
               Style["Numerical instability", Red, 12], 
               Style[
                
                Row[{"\!\(\*SubscriptBox[StyleBox[\"x\",FontSlant->\"Italic\"]\
, \"A\"]\)(\!\(\*StyleBox[\"t\",FontSlant->\"Italic\"]\)=", 
                  ScientificForm[
                   N[
                    Floor[$CellContext`actualFinalTime]], 3], ") = ", 
                  NumberForm[
                   Chop[
                    
                    If[$CellContext`updateRule$$ == 
                    "Imitate if better, all nbrs", 
                    Quiet[
                    N[
                    $CellContext`meanDynamicSolutionImitateIfBetterAllNbrs[$\
CellContext`actualFinalTime]]], $CellContext`limitingxMD$], 10^(-5)], 3]}], 
                Black, 12]], ""]}, {
             If[$CellContext`errorPA$, 
              Style["Please, try changing the initial conditions", Black, 10], 
              If[$CellContext`tooLong$, 
               
               Style[("takes longer than maxTimeOut = " <> 
                 ToString[$CellContext`maxTimeOut$$]) <> "s.", Red, 12], 
               Style[
                
                Row[{"\!\(\*SubscriptBox[StyleBox[\"q\",FontSlant->\"Italic\"]\
, \"AA\"]\)(\!\(\*StyleBox[\"t\",FontSlant->\"Italic\"]\)=", 
                  ScientificForm[
                   N[
                    Floor[$CellContext`actualFinalTime]], 3], ") = ", 
                  NumberForm[$CellContext`limitingqPA$, 3]}], 
                Darker[Orange], 12]]], "", 
             If[
              And[$CellContext`showMD$$, $CellContext`errorMD$], 
              Style["Please, try changing initial cond.", Black, 10], ""]}}, 
           Alignment -> {{Left, Center, Right}}]]], 
      "Specifications" :> {{{$CellContext`preset$$, 
          "Hauert Doebeli 2004 fig1b r=0.2"}, ControlType -> 
         None}, {{$CellContext`a11$$, 1}, ControlType -> 
         None}, {{$CellContext`a12$$, 0.8}, ControlType -> 
         None}, {{$CellContext`a21$$, 1.2}, ControlType -> 
         None}, {{$CellContext`a22$$, 0}, ControlType -> 
         None}, {{$CellContext`gameName$$, "Snowdrift"}, ControlType -> 
         None}, {{$CellContext`k$$, 4}, ControlType -> 
         None}, {{$CellContext`update$$, 0}, 0, 100, ControlType -> 
         None}, {{$CellContext`updateRule$$, "Imitative pairwise difference"},
          ControlType -> None}, {{$CellContext`m$$, 1}, ControlType -> 
         None}, {{$CellContext`initxA$$, 0.5}, ControlType -> 
         None}, {{$CellContext`initqAA$$, 0.5}, ControlType -> 
         None}, {{$CellContext`showMD$$, True}, ControlType -> 
         None}, {{$CellContext`maxTimeOut$$, 1}, ControlType -> None}, 
        Style["Presets for replication", Bold, Medium], 
        Row[{
          ActionMenu[
           Dynamic[$CellContext`preset$$], {
           "Hauert & Doebeli (2004)" -> {
             "fig1b r=0.2" :> ($CellContext`a11$$ = 1; $CellContext`a12$$ = 
                0.8; $CellContext`a21$$ = 1.2; $CellContext`a22$$ = 
                0; $CellContext`update$$ = 1000; $CellContext`gameName$$ = 
                "Snowdrift"; $CellContext`updateRule$$ = 
                "Imitative pairwise difference"; $CellContext`k$$ = 
                4; $CellContext`initxA$$ = 0.5; $CellContext`initqAA$$ = 
                0.5; $CellContext`showMD$$ = True; $CellContext`preset$$ = 
                "Hauert Doebeli 2004 fig1b r=0.2"), 
              "fig1b r=0.5" :> ($CellContext`a11$$ = 1; $CellContext`a12$$ = 
                0.5; $CellContext`a21$$ = 1.5; $CellContext`a22$$ = 
                0; $CellContext`update$$ = 2000; $CellContext`gameName$$ = 
                "Snowdrift"; $CellContext`updateRule$$ = 
                "Imitative pairwise difference"; $CellContext`k$$ = 
                4; $CellContext`initxA$$ = 0.5; $CellContext`initqAA$$ = 
                0.5; $CellContext`showMD$$ = True; $CellContext`preset$$ = 
                "Hauert Doebeli 2004 fig1b r=0.5"), 
              "fig1b r=0.9" :> ($CellContext`a11$$ = 1; $CellContext`a12$$ = 
                0.1; $CellContext`a21$$ = 1.9; $CellContext`a22$$ = 
                0; $CellContext`update$$ = 3000; $CellContext`gameName$$ = 
                "Snowdrift"; $CellContext`updateRule$$ = 
                "Imitative pairwise difference"; $CellContext`k$$ = 
                4; $CellContext`initxA$$ = 0.5; $CellContext`initqAA$$ = 
                0.5; $CellContext`showMD$$ = True; $CellContext`preset$$ = 
                "Hauert Doebeli 2004 fig1b r=0.9"), Delimiter, 
              "fig1d r=0.2" :> ($CellContext`a11$$ = 1; $CellContext`a12$$ = 
                0.8; $CellContext`a21$$ = 1.2; $CellContext`a22$$ = 
                0; $CellContext`update$$ = 5000; $CellContext`gameName$$ = 
                "Snowdrift"; $CellContext`updateRule$$ = 
                "Imitative pairwise difference"; $CellContext`k$$ = 
                8; $CellContext`initxA$$ = 0.5; $CellContext`initqAA$$ = 
                0.5; $CellContext`showMD$$ = True; $CellContext`preset$$ = 
                "Hauert Doebeli 2004 fig1d r=0.2"), 
              "fig1d r=0.5" :> ($CellContext`a11$$ = 1; $CellContext`a12$$ = 
                0.5; $CellContext`a21$$ = 1.5; $CellContext`a22$$ = 
                0; $CellContext`update$$ = 6000; $CellContext`gameName$$ = 
                "Snowdrift"; $CellContext`updateRule$$ = 
                "Imitative pairwise difference"; $CellContext`k$$ = 
                8; $CellContext`initxA$$ = 0.5; $CellContext`initqAA$$ = 
                0.5; $CellContext`showMD$$ = True; $CellContext`preset$$ = 
                "Hauert Doebeli 2004 fig1d r=0.5"), 
              "fig1d r=0.9" :> ($CellContext`a11$$ = 1; $CellContext`a12$$ = 
                0.1; $CellContext`a21$$ = 1.9; $CellContext`a22$$ = 
                0; $CellContext`update$$ = 7000; $CellContext`gameName$$ = 
                "Snowdrift"; $CellContext`updateRule$$ = 
                "Imitative pairwise difference"; $CellContext`k$$ = 
                8; $CellContext`initxA$$ = 0.5; $CellContext`initqAA$$ = 
                0.5; $CellContext`showMD$$ = True; $CellContext`preset$$ = 
                "Hauert Doebeli 2004 fig1d r=0.9")}, 
            "Hauert & Szab\[OAcute] (2005)" -> {
             "fig5 r=0" :> ($CellContext`a11$$ = 1; $CellContext`a12$$ = 
                0; $CellContext`a21$$ = 1; $CellContext`a22$$ = 
                0; $CellContext`update$$ = 15500; $CellContext`gameName$$ = 
                "Weak Prisoner's D"; $CellContext`updateRule$$ = 
                "Fermi (set intensity \
\!\(\*StyleBox[\"m\",FontSlant->\"Italic\"]\))"; $CellContext`k$$ = 
                4; $CellContext`m$$ = 40; $CellContext`initxA$$ = 
                0.5; $CellContext`initqAA$$ = 0.5; $CellContext`showMD$$ = 
                False; $CellContext`maxTimeOut$$ = 20; $CellContext`preset$$ = 
                "Hauert Szab\[OAcute] 2005 fig5 r=0.01"), 
              "fig5 r=0.01" :> ($CellContext`a11$$ = 
                1; $CellContext`a12$$ = -0.01; $CellContext`a21$$ = 
                1.01; $CellContext`a22$$ = 0; $CellContext`update$$ = 
                16000; $CellContext`gameName$$ = 
                "Prisoner's Dilemma"; $CellContext`updateRule$$ = 
                "Fermi (set intensity \
\!\(\*StyleBox[\"m\",FontSlant->\"Italic\"]\))"; $CellContext`k$$ = 
                4; $CellContext`m$$ = 40; $CellContext`initxA$$ = 
                0.5; $CellContext`initqAA$$ = 0.5; $CellContext`showMD$$ = 
                False; $CellContext`maxTimeOut$$ = 20; $CellContext`preset$$ = 
                "Hauert Szab\[OAcute] 2005 fig5 r=0.01"), 
              "fig5 r=0.02" :> ($CellContext`a11$$ = 
                1; $CellContext`a12$$ = -0.02; $CellContext`a21$$ = 
                1.02; $CellContext`a22$$ = 0; $CellContext`update$$ = 
                17000; $CellContext`gameName$$ = 
                "Prisoner's Dilemma"; $CellContext`updateRule$$ = 
                "Fermi (set intensity \
\!\(\*StyleBox[\"m\",FontSlant->\"Italic\"]\))"; $CellContext`k$$ = 
                4; $CellContext`m$$ = 40; $CellContext`initxA$$ = 
                0.5; $CellContext`initqAA$$ = 0.5; $CellContext`showMD$$ = 
                False; $CellContext`maxTimeOut$$ = 20; $CellContext`preset$$ = 
                "Hauert Szab\[OAcute] 2005 fig5 r=0.02"), 
              "fig5 r=0.06" :> ($CellContext`a11$$ = 
                1; $CellContext`a12$$ = -0.06; $CellContext`a21$$ = 
                1.06; $CellContext`a22$$ = 0; $CellContext`update$$ = 
                18000; $CellContext`gameName$$ = 
                "Prisoner's Dilemma"; $CellContext`updateRule$$ = 
                "Fermi (set intensity \
\!\(\*StyleBox[\"m\",FontSlant->\"Italic\"]\))"; $CellContext`k$$ = 
                4; $CellContext`m$$ = 40; $CellContext`initxA$$ = 
                0.5; $CellContext`initqAA$$ = 0.5; $CellContext`showMD$$ = 
                False; $CellContext`maxTimeOut$$ = 20; $CellContext`preset$$ = 
                "Hauert Szab\[OAcute] 2005 fig5 r=0.02")}, 
            "Fu, Nowak & Hauert (2010)" -> {
             "fig4a,b u=0.02" :> ($CellContext`a11$$ = 1; $CellContext`a12$$ = 
                0; $CellContext`a21$$ = 1.02; $CellContext`a22$$ = 
                0.02; $CellContext`update$$ = 8000; $CellContext`gameName$$ = 
                "Prisoner's Dilemma"; $CellContext`updateRule$$ = 
                "Imitative pairwise difference"; $CellContext`k$$ = 
                8; $CellContext`initxA$$ = 0.01; $CellContext`initqAA$$ = 
                0.7; $CellContext`showMD$$ = False; $CellContext`preset$$ = 
                "Fu et al 2010 fig4ab u=0.02"), 
              "fig4a,b u=0.1" :> ($CellContext`a11$$ = 1; $CellContext`a12$$ = 
                0; $CellContext`a21$$ = 1.1; $CellContext`a22$$ = 
                0.1; $CellContext`update$$ = 9000; $CellContext`gameName$$ = 
                "Prisoner's Dilemma"; $CellContext`updateRule$$ = 
                "Imitative pairwise difference"; $CellContext`k$$ = 
                8; $CellContext`initxA$$ = 0.01; $CellContext`initqAA$$ = 
                0.7; $CellContext`showMD$$ = False; $CellContext`preset$$ = 
                "Fu et al 2010 fig4ab u=0.1"), Delimiter, 
              "fig4d,e v=0.05" :> ($CellContext`a11$$ = 1; $CellContext`a12$$ = 
                0.95; $CellContext`a21$$ = 1.05; $CellContext`a22$$ = 
                0; $CellContext`update$$ = 10000; $CellContext`gameName$$ = 
                "Snowdrift"; $CellContext`updateRule$$ = 
                "Imitative pairwise difference"; $CellContext`k$$ = 
                8; $CellContext`initxA$$ = 0.01; $CellContext`initqAA$$ = 
                0.7; $CellContext`showMD$$ = False; $CellContext`preset$$ = 
                "Fu et al 2010 fig4de v=0.05"), 
              "fig4d,e v=0.4" :> ($CellContext`a11$$ = 1; $CellContext`a12$$ = 
                0.6; $CellContext`a21$$ = 1.4; $CellContext`a22$$ = 
                0; $CellContext`update$$ = 11000; $CellContext`gameName$$ = 
                "Snowdrift"; $CellContext`updateRule$$ = 
                "Imitative pairwise difference"; $CellContext`k$$ = 
                8; $CellContext`initxA$$ = 0.01; $CellContext`initqAA$$ = 
                0.7; $CellContext`showMD$$ = False; $CellContext`preset$$ = 
                "Fu et al 2010 fig4de v=0.4"), Delimiter, 
              "fig6a u=0.05" :> ($CellContext`a11$$ = 1; $CellContext`a12$$ = 
                0; $CellContext`a21$$ = 1.05; $CellContext`a22$$ = 
                0.05; $CellContext`update$$ = 12000; $CellContext`gameName$$ = 
                "Prisoner's Dilemma"; $CellContext`updateRule$$ = 
                "Imitative pairwise difference"; $CellContext`k$$ = 
                8; $CellContext`initxA$$ = 0.01; $CellContext`initqAA$$ = 
                0.7; $CellContext`showMD$$ = True; $CellContext`preset$$ = 
                "Fu et al 2010 fig6a u=0.05"), 
              "fig6a u=0.15" :> ($CellContext`a11$$ = 1; $CellContext`a12$$ = 
                0; $CellContext`a21$$ = 1.15; $CellContext`a22$$ = 
                0.15; $CellContext`update$$ = 13000; $CellContext`gameName$$ = 
                "Prisoner's Dilemma"; $CellContext`updateRule$$ = 
                "Imitative pairwise difference"; $CellContext`k$$ = 
                8; $CellContext`initxA$$ = 0.01; $CellContext`initqAA$$ = 
                0.7; $CellContext`showMD$$ = True; $CellContext`preset$$ = 
                "Fu et al 2010 fig6a u=0.15"), Delimiter, 
              "fig6c v=0.5" :> ($CellContext`a11$$ = 1; $CellContext`a12$$ = 
                0.5; $CellContext`a21$$ = 1.5; $CellContext`a22$$ = 
                0; $CellContext`update$$ = 14000; $CellContext`gameName$$ = 
                "Snowdrift"; $CellContext`updateRule$$ = 
                "Imitative pairwise difference"; $CellContext`k$$ = 
                8; $CellContext`initxA$$ = 0.01; $CellContext`initqAA$$ = 
                0.7; $CellContext`showMD$$ = True; $CellContext`preset$$ = 
                "Fu et al 2010 fig6c v=0.5"), 
              "fig6c v=1" :> ($CellContext`a11$$ = 1; $CellContext`a12$$ = 
                0; $CellContext`a21$$ = 2; $CellContext`a22$$ = 
                0; $CellContext`update$$ = 15000; $CellContext`gameName$$ = 
                "Snowdrift"; $CellContext`updateRule$$ = 
                "Imitative pairwise difference"; $CellContext`k$$ = 
                8; $CellContext`initxA$$ = 0.01; $CellContext`initqAA$$ = 
                0.7; $CellContext`showMD$$ = True; $CellContext`preset$$ = 
                "Fu et al 2010 fig6c v=1")}}, Appearance -> "PopupMenu", 
           ImageSize -> {220, 20}]}, ImageSize -> 220, Alignment -> Center], 
        Delimiter, 
        Style[
        "Payoffs (\!\(\*SubscriptBox[\(\[CapitalPi]\), \(ij\)]\))", Bold, 
         Medium], 
        Row[{
          ActionMenu[
           Dynamic[$CellContext`gameName$$], {
           "Snowdrift" :> {$CellContext`a11$$ = 3, $CellContext`a12$$ = 
              1, $CellContext`a21$$ = 4, $CellContext`a22$$ = 
              0, $CellContext`update$$ = 500; $CellContext`gameName$$ = 
               "Snowdrift", $CellContext`preset$$ = "Presets"}, 
            "Prisoner's Dilemma" :> {$CellContext`a11$$ = 
              3, $CellContext`a12$$ = 0, $CellContext`a21$$ = 
              4, $CellContext`a22$$ = 
              1, $CellContext`update$$ = 1000; $CellContext`gameName$$ = 
               "Prisoner's Dilemma", $CellContext`preset$$ = "Presets"}, 
            "Coordination" :> {$CellContext`a11$$ = 2, $CellContext`a12$$ = 
              0, $CellContext`a21$$ = 0, $CellContext`a22$$ = 
              1, $CellContext`update$$ = 2000; $CellContext`gameName$$ = 
               "Coordination", $CellContext`preset$$ = "Presets"}, 
            "All 0s" :> {$CellContext`a11$$ = 0, $CellContext`a12$$ = 
              0, $CellContext`a21$$ = 0, $CellContext`a22$$ = 
              0, $CellContext`update$$ = 3000; $CellContext`gameName$$ = 
               "All 0s", $CellContext`preset$$ = "Presets"}}, Appearance -> 
           "PopupMenu", ImageSize -> {150, 20}]}, ImageSize -> 180, Alignment -> 
         Center], {{$CellContext`a11$$, 1, 
          "\!\(\*SubscriptBox[\(\[CapitalPi]\), \
\(\(A\)\(\[CenterDot]\)\)]\)"}, 
         Dynamic[InputField[
           
           Dynamic[$CellContext`a11$$, ($CellContext`a11$$ = \
$CellContext`ForceNumber[#])& ], Number, FieldSize -> 4]& ], ControlPlacement -> 
         1}, {{$CellContext`a12$$, 0.8, ""}, 
         Dynamic[InputField[
           
           Dynamic[$CellContext`a12$$, ($CellContext`a12$$ = \
$CellContext`ForceNumber[#])& ], Number, FieldSize -> 4]& ], ControlPlacement -> 
         2}, {{$CellContext`a21$$, 1.2, 
          "\!\(\*SubscriptBox[\(\[CapitalPi]\), \
\(\(B\)\(\[CenterDot]\)\)]\)"}, 
         Dynamic[InputField[
           
           Dynamic[$CellContext`a21$$, ($CellContext`a21$$ = \
$CellContext`ForceNumber[#])& ], Number, FieldSize -> 4]& ], ControlPlacement -> 
         3}, {{$CellContext`a22$$, 0, ""}, 
         Dynamic[InputField[
           
           Dynamic[$CellContext`a22$$, ($CellContext`a22$$ = \
$CellContext`ForceNumber[#])& ], Number, FieldSize -> 4]& ], ControlPlacement -> 
         4}, 
        Grid[{{"              ", 
           Manipulate`Place[1], 
           Manipulate`Place[2]}, {"", 
           Manipulate`Place[3], 
           Manipulate`Place[4]}}, Alignment -> Right], 
        Button[
        "Update", 
         Increment[$CellContext`update$$]; $CellContext`gameName$$ = 
          "Predefined games"; $CellContext`preset$$ = "Presets", ImageSize -> 
         180], Delimiter, 
        Style[
        "Degree of regular network", Bold, 
         Medium], {{$CellContext`k$$, 8, 
          "\!\(\*StyleBox[\"k\",FontSlant->\"Italic\"]\)"}, 2, 10, 1, 
         ImageSize -> Small, Appearance -> "Labeled"}, 
        Delimiter, {{$CellContext`updateRule$$, 
          "Imitative pairwise difference", ""}, {
         "Imitative pairwise difference", "Imitate if better, all nbrs", 
          "Fermi (set intensity \
\!\(\*StyleBox[\"m\",FontSlant->\"Italic\"]\))", "Best neighbor"}, 
         ControlType -> PopupMenu, MenuStyle -> 12, ControlPlacement -> 5}, 
        Grid[{{
           Style["Decision rule", Bold, Medium]}, {
           Manipulate`Place[5]}}, Alignment -> 
         Left], {{$CellContext`m$$, 1, 
          "Fermi's \!\(\*StyleBox[\"m\",FontSlant->\"Italic\"]\)"}, 0.5, 40, 
         0.01, ImageSize -> Small, Appearance -> "Labeled"}, Delimiter, 
        Style[
        "Initial conditions", Bold, 
         Medium], {{$CellContext`initxA$$, 0.5, 
          "\!\(\*SubscriptBox[StyleBox[\"x\",FontSlant->\"Italic\"], \"A\"]\)\
\!\(\*StyleBox[\"(\",FontWeight->\"Plain\"]\)\!\(\*StyleBox[\"0\",FontWeight->\
\"Plain\"]\)\!\(\*StyleBox[\")\",FontWeight->\"Plain\"]\)"}, 0.01, 0.99, 0.01,
          ImageSize -> Small, Appearance -> 
         "Labeled"}, {{$CellContext`initqAA$$, 0.5, 
          "\!\(\*SubscriptBox[StyleBox[\"q\",FontSlant->\"Italic\"], \
\"AA\"]\)\!\(\*StyleBox[\"(\",FontWeight->\"Plain\"]\)\!\(\*StyleBox[\"0\",\
FontWeight->\"Plain\"]\)\!\(\*StyleBox[\")\",FontWeight->\"Plain\"]\)"}, 0.01,
          0.99, 0.01, ImageSize -> Small, Appearance -> "Labeled"}, Delimiter, 
        Style[
        "Mean Dynamic (MD)", Bold, 
         Medium], {{$CellContext`showMD$$, True, "Show MD"}, {True, False}, 
         ImageSize -> Small, Appearance -> "Labeled"}, Delimiter, 
        Style[
        "Time allowed for computations", Bold, 
         Medium], {{$CellContext`maxTimeOut$$, 1, "maxTimeOut (s)"}, 1, 20, 1,
          ImageSize -> Small, Appearance -> "Labeled"}}, 
      "Options" :> {
       TrackedSymbols :> {$CellContext`update$$, $CellContext`updateRule$$, \
$CellContext`k$$, $CellContext`m$$, $CellContext`initxA$$, \
$CellContext`initqAA$$, $CellContext`showMD$$, $CellContext`maxTimeOut$$}, 
        Alignment -> Top, ControlPlacement -> Left, SynchronousUpdating -> 
        False, ContinuousAction -> True, AppearanceElements -> None}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{1200., {302., 310.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    Initialization:>({$CellContext`maxTime = 100000, $CellContext`limitingxPA = 
       0.00004, $CellContext`actualFinalTimePA = 
       28.46700861526154125603096953901397327145`20., \
$CellContext`actualFinalTimeMD = 24.513267934585173`, $CellContext`PB[
         Pattern[$CellContext`kA, 
          Blank[]], 
         Pattern[$CellContext`k, 
          Blank[]], 
         Pattern[$CellContext`qAB, 
          Blank[]]] := 
       Binomial[$CellContext`k, $CellContext`kA] \
$CellContext`qAB^$CellContext`kA (
          
          1 - $CellContext`qAB)^($CellContext`k - $CellContext`kA), \
$CellContext`FB[
         Pattern[$CellContext`kA$, 
          Blank[]], 
         Pattern[$CellContext`k$, 
          Blank[]], 
         Pattern[$CellContext`maxDiff$, 
          Blank[]], 
         Pattern[$CellContext`m$, 
          Blank[]], 
         Pattern[$CellContext`payoffs$, 
          Blank[]], 
         Pattern[$CellContext`qAA$, 
          Blank[]], 
         Pattern[$CellContext`qAB$, 
          Blank[]]] := 
       Module[{$CellContext`\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$, \
$CellContext`\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$}, {$CellContext`\
\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$, $CellContext`\[CapitalPi]BA$, \
$CellContext`\[CapitalPi]BB$} = $CellContext`payoffs$; 
         Switch[FE`updateRule$$728, 
           "Imitate if better, all nbrs", ($CellContext`kA$/$CellContext`k$) 
           Sum[
             Piecewise[{{
                $CellContext`PAOneB[$CellContext`i, $CellContext`k$, \
$CellContext`qAA$], $CellContext`\[CapitalPi]A[$CellContext`i, \
$CellContext`k$, $CellContext`\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$] > \
$CellContext`\[CapitalPi]B[$CellContext`kA$, $CellContext`k$, $CellContext`\
\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$]}}, 0], {$CellContext`i, 
              0, $CellContext`k$ - 1}], 
           "Fermi (set intensity \
\!\(\*StyleBox[\"m\",FontSlant->\"Italic\"]\))", \
($CellContext`kA$/$CellContext`k$) 
           Sum[$CellContext`PAOneB[$CellContext`i, $CellContext`k$, \
$CellContext`qAA$] (
              Exp[$CellContext`m$ $CellContext`\[CapitalPi]A[$CellContext`i, \
$CellContext`k$, $CellContext`\[CapitalPi]AA$, \
$CellContext`\[CapitalPi]AB$]]/(
              Exp[$CellContext`m$ \
$CellContext`\[CapitalPi]B[$CellContext`kA$, $CellContext`k$, $CellContext`\
\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$]] + 
              Exp[$CellContext`m$ $CellContext`\[CapitalPi]A[$CellContext`i, \
$CellContext`k$, $CellContext`\[CapitalPi]AA$, \
$CellContext`\[CapitalPi]AB$]])), {$CellContext`i, 0, $CellContext`k$ - 1}], 
           "Imitative pairwise difference", ($CellContext`kA$/$CellContext`k$)
             Sum[$CellContext`PAOneB[$CellContext`i, $CellContext`k$, \
$CellContext`qAA$] \
($CellContext`BePositive[$CellContext`\[CapitalPi]A[$CellContext`i, \
$CellContext`k$, $CellContext`\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$] - \
$CellContext`\[CapitalPi]B[$CellContext`kA$, $CellContext`k$, $CellContext`\
\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$]]/$CellContext`maxDiff$), \
{$CellContext`i, 0, $CellContext`k$ - 1}], "Best neighbor", 
           Switch[$CellContext`kA$, 0, 0, $CellContext`k$, 
            Sum[
             Piecewise[{{
                $CellContext`ProbabilityBestPayoffAmongANbrsBOneA[
                 $CellContext`\[CapitalPi]A[$CellContext`i, $CellContext`k$, \
$CellContext`\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$], \
$CellContext`kA$, $CellContext`k$, $CellContext`payoffs$, $CellContext`qAA$], \
$CellContext`\[CapitalPi]A[$CellContext`i, $CellContext`k$, $CellContext`\
\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$] > \
$CellContext`\[CapitalPi]B[$CellContext`kA$, $CellContext`k$, $CellContext`\
\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$]}}, 0], {$CellContext`i, 
              0, $CellContext`k$ - 1}], 
            Blank[], 
            Sum[
             Piecewise[{{$CellContext`ProbabilityBestPayoffAmongANbrsBOneA[
                  $CellContext`\[CapitalPi]A[$CellContext`i, $CellContext`k$, \
$CellContext`\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$], \
$CellContext`kA$, $CellContext`k$, $CellContext`payoffs$, $CellContext`qAA$] \
$CellContext`StrictCumulativeProbabilityBestPayoffAmongBNbrsBOneB[
                  $CellContext`\[CapitalPi]A[$CellContext`i, $CellContext`k$, \
$CellContext`\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$], \
$CellContext`kA$, $CellContext`k$, $CellContext`payoffs$, $CellContext`qAB$], \
$CellContext`\[CapitalPi]A[$CellContext`i, $CellContext`k$, $CellContext`\
\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$] > \
$CellContext`\[CapitalPi]B[$CellContext`kA$, $CellContext`k$, $CellContext`\
\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$]}}, 0], {$CellContext`i, 
              0, $CellContext`k$ - 1}]]]], 
       Attributes[$CellContext`kA$] = {Temporary}, 
       Attributes[$CellContext`k$] = {Temporary}, 
       Attributes[$CellContext`maxDiff$] = {Temporary}, 
       Attributes[$CellContext`m$] = {Temporary}, 
       Attributes[$CellContext`payoffs$] = {Temporary}, 
       Attributes[$CellContext`qAA$] = {Temporary}, 
       Attributes[$CellContext`qAB$] = {Temporary}, 
       Attributes[$CellContext`\[CapitalPi]AA$] = {Temporary}, 
       Attributes[$CellContext`\[CapitalPi]AB$] = {Temporary}, 
       Attributes[$CellContext`\[CapitalPi]BA$] = {Temporary}, 
       Attributes[$CellContext`\[CapitalPi]BB$] = {
        Temporary}, $CellContext`PAOneB[
         Pattern[$CellContext`kA, 
          Blank[]], 
         Pattern[$CellContext`k, 
          Blank[]], 
         Pattern[$CellContext`qAA, 
          Blank[]]] := 
       Binomial[$CellContext`k - 
          1, $CellContext`kA] $CellContext`qAA^$CellContext`kA (
          1 - $CellContext`qAA)^($CellContext`k - 
          1 - $CellContext`kA), $CellContext`\[CapitalPi]A[
         Pattern[$CellContext`x, 
          Blank[]], 
         Pattern[$CellContext`\[CapitalPi]AA, 
          Blank[]], 
         Pattern[$CellContext`\[CapitalPi]AB, 
          Blank[]]] := $CellContext`x $CellContext`\[CapitalPi]AA + (
          1 - $CellContext`x) $CellContext`\[CapitalPi]AB, $CellContext`\
\[CapitalPi]A[
         Pattern[$CellContext`kA, 
          Blank[]], 
         Pattern[$CellContext`k, 
          Blank[]], 
         Pattern[$CellContext`\[CapitalPi]AA, 
          Blank[]], 
         Pattern[$CellContext`\[CapitalPi]AB, 
          
          Blank[]]] := ($CellContext`kA $CellContext`\[CapitalPi]AA + \
($CellContext`k - $CellContext`kA) \
$CellContext`\[CapitalPi]AB)/$CellContext`k, $CellContext`x = 
       1, $CellContext`\[CapitalPi]B[
         Pattern[$CellContext`x, 
          Blank[]], 
         Pattern[$CellContext`\[CapitalPi]BA, 
          Blank[]], 
         Pattern[$CellContext`\[CapitalPi]BB, 
          Blank[]]] := $CellContext`x $CellContext`\[CapitalPi]BA + (
          1 - $CellContext`x) $CellContext`\[CapitalPi]BB, $CellContext`\
\[CapitalPi]B[
         Pattern[$CellContext`kA, 
          Blank[]], 
         Pattern[$CellContext`k, 
          Blank[]], 
         Pattern[$CellContext`\[CapitalPi]BA, 
          Blank[]], 
         Pattern[$CellContext`\[CapitalPi]BB, 
          
          Blank[]]] := ($CellContext`kA $CellContext`\[CapitalPi]BA + \
($CellContext`k - $CellContext`kA) \
$CellContext`\[CapitalPi]BB)/$CellContext`k, $CellContext`BePositive[
         Pattern[$CellContext`x, 
          Blank[]]] := 
       Piecewise[{{
          0, $CellContext`x < 0}, {$CellContext`x, $CellContext`x >= 
           0}}], $CellContext`ProbabilityBestPayoffAmongANbrsBOneA[
         Pattern[$CellContext`x, 
          Blank[]], 
         Pattern[$CellContext`kA, 
          Blank[]], 
         Pattern[$CellContext`k, 
          Blank[]], 
         Pattern[$CellContext`payoffs, 
          Blank[]], 
         Pattern[$CellContext`qAA, 
          
          Blank[]]] := \
$CellContext`CumulativeProbabilityBestPayoffAmongANbrsBOneA[$CellContext`x, \
$CellContext`kA, $CellContext`k, $CellContext`payoffs, $CellContext`qAA] - \
$CellContext`StrictCumulativeProbabilityBestPayoffAmongANbrsBOneA[$\
CellContext`x, $CellContext`kA, $CellContext`k, $CellContext`payoffs, \
$CellContext`qAA], $CellContext`CumulativeProbabilityBestPayoffAmongANbrsBOneA[
         Pattern[$CellContext`x, 
          Blank[]], 
         Pattern[$CellContext`kA, 
          Blank[]], 
         Pattern[$CellContext`k, 
          Blank[]], 
         Pattern[$CellContext`payoffs, 
          Blank[]], 
         Pattern[$CellContext`qAA, 
          Blank[]]] := 
       Module[{$CellContext`\[CapitalPi]AA, $CellContext`\[CapitalPi]AB, \
$CellContext`\[CapitalPi]BA, $CellContext`\[CapitalPi]BB}, {$CellContext`\
\[CapitalPi]AA, $CellContext`\[CapitalPi]AB, $CellContext`\[CapitalPi]BA, \
$CellContext`\[CapitalPi]BB} = $CellContext`payoffs; Sum[
            Piecewise[{{
               $CellContext`PAOneB[$CellContext`i, $CellContext`k, \
$CellContext`qAA], $CellContext`\[CapitalPi]A[$CellContext`i, $CellContext`k, \
$CellContext`\[CapitalPi]AA, $CellContext`\[CapitalPi]AB] <= $CellContext`x}},
              0], {$CellContext`i, 0, $CellContext`k - 
             1}]^$CellContext`kA], \
$CellContext`StrictCumulativeProbabilityBestPayoffAmongANbrsBOneA[
         Pattern[$CellContext`x, 
          Blank[]], 
         Pattern[$CellContext`kA, 
          Blank[]], 
         Pattern[$CellContext`k, 
          Blank[]], 
         Pattern[$CellContext`payoffs, 
          Blank[]], 
         Pattern[$CellContext`qAA, 
          Blank[]]] := 
       Module[{$CellContext`\[CapitalPi]AA, $CellContext`\[CapitalPi]AB, \
$CellContext`\[CapitalPi]BA, $CellContext`\[CapitalPi]BB}, {$CellContext`\
\[CapitalPi]AA, $CellContext`\[CapitalPi]AB, $CellContext`\[CapitalPi]BA, \
$CellContext`\[CapitalPi]BB} = $CellContext`payoffs; Sum[
            Piecewise[{{
               $CellContext`PAOneB[$CellContext`i, $CellContext`k, \
$CellContext`qAA], $CellContext`\[CapitalPi]A[$CellContext`i, $CellContext`k, \
$CellContext`\[CapitalPi]AA, $CellContext`\[CapitalPi]AB] < $CellContext`x}}, 
             0], {$CellContext`i, 0, $CellContext`k - 
             1}]^$CellContext`kA], \
$CellContext`StrictCumulativeProbabilityBestPayoffAmongBNbrsBOneB[
         Pattern[$CellContext`x, 
          Blank[]], 
         Pattern[$CellContext`kA, 
          Blank[]], 
         Pattern[$CellContext`k, 
          Blank[]], 
         Pattern[$CellContext`payoffs, 
          Blank[]], 
         Pattern[$CellContext`qAB, 
          Blank[]]] := 
       Module[{$CellContext`\[CapitalPi]AA, $CellContext`\[CapitalPi]AB, \
$CellContext`\[CapitalPi]BA, $CellContext`\[CapitalPi]BB}, {$CellContext`\
\[CapitalPi]AA, $CellContext`\[CapitalPi]AB, $CellContext`\[CapitalPi]BA, \
$CellContext`\[CapitalPi]BB} = $CellContext`payoffs; Sum[
            Piecewise[{{
               $CellContext`PBOneB[$CellContext`i, $CellContext`k, \
$CellContext`qAB], $CellContext`\[CapitalPi]B[$CellContext`i, $CellContext`k, \
$CellContext`\[CapitalPi]BA, $CellContext`\[CapitalPi]BB] < $CellContext`x}}, 
             0], {$CellContext`i, 0, $CellContext`k - 
             1}]^($CellContext`k - $CellContext`kA)], $CellContext`PBOneB[
         Pattern[$CellContext`kA, 
          Blank[]], 
         Pattern[$CellContext`k, 
          Blank[]], 
         Pattern[$CellContext`qAB, 
          Blank[]]] := 
       Binomial[$CellContext`k - 
          1, $CellContext`kA] $CellContext`qAB^$CellContext`kA (
          1 - $CellContext`qAB)^($CellContext`k - 
          1 - $CellContext`kA), $CellContext`PA[
         Pattern[$CellContext`kA, 
          Blank[]], 
         Pattern[$CellContext`k, 
          Blank[]], 
         Pattern[$CellContext`qAA, 
          Blank[]]] := 
       Binomial[$CellContext`k, $CellContext`kA] \
$CellContext`qAA^$CellContext`kA (
          1 - $CellContext`qAA)^($CellContext`k - $CellContext`kA), \
$CellContext`FA[
         Pattern[$CellContext`kA$, 
          Blank[]], 
         Pattern[$CellContext`k$, 
          Blank[]], 
         Pattern[$CellContext`maxDiff$, 
          Blank[]], 
         Pattern[$CellContext`m$, 
          Blank[]], 
         Pattern[$CellContext`payoffs$, 
          Blank[]], 
         Pattern[$CellContext`qAA$, 
          Blank[]], 
         Pattern[$CellContext`qAB$, 
          Blank[]]] := 
       Module[{$CellContext`\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$, \
$CellContext`\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$}, {$CellContext`\
\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$, $CellContext`\[CapitalPi]BA$, \
$CellContext`\[CapitalPi]BB$} = $CellContext`payoffs$; 
         Switch[FE`updateRule$$728, 
           "Imitate if better, all nbrs", (($CellContext`k$ - \
$CellContext`kA$)/$CellContext`k$) Sum[
             Piecewise[{{
                $CellContext`PBOneA[$CellContext`i, $CellContext`k$, \
$CellContext`qAB$], $CellContext`\[CapitalPi]B[$CellContext`i, \
$CellContext`k$, $CellContext`\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$] > \
$CellContext`\[CapitalPi]A[$CellContext`kA$, $CellContext`k$, $CellContext`\
\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$]}}, 0], {$CellContext`i, 
              1, $CellContext`k$}], 
           "Fermi (set intensity \
\!\(\*StyleBox[\"m\",FontSlant->\"Italic\"]\))", (($CellContext`k$ - \
$CellContext`kA$)/$CellContext`k$) 
           Sum[$CellContext`PBOneA[$CellContext`i, $CellContext`k$, \
$CellContext`qAB$] (
              Exp[$CellContext`m$ $CellContext`\[CapitalPi]B[$CellContext`i, \
$CellContext`k$, $CellContext`\[CapitalPi]BA$, \
$CellContext`\[CapitalPi]BB$]]/(
              Exp[$CellContext`m$ \
$CellContext`\[CapitalPi]A[$CellContext`kA$, $CellContext`k$, $CellContext`\
\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$]] + 
              Exp[$CellContext`m$ $CellContext`\[CapitalPi]B[$CellContext`i, \
$CellContext`k$, $CellContext`\[CapitalPi]BA$, \
$CellContext`\[CapitalPi]BB$]])), {$CellContext`i, 1, $CellContext`k$}], 
           "Imitative pairwise difference", (($CellContext`k$ - \
$CellContext`kA$)/$CellContext`k$) 
           Sum[$CellContext`PBOneA[$CellContext`i, $CellContext`k$, \
$CellContext`qAB$] \
($CellContext`BePositive[$CellContext`\[CapitalPi]B[$CellContext`i, \
$CellContext`k$, $CellContext`\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$] - \
$CellContext`\[CapitalPi]A[$CellContext`kA$, $CellContext`k$, $CellContext`\
\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$]]/$CellContext`maxDiff$), \
{$CellContext`i, 1, $CellContext`k$}], "Best neighbor", 
           Switch[$CellContext`kA$, 0, 
            Sum[
             Piecewise[{{
                $CellContext`ProbabilityBestPayoffAmongBNbrsAOneB[
                 $CellContext`\[CapitalPi]B[$CellContext`i, $CellContext`k$, \
$CellContext`\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$], \
$CellContext`kA$, $CellContext`k$, $CellContext`payoffs$, $CellContext`qAB$], \
$CellContext`\[CapitalPi]B[$CellContext`i, $CellContext`k$, $CellContext`\
\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$] > \
$CellContext`\[CapitalPi]A[$CellContext`kA$, $CellContext`k$, $CellContext`\
\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$]}}, 0], {$CellContext`i, 
              1, $CellContext`k$}], $CellContext`k$, 0, 
            Blank[], 
            Sum[
             Piecewise[{{$CellContext`ProbabilityBestPayoffAmongBNbrsAOneB[
                  $CellContext`\[CapitalPi]B[$CellContext`i, $CellContext`k$, \
$CellContext`\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$], \
$CellContext`kA$, $CellContext`k$, $CellContext`payoffs$, $CellContext`qAB$] \
$CellContext`StrictCumulativeProbabilityBestPayoffAmongANbrsAOneA[
                  $CellContext`\[CapitalPi]B[$CellContext`i, $CellContext`k$, \
$CellContext`\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$], \
$CellContext`kA$, $CellContext`k$, $CellContext`payoffs$, $CellContext`qAA$], \
$CellContext`\[CapitalPi]B[$CellContext`i, $CellContext`k$, $CellContext`\
\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$] > \
$CellContext`\[CapitalPi]A[$CellContext`kA$, $CellContext`k$, $CellContext`\
\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$]}}, 0], {$CellContext`i, 
              1, $CellContext`k$}]]]], $CellContext`PBOneA[
         Pattern[$CellContext`kA, 
          Blank[]], 
         Pattern[$CellContext`k, 
          Blank[]], 
         Pattern[$CellContext`qAB, 
          Blank[]]] := 
       Binomial[$CellContext`k - 1, $CellContext`kA - 
          1] $CellContext`qAB^($CellContext`kA - 1) (
          1 - $CellContext`qAB)^($CellContext`k - $CellContext`kA), \
$CellContext`ProbabilityBestPayoffAmongBNbrsAOneB[
         Pattern[$CellContext`x, 
          Blank[]], 
         Pattern[$CellContext`kA, 
          Blank[]], 
         Pattern[$CellContext`k, 
          Blank[]], 
         Pattern[$CellContext`payoffs, 
          Blank[]], 
         Pattern[$CellContext`qAB, 
          
          Blank[]]] := \
$CellContext`CumulativeProbabilityBestPayoffAmongBNbrsAOneB[$CellContext`x, \
$CellContext`kA, $CellContext`k, $CellContext`payoffs, $CellContext`qAB] - \
$CellContext`StrictCumulativeProbabilityBestPayoffAmongBNbrsAOneB[$\
CellContext`x, $CellContext`kA, $CellContext`k, $CellContext`payoffs, \
$CellContext`qAB], $CellContext`CumulativeProbabilityBestPayoffAmongBNbrsAOneB[
         Pattern[$CellContext`x, 
          Blank[]], 
         Pattern[$CellContext`kA, 
          Blank[]], 
         Pattern[$CellContext`k, 
          Blank[]], 
         Pattern[$CellContext`payoffs, 
          Blank[]], 
         Pattern[$CellContext`qAB, 
          Blank[]]] := 
       Module[{$CellContext`\[CapitalPi]AA, $CellContext`\[CapitalPi]AB, \
$CellContext`\[CapitalPi]BA, $CellContext`\[CapitalPi]BB}, {$CellContext`\
\[CapitalPi]AA, $CellContext`\[CapitalPi]AB, $CellContext`\[CapitalPi]BA, \
$CellContext`\[CapitalPi]BB} = $CellContext`payoffs; Sum[
            Piecewise[{{
               $CellContext`PBOneA[$CellContext`i, $CellContext`k, \
$CellContext`qAB], $CellContext`\[CapitalPi]B[$CellContext`i, $CellContext`k, \
$CellContext`\[CapitalPi]BA, $CellContext`\[CapitalPi]BB] <= $CellContext`x}},
              0], {$CellContext`i, 
             1, $CellContext`k}]^($CellContext`k - $CellContext`kA)], \
$CellContext`StrictCumulativeProbabilityBestPayoffAmongBNbrsAOneB[
         Pattern[$CellContext`x, 
          Blank[]], 
         Pattern[$CellContext`kA, 
          Blank[]], 
         Pattern[$CellContext`k, 
          Blank[]], 
         Pattern[$CellContext`payoffs, 
          Blank[]], 
         Pattern[$CellContext`qAB, 
          Blank[]]] := 
       Module[{$CellContext`\[CapitalPi]AA, $CellContext`\[CapitalPi]AB, \
$CellContext`\[CapitalPi]BA, $CellContext`\[CapitalPi]BB}, {$CellContext`\
\[CapitalPi]AA, $CellContext`\[CapitalPi]AB, $CellContext`\[CapitalPi]BA, \
$CellContext`\[CapitalPi]BB} = $CellContext`payoffs; Sum[
            Piecewise[{{
               $CellContext`PBOneA[$CellContext`i, $CellContext`k, \
$CellContext`qAB], $CellContext`\[CapitalPi]B[$CellContext`i, $CellContext`k, \
$CellContext`\[CapitalPi]BA, $CellContext`\[CapitalPi]BB] < $CellContext`x}}, 
             0], {$CellContext`i, 
             1, $CellContext`k}]^($CellContext`k - $CellContext`kA)], \
$CellContext`StrictCumulativeProbabilityBestPayoffAmongANbrsAOneA[
         Pattern[$CellContext`x, 
          Blank[]], 
         Pattern[$CellContext`kA, 
          Blank[]], 
         Pattern[$CellContext`k, 
          Blank[]], 
         Pattern[$CellContext`payoffs, 
          Blank[]], 
         Pattern[$CellContext`qAA, 
          Blank[]]] := 
       Module[{$CellContext`\[CapitalPi]AA, $CellContext`\[CapitalPi]AB, \
$CellContext`\[CapitalPi]BA, $CellContext`\[CapitalPi]BB}, {$CellContext`\
\[CapitalPi]AA, $CellContext`\[CapitalPi]AB, $CellContext`\[CapitalPi]BA, \
$CellContext`\[CapitalPi]BB} = $CellContext`payoffs; Sum[
            Piecewise[{{
               $CellContext`PAOneA[$CellContext`i, $CellContext`k, \
$CellContext`qAA], $CellContext`\[CapitalPi]A[$CellContext`i, $CellContext`k, \
$CellContext`\[CapitalPi]AA, $CellContext`\[CapitalPi]AB] < $CellContext`x}}, 
             0], {$CellContext`i, 
             1, $CellContext`k}]^$CellContext`kA], $CellContext`PAOneA[
         Pattern[$CellContext`kA, 
          Blank[]], 
         Pattern[$CellContext`k, 
          Blank[]], 
         Pattern[$CellContext`qAA, 
          Blank[]]] := 
       Binomial[$CellContext`k - 1, $CellContext`kA - 
          1] $CellContext`qAA^($CellContext`kA - 1) (
          1 - $CellContext`qAA)^($CellContext`k - $CellContext`kA), \
$CellContext`pairApproximationSolution = {
         InterpolatingFunction[{{0, 100000.`20.}}, {
          5, 3, 1, {61}, {4}, 0, 0, 0, 0, Automatic, {}, {}, False}, {{
           0, 0.06291884849242601440151018165750686831`20., 
            0.28517342329763183308170209765770704183`20., 
            0.71042542399232168434380799973490405732`20., 
            1.69400944979065036372316396280613471331`20., 
            2.9578812175551519703150047828700274483`20., 
            4.53165078816801558813796580873436582458`20., 
            6.37302333974794312530886488262590298438`20., 
            8.22719997731720884729859773321430697652`20., 
            10.95666545304571089872401166474413213312`20., 
            12.8428541225254549472436899452510507711`20., 
            14.4227854059325747205832073207103319228`20., 
            16.00271668933969449392272469616961307449`20., 
            16.85368138054941807444936209038152735021`20., 
            17.70464607175914165497599948459344162594`20., 
            17.95238195977897730229316214635799139068`20., 
            18.20011784779881294961032480812254115541`20., 
            18.31644561605693796013193248583324680584`20., 
            18.43277338431506297065354016354395245626`20., 
            18.49344089488860914211300941234750532658`20., 
            18.49736190176996061402308072506091352938`20., 
            18.50128290865131208593315203777432173218`20., 
            18.51212543806517011169647648639349117885`20., 
            18.55042559489305671585123351127041129003`20., 
            18.5900173691697251285246931097984864252`20., 
            18.63261059191119518017299591730506340392`20., 
            18.70540527926706511313417014856499674581`20., 
            18.81492038662544606449827268185027019338`20., 
            19.02042459479357703398949801212729519124`20., 
            19.35166290058970238768429023450643004503`20., 
            19.68704529298545263557763095412829358533`20., 
            20.05831283588841776106803348849234553434`20., 
            20.40156812059977220155065522868128661141`20., 
            20.84185950877152206084581850166590426072`20., 
            21.39641320820216914129946259032439313077`20., 
            22.07668982758404739903163661313646956775`20., 
            22.9908204808709018403771268164024977697`20., 
            24.47518139603164355683434770312896114721`20., 
            24.90966444399972960919579804367817708603`20., 
            26.21614037726191989937114591482724646504`20., 
            29.03085744957376284104742661724765693038`20., 
            35.09498155278737942839117670264654580386`20., 
            48.15974088540928233014465541413723959375`20., 
            76.30691160852771174690746243834134424651`20., 
            136.94815264066387762034496329233023298009`20., 
            267.59574596688290663787975040723717087635`20., 
            528.89093261932096467294932463705104666887`20., 
            1051.48130592419708074308847309667879825391`20., 
            2096.66205253394931288336677001593430142398`20., 
            4187.02354575345377716392336385444530776413`20., 
            8367.74653219246270572503655153146732044443`20., 
            16729.19250507048056284726292688551134580503`20., 
            26729.19250507048056284726292688551134592258`20., 
            36729.19250507048056284726292688551134604013`20., 
            46729.19250507048056284726292688551134615768`20., 
            56729.19250507048056284726292688551134627523`20., 
            66729.19250507048056284726292688551134639278`20., 
            76729.19250507048056284726292688551134651033`20., 
            86729.19250507048056284726292688551134662788`20., 
            96729.19250507048056284726292688551134674543`20., 
            100000.`20.}}, {{
           0.5`20., 0.13262575106988768328808603371983264125`20.}, {
           0.50850680514735438065024681208459796801`20., 
            0.13763812397129955893712267846816185843`20.}, {
           0.54057448964647233875620362760670349184`20., 
            0.1496121622204842280577169550279873364`20.}, {
           0.6061993710423534268693280187174501802`20., 
            0.15630864285767710793938564074432042292`20.}, {
           0.75151246924453791549556371514689149839`20., 
            0.13326954957405472034531508693274077272`20.}, {
           0.88598375314349956639102979683986678549`20., 
            0.07881609055785505356492546739448971891`20.}, {
           0.96589445567927633494362994680845398795`20., 
            0.02837988192433677155654840812299609383`20.}, {
           0.99330798023871242970085881452309575231`20., 
            0.00619408848147922867982619055723628187`20.}, {
           0.99885272197825225704883008031591183777`20., 
            0.00111309916002658677137416468639243316`20.}, {
           0.99992477620413978414901441176694569885`20., 
            0.00008318970488455419854988326754495663`20.}, {
           0.99998989492759114520670021939516288289`20., 
            0.00001047743763767023648015754369940006`20.}, {
           0.99999798715109214315552447292802184361`20., 
            2.04559009844359870477810464126723`20.*^-6}, {
           1.00000122506736519255865983877661119139`20., 
            2.04558998721748181566583576398952`20.*^-6}, {
           1.00000296579678587102732636833122355715`20., 
            2.04559857077866940848443820053267`20.*^-6}, {
           1.0000073342412153084623731095180163016`20., 
            0.00001211645137996824107546249741985726`20.}, {
           1.00001198782628771789236119040922244085`20., 
            0.00002865614201810968254624445608121809`20.}, {
           1.00002554258664259179129301892658882149`20., 
            0.00010080320022267023591904911014591217`20.}, {
           1.00004379029293165343898472930951062334`20., 
            0.00023966003267306344285910362484001745`20.}, {
           1.00009668152832926178659620916400307833`20., 
            0.00082670801650994102725831176358199828`20.}, {
           1.00017622117082634403879521654313923675`20., 
            0.00199789785780580311431763964832898536`20.}, {
           1.00018429341873439914905308192596321677`20., 
            0.00212040211913911718200357609544018585`20.}, {
           1.00019285569116138213944961933773892731`20., 
            0.00224759714186569172001185388679005128`20.}, {
           1.00021916586889283975791927684815318788`20., 
            0.00260238146421258257050060731492523217`20.}, {
           1.00040156385403694420979466207405542687`20., 
            0.02226299322235858489410005309254709926`20.}, {
           1.00246596585484010379932490892932211537`20., 
            0.07220048517150739731735557168697453992`20.}, {
           1.00640566342458056896550035067811889288`20., 
            0.11297110241620357339811252736281070134`20.}, {
           1.01715043570899929258158044028182464625`20., 
            0.1812412948332845176616536888606611896`20.}, {
           1.04170655641483859100698556602249571929`20., 
            0.2609339588167689944722506132518076092`20.}, {
           1.10166617045520746897890144515745883534`20., 
            0.29992138187080390318722908433449267249`20.}, {
           1.18691526994266550739631267997183782995`20., 
            0.20239431112729971463608030491677096552`20.}, {
           1.2369910190501641068970950979974561545`20., 
            0.1034864934892886254570533609056749921`20.}, {
           1.26297078951895800810560602699617143794`20., 
            0.0440076871831145483544815098692698057`20.}, {
           1.27324075845642758788772172028466222292`20., 
            0.01912204922038779736448558125147164371`20.}, {
           1.27836816987281073236366486622206588797`20., 
            0.00640883629752050642730801279634121011`20.}, {
           1.28028909440633708431402516081098948486`20., 
            0.00159579556490866464688034123106850724`20.}, {
           1.28080773544323021294036572017182337992`20., 
            0.00029154171146507969272999823606755491`20.}, {
           1.28091048011773240553764826131152668043`20., 
            0.00003291093737831516568762759907627553`20.}, {
           1.2809204495857312266957914472411298914`20., 
            9.55460902321411776886737058832559`20.*^-6}, {
           1.28092263216733983578766260988084598103`20., 
            2.4234306157140268158911124032752`20.*^-6}, {
           1.2809235246006971662671743217887206816`20., 
            7.775599471826366080602468219369`20.*^-8}, {
           1.2809235557489585417367461602555938948`20., \
-3.40880484898052297826916674136077160802298875667`20.*^-10}, {
           1.28092355561413280727219153259467827976`20., \
-6.22006540982541838330418605432561361275338546`20.*^-13}, {
           1.28092355561388700916471187961047773321`20., \
-1.4953647419496980133467140580716280150991535`20.*^-15}, {
           1.28092355561388642037738333649022507291`20., \
-1.43571988782673334387489137352863068649288`20.*^-17}, {
           1.28092355561388641491851170757125701758`20., 0}, {
           1.28092355561388641491851170757125701758`20., 0}, {
           1.28092355561388641491851170757125701758`20., 0}, {
           1.28092355561388641491851170757125701758`20., 0}, {
           1.28092355561388641491851170757125701758`20., 0}, {
           1.28092355561388641491851170757125701758`20., 0}, {
           1.28092355561388641491851170757125701758`20., 0}, {
           1.28092355561388641491851170757125701758`20., 0}, {
           1.28092355561388641491851170757125701758`20., 0}, {
           1.28092355561388641491851170757125701758`20., 0}, {
           1.28092355561388641491851170757125701758`20., 0}, {
           1.28092355561388641491851170757125701758`20., 0}, {
           1.28092355561388641491851170757125701758`20., 0}, {
           1.28092355561388641491851170757125701758`20., 0}, {
           1.28092355561388641491851170757125701758`20., 0}, {
           1.28092355561388641491851170757125701758`20., 0}, {
           1.28092355561388641491851170757125701758`20., 0}}, {Automatic}], 
         InterpolatingFunction[{{0, 100000.`20.}}, {
          5, 3, 1, {61}, {4}, 0, 0, 0, 0, Automatic, {}, {}, False}, {{
           0, 0.06291884849242601440151018165750686831`20., 
            0.28517342329763183308170209765770704183`20., 
            0.71042542399232168434380799973490405732`20., 
            1.69400944979065036372316396280613471331`20., 
            2.9578812175551519703150047828700274483`20., 
            4.53165078816801558813796580873436582458`20., 
            6.37302333974794312530886488262590298438`20., 
            8.22719997731720884729859773321430697652`20., 
            10.95666545304571089872401166474413213312`20., 
            12.8428541225254549472436899452510507711`20., 
            14.4227854059325747205832073207103319228`20., 
            16.00271668933969449392272469616961307449`20., 
            16.85368138054941807444936209038152735021`20., 
            17.70464607175914165497599948459344162594`20., 
            17.95238195977897730229316214635799139068`20., 
            18.20011784779881294961032480812254115541`20., 
            18.31644561605693796013193248583324680584`20., 
            18.43277338431506297065354016354395245626`20., 
            18.49344089488860914211300941234750532658`20., 
            18.49736190176996061402308072506091352938`20., 
            18.50128290865131208593315203777432173218`20., 
            18.51212543806517011169647648639349117885`20., 
            18.55042559489305671585123351127041129003`20., 
            18.5900173691697251285246931097984864252`20., 
            18.63261059191119518017299591730506340392`20., 
            18.70540527926706511313417014856499674581`20., 
            18.81492038662544606449827268185027019338`20., 
            19.02042459479357703398949801212729519124`20., 
            19.35166290058970238768429023450643004503`20., 
            19.68704529298545263557763095412829358533`20., 
            20.05831283588841776106803348849234553434`20., 
            20.40156812059977220155065522868128661141`20., 
            20.84185950877152206084581850166590426072`20., 
            21.39641320820216914129946259032439313077`20., 
            22.07668982758404739903163661313646956775`20., 
            22.9908204808709018403771268164024977697`20., 
            24.47518139603164355683434770312896114721`20., 
            24.90966444399972960919579804367817708603`20., 
            26.21614037726191989937114591482724646504`20., 
            29.03085744957376284104742661724765693038`20., 
            35.09498155278737942839117670264654580386`20., 
            48.15974088540928233014465541413723959375`20., 
            76.30691160852771174690746243834134424651`20., 
            136.94815264066387762034496329233023298009`20., 
            267.59574596688290663787975040723717087635`20., 
            528.89093261932096467294932463705104666887`20., 
            1051.48130592419708074308847309667879825391`20., 
            2096.66205253394931288336677001593430142398`20., 
            4187.02354575345377716392336385444530776413`20., 
            8367.74653219246270572503655153146732044443`20., 
            16729.19250507048056284726292688551134580503`20., 
            26729.19250507048056284726292688551134592258`20., 
            36729.19250507048056284726292688551134604013`20., 
            46729.19250507048056284726292688551134615768`20., 
            56729.19250507048056284726292688551134627523`20., 
            66729.19250507048056284726292688551134639278`20., 
            76729.19250507048056284726292688551134651033`20., 
            86729.19250507048056284726292688551134662788`20., 
            96729.19250507048056284726292688551134674543`20., 
            100000.`20.}}, {{
           0.5`20., 0.34542300086535708480354313102347990608`20.}, {
           0.52105663251258842025359303700378626974`20., 
            0.32418518547039375133275368095266200741`20.}, {
           0.58582436894692140956039240989836687113`20., 
            0.2617109242793372066262508671333016582`20.}, {
           0.6789203285877402892597758618045895962`20., 
            0.18346387393153908012039111260138969418`20.}, {
           0.81260974106822858722061577493878837347`20., 
            0.1022271618470320150726950938924044926`20.}, {
           0.91043436912086152009716753550947236065`20., 
            0.05686944981788875939875303629120342103`20.}, {
           0.97061078498864447011810156883008335188`20., 
            0.02286280455094356400817611609100902505`20.}, {
           0.99376416621947169379544250466162160246`20., 
            0.00557876161215644809782023072211229784`20.}, {
           0.99888562232235765974002757630015134359`20., 
            0.00106582146406855085324930445243781315`20.}, {
           0.99991680403692710721390583491464871836`20., 
            0.00009641808043928308015468875424858197`20.}, {
           0.99998952245648612021234100330195568125`20., 
            0.00001105678910626455447446803148636718`20.}, {
           0.99999795440578408495731241095328997139`20., 0}, {
           0.99999795440578408495731241095328997139`20., 0}, {
           0.99999795440578408495731241095328997139`20., \
-3.13915565920323087409360418575943`20.*^-6}, {
           0.99998788354469181034334444886172541309`20., \
-0.00003608357665615838458933462007394155`20.}, {
           0.99997134330852185373095502456382918955`20., \
-0.00011708355295397441468013832732708579`20.}, {
           0.99989916902423880062472518315387851882`20., \
-0.000647468087838781118214387388931641`20.}, {
           0.99975997953363633424267792510531349904`20., \
-0.00209331842592693233209150127649422757`20.}, {
           0.99915925547515767501938668514332176462`20., \
-0.01138308721677564182847910978502170565`20.}, {
           0.99777057868422937524043780806060495942`20., \
-0.04332500126377217150542772716725892224`20.}, {
           0.99759117231715430774355993036131491916`20., \
-0.0483047834163973346444966028290224358`20.}, {
           0.99739070927651783329828525974815914695`20., \
-0.0540915645750606776439445289028640218`20.}, {
           0.99669460863868508389926061784523023925`20., \
-0.07603698185901412059158749334741855819`20.}, {
           0.98929881527915595794496431042739622014`20., \
-0.39793460767840345323467440841191944401`20.}, {
           0.97293558121245237042559069111852349071`20., \
-0.42024404891385109492078099432833699869`20.}, {
           0.95435109200451767722777918120735969154`20., \
-0.45238508463406763109067087353249955003`20.}, {
           0.91990239483926823843564599636437443283`20., \
-0.48854519207015130221552172198650912234`20.}, {
           0.86613822792111560813354276019964810801`20., \
-0.48235135496517704628108928393414485747`20.}, {
           0.77813265064651866996720534097620780108`20., \
-0.36252356959250305208838586842006905781`20.}, {
           0.69180325383983976721778693029561212055`20., \
-0.17491203020270720474292012992806687019`20.}, {
           0.65144481560921768378068628600236239058`20., \
-0.07818176720043409957873768531891677952`20.}, {
           0.63234781345229261069934838267818582457`20., \
-0.03156130199439431783812957610036722037`20.}, {
           0.62504305367675846069259901346257762582`20., \
-0.0134994770516571291662375250032185908`20.}, {
           0.62143455903577783244209094238390353649`20., \
-0.0044987219488529643715241254476060901`20.}, {
           0.62008739798951293979632033049051676549`20., \
-0.00111871205549688562449712534976469945`20.}, {
           0.61972397014906054731339269022157118453`20., \
-0.00020449731652303330630937689525413612`20.}, {
           0.61965190070814258317498388674247327231`20., \
-0.00002272090311049043955886630869375999`20.}, {
           0.61965739852146399479673753916844809652`20., \
-0.00008806673930577783605089269261393815`20.}, {
           0.61964414536490019427210944496541473577`20., \
-6.32443354344309222803113318094259`20.*^-6}, {
           0.61964281112578923606219390778839082484`20., \
-3.934029030975174010763398853393`20.*^-8}, {
           0.61964279161006895754367600071157444222`20., 
            2.775014131408339111260869473540925404600784958208`20.*^-10}, {
           0.61964279171042104852637541450835996277`20., 
            5.15254824327384708158299355156610286245653316`20.*^-13}, {
           0.61964279171060538003594678402305915959`20., 
            1.1068711784881485354241213494481349659651421`20.*^-15}, {
           0.61964279171060578308040823515793778437`20., 0}, {
           0.61964279171060578540222568088219322181`20., 0}, {
           0.61964279171060578540222568088219322181`20., 0}, {
           0.61964279171060578540222568088219322181`20., 0}, {
           0.61964279171060578540222568088219322181`20., 0}, {
           0.61964279171060578540222568088219322181`20., 0}, {
           0.61964279171060578540222568088219322181`20., 0}, {
           0.61964279171060578540222568088219322181`20., 0}, {
           0.61964279171060578540222568088219322181`20., 0}, {
           0.61964279171060578540222568088219322181`20., 0}, {
           0.61964279171060578540222568088219322181`20., 0}, {
           0.61964279171060578540222568088219322181`20., 0}, {
           0.61964279171060578540222568088219322181`20., 0}, {
           0.61964279171060578540222568088219322181`20., 0}, {
           0.61964279171060578540222568088219322181`20., 0}, {
           0.61964279171060578540222568088219322181`20., 0}, {
           0.61964279171060578540222568088219322181`20., 0}, {
           0.61964279171060578540222568088219322181`20., 0}}, {
          Automatic}]}, $CellContext`meanDynamicSolution = 
       InterpolatingFunction[{{0., 100000.}}, {
         5, 7, 1, {28}, {4}, 0, 0, 0, 0, Automatic, {}, {}, False}, {{0., 
         0.06298437517275594, 0.20071382930256787`, 0.6872294283517035, 
         1.8283085906197334`, 4.657393025178104, 7.3161175743236715`, 
         10.146084604561754`, 13.840410941555781`, 24.93645095074548, 
         48.842144468525476`, 100.345399872501, 211.30579996439798`, 
         450.3627351421977, 965.3952891819528, 2074.999290100922, 
         4294.207291938859, 8732.623295614736, 17609.455302966486`, 
         27609.455302966486`, 37609.45530296648, 47609.45530296648, 
         57609.45530296648, 67609.45530296648, 77609.45530296648, 
         87609.45530296648, 97609.45530296648, 100000.}}, {
         Developer`PackedArrayForm, {0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 
          22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 
          56}, CompressedData["
1:eJxTTMoPSmVkYGCwYICBB/bb/i3btPf/efu9Mg0pnxoe2LPqr3c99f28fUPn
RI71Mx/a99cubeNcd97e6vOTm91eT+1nm03ukmo4Y8/QqPrn6cTX9hOuLaw/
2rHP3tfrhuKvTe/tK08mVMkJN9tv7to0qe/Xe/vT+/+pMB5ytWdV/d267v97
+5medyJ941jsnwdM8/gH5L/WK6qYWbbaLjxRDeieD/bhHHoNqw2Y992VYgDz
JXWB1N2qvSwMED6EvrCHEcqH0Bv2/AeD9/YQer4NA1SeAQUMHz4AzZF5OA==

          "]}, {Automatic}], $CellContext`ExpectedChange[
         Pattern[$CellContext`maxDiff$, 
          Blank[]], 
         Pattern[$CellContext`mR$, 
          Blank[]], 
         Pattern[$CellContext`payoffs$, 
          Blank[]], 
         Pattern[$CellContext`\[Rho]A$, 
          Blank[]]] := 
       Module[{$CellContext`\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$, \
$CellContext`\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$, $CellContext`\
\[Rho]B$ = 
          1 - $CellContext`\[Rho]A$}, {$CellContext`\[CapitalPi]AA$, \
$CellContext`\[CapitalPi]AB$, $CellContext`\[CapitalPi]BA$, $CellContext`\
\[CapitalPi]BB$} = $CellContext`payoffs$; 
         Switch[FE`updateRule$$728, 
           "Imitate if better, all nbrs", $CellContext`\[Rho]B$ $CellContext`\
\[Rho]A$ Piecewise[{{
              1, $CellContext`\[CapitalPi]A[$CellContext`\[Rho]A$, \
$CellContext`\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$] > $CellContext`\
\[CapitalPi]B[$CellContext`\[Rho]A$, $CellContext`\[CapitalPi]BA$, \
$CellContext`\[CapitalPi]BB$]}, {-1, $CellContext`\[CapitalPi]A[$CellContext`\
\[Rho]A$, $CellContext`\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$] < \
$CellContext`\[CapitalPi]B[$CellContext`\[Rho]A$, \
$CellContext`\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$]}}, 0], 
           "Fermi (set intensity \
\!\(\*StyleBox[\"m\",FontSlant->\"Italic\"]\))", $CellContext`\[Rho]B$ \
$CellContext`\[Rho]A$ ((
             Exp[FE`m$$728 $CellContext`\[CapitalPi]A[$CellContext`\[Rho]A$, \
$CellContext`\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$]] - Exp[
             FE`m$$728 $CellContext`\[CapitalPi]B[$CellContext`\[Rho]A$, \
$CellContext`\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$]])/(
            Exp[FE`m$$728 $CellContext`\[CapitalPi]A[$CellContext`\[Rho]A$, \
$CellContext`\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$]] + 
            Exp[FE`m$$728 $CellContext`\[CapitalPi]B[$CellContext`\[Rho]A$, \
$CellContext`\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$]])), 
           "Imitative pairwise difference", $CellContext`\[Rho]B$ \
$CellContext`\[Rho]A$ (($CellContext`\[CapitalPi]A[$CellContext`\[Rho]A$, \
$CellContext`\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$] - $CellContext`\
\[CapitalPi]B[$CellContext`\[Rho]A$, $CellContext`\[CapitalPi]BA$, \
$CellContext`\[CapitalPi]BB$])/$CellContext`maxDiff$), 
           "Best neighbor", $CellContext`\[Rho]B$ Piecewise[{{
                $CellContext`BePositive[$CellContext`\[CapitalPi]A[$\
CellContext`\[Rho]A$, $CellContext`\[CapitalPi]AA$, \
$CellContext`\[CapitalPi]AB$] - \
$CellContext`\[CapitalPi]B[$CellContext`\[Rho]A$, \
$CellContext`\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$]], $CellContext`\
\[Rho]A$ > 0}}, 0] - $CellContext`\[Rho]A$ Piecewise[{{
               $CellContext`BePositive[$CellContext`\[CapitalPi]B[$\
CellContext`\[Rho]A$, $CellContext`\[CapitalPi]BA$, \
$CellContext`\[CapitalPi]BB$] - \
$CellContext`\[CapitalPi]A[$CellContext`\[Rho]A$, \
$CellContext`\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$]], $CellContext`\
\[Rho]B$ > 0}}, 0]]], $CellContext`ExpectedChange[
         Pattern[$CellContext`x, 
          Blank[]], 
         Pattern[$CellContext`A, 
          Blank[]], 
         Pattern[$CellContext`\[Alpha], 
          Blank[]], 
         Pattern[$CellContext`parameter, 
          Blank[]], 
         Pattern[$CellContext`m, 
          Blank[]], 
         Pattern[$CellContext`f, 
          Blank[]]] := (
          1 - $CellContext`m) $CellContext`f[$CellContext`x, $CellContext`A, \
$CellContext`\[Alpha], $CellContext`parameter] + $CellContext`m (
          ConstantArray[1/3, 3] - $CellContext`x), 
       Attributes[$CellContext`mR$] = {Temporary}, 
       Attributes[$CellContext`\[Rho]A$] = {Temporary}, 
       Attributes[$CellContext`\[Rho]B$] = {
        Temporary}, $CellContext`f = -1& , \
$CellContext`meanDynamicSolutionImitateIfBetterAllNbrs = 
       Function[{$CellContext`t$}, 
         Piecewise[{{
            Min[1/(2 ((1 - 1/2)/E^$CellContext`t$ + 1/2)), 
             If[
              And[
              0 < $CellContext`interiorEq$235587 < 1, 
               1/2 < $CellContext`interiorEq$235587], \
$CellContext`interiorEq$235587, 1]], $CellContext`\[CapitalPi]A[
             1/2, $CellContext`\[CapitalPi]AA$235587, $CellContext`\
\[CapitalPi]AB$235587] > $CellContext`\[CapitalPi]B[
             1/2, $CellContext`\[CapitalPi]BA$235587, $CellContext`\
\[CapitalPi]BB$235587]}, {
            Max[1/(2 (E^$CellContext`t$ (1 - 1/2) + 1/2)), 
             If[
              And[
              0 < $CellContext`interiorEq$235587 < 1, 
               1/2 > $CellContext`interiorEq$235587], \
$CellContext`interiorEq$235587, 0]], $CellContext`\[CapitalPi]A[
             1/2, $CellContext`\[CapitalPi]AA$235587, $CellContext`\
\[CapitalPi]AB$235587] < $CellContext`\[CapitalPi]B[
             1/2, $CellContext`\[CapitalPi]BA$235587, $CellContext`\
\[CapitalPi]BB$235587]}}, 1/2]], Attributes[$CellContext`t$] = {Temporary}, 
       Attributes[$CellContext`interiorEq$235587] = {
        Temporary}, $CellContext`interiorEq$235587 = 1/3, 
       Attributes[$CellContext`\[CapitalPi]AA$235587] = {
        Temporary}, $CellContext`\[CapitalPi]AA$235587 = 2, 
       Attributes[$CellContext`\[CapitalPi]AB$235587] = {
        Temporary}, $CellContext`\[CapitalPi]AB$235587 = 0, 
       Attributes[$CellContext`\[CapitalPi]BA$235587] = {
        Temporary}, $CellContext`\[CapitalPi]BA$235587 = 0, 
       Attributes[$CellContext`\[CapitalPi]BB$235587] = {
        Temporary}, $CellContext`\[CapitalPi]BB$235587 = 
       1, $CellContext`MDsolutionImitateIfBetterAllNbrs[
         Pattern[$CellContext`initialxA, 
          Blank[]], 
         Pattern[$CellContext`payoffs, 
          Blank[]]] := 
       Module[{$CellContext`\[CapitalPi]AA, $CellContext`\[CapitalPi]AB, \
$CellContext`\[CapitalPi]BA, $CellContext`\[CapitalPi]BB, \
$CellContext`interiorEq}, {$CellContext`\[CapitalPi]AA, $CellContext`\
\[CapitalPi]AB, $CellContext`\[CapitalPi]BA, $CellContext`\[CapitalPi]BB} = \
$CellContext`payoffs; $CellContext`interiorEq = 
          If[$CellContext`\[CapitalPi]AA - $CellContext`\[CapitalPi]AB - \
$CellContext`\[CapitalPi]BA + $CellContext`\[CapitalPi]BB == 
            0, -1, ($CellContext`\[CapitalPi]BB - \
$CellContext`\[CapitalPi]AB)/($CellContext`\[CapitalPi]AA - $CellContext`\
\[CapitalPi]AB - $CellContext`\[CapitalPi]BA + $CellContext`\[CapitalPi]BB)]; 
         Function[{$CellContext`t}, 
           Piecewise[{{
              
              Min[$CellContext`initialxA/((1 - $CellContext`initialxA)/
                E^$CellContext`t + $CellContext`initialxA), 
               If[
                And[
                0 < $CellContext`interiorEq < 
                 1, $CellContext`initialxA < $CellContext`interiorEq], \
$CellContext`interiorEq, 
                1]], $CellContext`\[CapitalPi]A[$CellContext`initialxA, \
$CellContext`\[CapitalPi]AA, $CellContext`\[CapitalPi]AB] > $CellContext`\
\[CapitalPi]B[$CellContext`initialxA, $CellContext`\[CapitalPi]BA, \
$CellContext`\[CapitalPi]BB]}, {
              Max[$CellContext`initialxA/(
               E^$CellContext`t (
                 1 - $CellContext`initialxA) + $CellContext`initialxA), 
               If[
                And[
                0 < $CellContext`interiorEq < 
                 1, $CellContext`initialxA > $CellContext`interiorEq], \
$CellContext`interiorEq, 
                0]], $CellContext`\[CapitalPi]A[$CellContext`initialxA, \
$CellContext`\[CapitalPi]AA, $CellContext`\[CapitalPi]AB] < $CellContext`\
\[CapitalPi]B[$CellContext`initialxA, $CellContext`\[CapitalPi]BA, \
$CellContext`\[CapitalPi]BB]}}, $CellContext`initialxA]]], \
$CellContext`actualFinalTime = 
       28.46700861526154125603096953901397327145`20., $CellContext`ForceNumber[
         Pattern[$CellContext`n, 
          Blank[]]] := If[
         NumberQ[$CellContext`n], $CellContext`n, 0], Off[
         MessageName[General, "munfl"]]; $CellContext`ForceNumber[
          Pattern[$CellContext`n, 
           Blank[]]] := If[
          NumberQ[$CellContext`n], $CellContext`n, 
          0]; $CellContext`\[CapitalPi]A[
          Pattern[$CellContext`x, 
           Blank[]], 
          Pattern[$CellContext`\[CapitalPi]AA, 
           Blank[]], 
          Pattern[$CellContext`\[CapitalPi]AB, 
           Blank[]]] := $CellContext`x $CellContext`\[CapitalPi]AA + (
           1 - $CellContext`x) $CellContext`\[CapitalPi]AB; $CellContext`\
\[CapitalPi]B[
          Pattern[$CellContext`x, 
           Blank[]], 
          Pattern[$CellContext`\[CapitalPi]BA, 
           Blank[]], 
          Pattern[$CellContext`\[CapitalPi]BB, 
           Blank[]]] := $CellContext`x $CellContext`\[CapitalPi]BA + (
           1 - $CellContext`x) $CellContext`\[CapitalPi]BB; $CellContext`\
\[CapitalPi]A[
          Pattern[$CellContext`kA, 
           Blank[]], 
          Pattern[$CellContext`k, 
           Blank[]], 
          Pattern[$CellContext`\[CapitalPi]AA, 
           Blank[]], 
          Pattern[$CellContext`\[CapitalPi]AB, 
           
           Blank[]]] := ($CellContext`kA $CellContext`\[CapitalPi]AA + \
($CellContext`k - $CellContext`kA) \
$CellContext`\[CapitalPi]AB)/$CellContext`k; $CellContext`\[CapitalPi]B[
          Pattern[$CellContext`kA, 
           Blank[]], 
          Pattern[$CellContext`k, 
           Blank[]], 
          Pattern[$CellContext`\[CapitalPi]BA, 
           Blank[]], 
          Pattern[$CellContext`\[CapitalPi]BB, 
           
           Blank[]]] := ($CellContext`kA $CellContext`\[CapitalPi]BA + \
($CellContext`k - $CellContext`kA) \
$CellContext`\[CapitalPi]BB)/$CellContext`k; $CellContext`ExpectedChange[
          Pattern[$CellContext`maxDiff$, 
           Blank[]], 
          Pattern[$CellContext`mR$, 
           Blank[]], 
          Pattern[$CellContext`payoffs$, 
           Blank[]], 
          Pattern[$CellContext`\[Rho]A$, 
           Blank[]]] := 
        Module[{$CellContext`\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$, \
$CellContext`\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$, $CellContext`\
\[Rho]B$ = 
           1 - $CellContext`\[Rho]A$}, {$CellContext`\[CapitalPi]AA$, \
$CellContext`\[CapitalPi]AB$, $CellContext`\[CapitalPi]BA$, $CellContext`\
\[CapitalPi]BB$} = $CellContext`payoffs$; 
          Switch[$CellContext`updateRule$$, 
            "Imitate if better, all nbrs", $CellContext`\[Rho]B$ \
$CellContext`\[Rho]A$ 
            Piecewise[{{
               1, $CellContext`\[CapitalPi]A[$CellContext`\[Rho]A$, \
$CellContext`\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$] > $CellContext`\
\[CapitalPi]B[$CellContext`\[Rho]A$, $CellContext`\[CapitalPi]BA$, \
$CellContext`\[CapitalPi]BB$]}, {-1, $CellContext`\[CapitalPi]A[$CellContext`\
\[Rho]A$, $CellContext`\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$] < \
$CellContext`\[CapitalPi]B[$CellContext`\[Rho]A$, \
$CellContext`\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$]}}, 0], 
            "Fermi (set intensity \!\(\*StyleBox[\"m\",FontSlant->\"Italic\"]\
\))", $CellContext`\[Rho]B$ $CellContext`\[Rho]A$ ((
              Exp[$CellContext`m$$ $CellContext`\[CapitalPi]A[$CellContext`\
\[Rho]A$, $CellContext`\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$]] - 
              
              Exp[$CellContext`m$$ $CellContext`\[CapitalPi]B[$CellContext`\
\[Rho]A$, $CellContext`\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$]])/(
             Exp[$CellContext`m$$ $CellContext`\[CapitalPi]A[$CellContext`\
\[Rho]A$, $CellContext`\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$]] + 
             Exp[$CellContext`m$$ $CellContext`\[CapitalPi]B[$CellContext`\
\[Rho]A$, $CellContext`\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$]])), 
            "Imitative pairwise difference", $CellContext`\[Rho]B$ \
$CellContext`\[Rho]A$ (($CellContext`\[CapitalPi]A[$CellContext`\[Rho]A$, \
$CellContext`\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$] - $CellContext`\
\[CapitalPi]B[$CellContext`\[Rho]A$, $CellContext`\[CapitalPi]BA$, \
$CellContext`\[CapitalPi]BB$])/$CellContext`maxDiff$), 
            "Best neighbor", $CellContext`\[Rho]B$ Piecewise[{{
                 $CellContext`BePositive[$CellContext`\[CapitalPi]A[$\
CellContext`\[Rho]A$, $CellContext`\[CapitalPi]AA$, \
$CellContext`\[CapitalPi]AB$] - \
$CellContext`\[CapitalPi]B[$CellContext`\[Rho]A$, \
$CellContext`\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$]], $CellContext`\
\[Rho]A$ > 0}}, 0] - $CellContext`\[Rho]A$ Piecewise[{{
                $CellContext`BePositive[$CellContext`\[CapitalPi]B[$\
CellContext`\[Rho]A$, $CellContext`\[CapitalPi]BA$, \
$CellContext`\[CapitalPi]BB$] - \
$CellContext`\[CapitalPi]A[$CellContext`\[Rho]A$, \
$CellContext`\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$]], $CellContext`\
\[Rho]B$ > 0}}, 0]]]; $CellContext`MDsolutionImitateIfBetterAllNbrs[
          Pattern[$CellContext`initialxA, 
           Blank[]], 
          Pattern[$CellContext`payoffs, 
           Blank[]]] := 
        Module[{$CellContext`\[CapitalPi]AA, $CellContext`\[CapitalPi]AB, \
$CellContext`\[CapitalPi]BA, $CellContext`\[CapitalPi]BB, \
$CellContext`interiorEq}, {$CellContext`\[CapitalPi]AA, $CellContext`\
\[CapitalPi]AB, $CellContext`\[CapitalPi]BA, $CellContext`\[CapitalPi]BB} = \
$CellContext`payoffs; $CellContext`interiorEq = 
           If[$CellContext`\[CapitalPi]AA - $CellContext`\[CapitalPi]AB - \
$CellContext`\[CapitalPi]BA + $CellContext`\[CapitalPi]BB == 
             0, -1, ($CellContext`\[CapitalPi]BB - \
$CellContext`\[CapitalPi]AB)/($CellContext`\[CapitalPi]AA - $CellContext`\
\[CapitalPi]AB - $CellContext`\[CapitalPi]BA + $CellContext`\[CapitalPi]BB)]; 
          Function[{$CellContext`t}, 
            Piecewise[{{
               
               Min[$CellContext`initialxA/(
                E^(-$CellContext`t) (
                  1 - $CellContext`initialxA) + $CellContext`initialxA), 
                If[
                 And[
                 0 < $CellContext`interiorEq < 
                  1, $CellContext`initialxA < $CellContext`interiorEq], \
$CellContext`interiorEq, 
                 1]], $CellContext`\[CapitalPi]A[$CellContext`initialxA, \
$CellContext`\[CapitalPi]AA, $CellContext`\[CapitalPi]AB] > $CellContext`\
\[CapitalPi]B[$CellContext`initialxA, $CellContext`\[CapitalPi]BA, \
$CellContext`\[CapitalPi]BB]}, {
               
               Max[$CellContext`initialxA/(
                E^$CellContext`t (
                  1 - $CellContext`initialxA) + $CellContext`initialxA), 
                If[
                 And[
                 0 < $CellContext`interiorEq < 
                  1, $CellContext`initialxA > $CellContext`interiorEq], \
$CellContext`interiorEq, 
                 0]], $CellContext`\[CapitalPi]A[$CellContext`initialxA, \
$CellContext`\[CapitalPi]AA, $CellContext`\[CapitalPi]AB] < $CellContext`\
\[CapitalPi]B[$CellContext`initialxA, $CellContext`\[CapitalPi]BA, \
$CellContext`\[CapitalPi]BB]}}, $CellContext`initialxA]]]; $CellContext`PA[
          Pattern[$CellContext`kA, 
           Blank[]], 
          Pattern[$CellContext`k, 
           Blank[]], 
          Pattern[$CellContext`qAA, 
           Blank[]]] := 
        Binomial[$CellContext`k, $CellContext`kA] \
$CellContext`qAA^$CellContext`kA (
           1 - $CellContext`qAA)^($CellContext`k - $CellContext`kA); \
$CellContext`PB[
          Pattern[$CellContext`kA, 
           Blank[]], 
          Pattern[$CellContext`k, 
           Blank[]], 
          Pattern[$CellContext`qAB, 
           Blank[]]] := 
        Binomial[$CellContext`k, $CellContext`kA] \
$CellContext`qAB^$CellContext`kA (
           1 - $CellContext`qAB)^($CellContext`k - $CellContext`kA); \
$CellContext`PAOneB[
          Pattern[$CellContext`kA, 
           Blank[]], 
          Pattern[$CellContext`k, 
           Blank[]], 
          Pattern[$CellContext`qAA, 
           Blank[]]] := 
        Binomial[$CellContext`k - 
           1, $CellContext`kA] $CellContext`qAA^$CellContext`kA (
           1 - $CellContext`qAA)^($CellContext`k - 
           1 - $CellContext`kA); $CellContext`PBOneA[
          Pattern[$CellContext`kA, 
           Blank[]], 
          Pattern[$CellContext`k, 
           Blank[]], 
          Pattern[$CellContext`qAB, 
           Blank[]]] := 
        Binomial[$CellContext`k - 1, $CellContext`kA - 
           1] $CellContext`qAB^($CellContext`kA - 1) (
           1 - $CellContext`qAB)^($CellContext`k - $CellContext`kA); \
$CellContext`PAOneA[
          Pattern[$CellContext`kA, 
           Blank[]], 
          Pattern[$CellContext`k, 
           Blank[]], 
          Pattern[$CellContext`qAA, 
           Blank[]]] := 
        Binomial[$CellContext`k - 1, $CellContext`kA - 
           1] $CellContext`qAA^($CellContext`kA - 1) (
           1 - $CellContext`qAA)^($CellContext`k - $CellContext`kA); \
$CellContext`PBOneB[
          Pattern[$CellContext`kA, 
           Blank[]], 
          Pattern[$CellContext`k, 
           Blank[]], 
          Pattern[$CellContext`qAB, 
           Blank[]]] := 
        Binomial[$CellContext`k - 
           1, $CellContext`kA] $CellContext`qAB^$CellContext`kA (
           1 - $CellContext`qAB)^($CellContext`k - 
           1 - $CellContext`kA); $CellContext`FA[
          Pattern[$CellContext`kA$, 
           Blank[]], 
          Pattern[$CellContext`k$, 
           Blank[]], 
          Pattern[$CellContext`maxDiff$, 
           Blank[]], 
          Pattern[$CellContext`m$, 
           Blank[]], 
          Pattern[$CellContext`payoffs$, 
           Blank[]], 
          Pattern[$CellContext`qAA$, 
           Blank[]], 
          Pattern[$CellContext`qAB$, 
           Blank[]]] := 
        Module[{$CellContext`\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$, \
$CellContext`\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$}, {$CellContext`\
\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$, $CellContext`\[CapitalPi]BA$, \
$CellContext`\[CapitalPi]BB$} = $CellContext`payoffs$; 
          Switch[$CellContext`updateRule$$, 
            "Imitate if better, all nbrs", (($CellContext`k$ - \
$CellContext`kA$)/$CellContext`k$) Sum[
              Piecewise[{{
                 $CellContext`PBOneA[$CellContext`i, $CellContext`k$, \
$CellContext`qAB$], $CellContext`\[CapitalPi]B[$CellContext`i, \
$CellContext`k$, $CellContext`\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$] > \
$CellContext`\[CapitalPi]A[$CellContext`kA$, $CellContext`k$, $CellContext`\
\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$]}}, 0], {$CellContext`i, 
               1, $CellContext`k$}], 
            "Fermi (set intensity \!\(\*StyleBox[\"m\",FontSlant->\"Italic\"]\
\))", (($CellContext`k$ - $CellContext`kA$)/$CellContext`k$) 
            Sum[$CellContext`PBOneA[$CellContext`i, $CellContext`k$, \
$CellContext`qAB$] (
               Exp[$CellContext`m$ $CellContext`\[CapitalPi]B[$CellContext`i, \
$CellContext`k$, $CellContext`\[CapitalPi]BA$, \
$CellContext`\[CapitalPi]BB$]]/(
               Exp[$CellContext`m$ \
$CellContext`\[CapitalPi]A[$CellContext`kA$, $CellContext`k$, $CellContext`\
\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$]] + 
               Exp[$CellContext`m$ $CellContext`\[CapitalPi]B[$CellContext`i, \
$CellContext`k$, $CellContext`\[CapitalPi]BA$, \
$CellContext`\[CapitalPi]BB$]])), {$CellContext`i, 1, $CellContext`k$}], 
            "Imitative pairwise difference", (($CellContext`k$ - \
$CellContext`kA$)/$CellContext`k$) 
            Sum[$CellContext`PBOneA[$CellContext`i, $CellContext`k$, \
$CellContext`qAB$] \
($CellContext`BePositive[$CellContext`\[CapitalPi]B[$CellContext`i, \
$CellContext`k$, $CellContext`\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$] - \
$CellContext`\[CapitalPi]A[$CellContext`kA$, $CellContext`k$, $CellContext`\
\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$]]/$CellContext`maxDiff$), \
{$CellContext`i, 1, $CellContext`k$}], "Best neighbor", 
            Switch[$CellContext`kA$, 0, 
             Sum[
              Piecewise[{{
                 $CellContext`ProbabilityBestPayoffAmongBNbrsAOneB[
                  $CellContext`\[CapitalPi]B[$CellContext`i, $CellContext`k$, \
$CellContext`\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$], \
$CellContext`kA$, $CellContext`k$, $CellContext`payoffs$, $CellContext`qAB$], \
$CellContext`\[CapitalPi]B[$CellContext`i, $CellContext`k$, $CellContext`\
\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$] > \
$CellContext`\[CapitalPi]A[$CellContext`kA$, $CellContext`k$, $CellContext`\
\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$]}}, 0], {$CellContext`i, 
               1, $CellContext`k$}], $CellContext`k$, 0, 
             Blank[], 
             Sum[
              Piecewise[{{$CellContext`ProbabilityBestPayoffAmongBNbrsAOneB[
                   $CellContext`\[CapitalPi]B[$CellContext`i, \
$CellContext`k$, $CellContext`\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$], \
$CellContext`kA$, $CellContext`k$, $CellContext`payoffs$, $CellContext`qAB$] \
$CellContext`StrictCumulativeProbabilityBestPayoffAmongANbrsAOneA[
                   $CellContext`\[CapitalPi]B[$CellContext`i, \
$CellContext`k$, $CellContext`\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$], \
$CellContext`kA$, $CellContext`k$, $CellContext`payoffs$, $CellContext`qAA$], \
$CellContext`\[CapitalPi]B[$CellContext`i, $CellContext`k$, $CellContext`\
\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$] > \
$CellContext`\[CapitalPi]A[$CellContext`kA$, $CellContext`k$, $CellContext`\
\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$]}}, 0], {$CellContext`i, 
               1, $CellContext`k$}]]]]; $CellContext`FB[
          Pattern[$CellContext`kA$, 
           Blank[]], 
          Pattern[$CellContext`k$, 
           Blank[]], 
          Pattern[$CellContext`maxDiff$, 
           Blank[]], 
          Pattern[$CellContext`m$, 
           Blank[]], 
          Pattern[$CellContext`payoffs$, 
           Blank[]], 
          Pattern[$CellContext`qAA$, 
           Blank[]], 
          Pattern[$CellContext`qAB$, 
           Blank[]]] := 
        Module[{$CellContext`\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$, \
$CellContext`\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$}, {$CellContext`\
\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$, $CellContext`\[CapitalPi]BA$, \
$CellContext`\[CapitalPi]BB$} = $CellContext`payoffs$; 
          Switch[$CellContext`updateRule$$, 
            "Imitate if better, all nbrs", ($CellContext`kA$/$CellContext`k$) 
            Sum[
              Piecewise[{{
                 $CellContext`PAOneB[$CellContext`i, $CellContext`k$, \
$CellContext`qAA$], $CellContext`\[CapitalPi]A[$CellContext`i, \
$CellContext`k$, $CellContext`\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$] > \
$CellContext`\[CapitalPi]B[$CellContext`kA$, $CellContext`k$, $CellContext`\
\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$]}}, 0], {$CellContext`i, 
               0, $CellContext`k$ - 1}], 
            "Fermi (set intensity \!\(\*StyleBox[\"m\",FontSlant->\"Italic\"]\
\))", ($CellContext`kA$/$CellContext`k$) 
            Sum[$CellContext`PAOneB[$CellContext`i, $CellContext`k$, \
$CellContext`qAA$] (
               Exp[$CellContext`m$ $CellContext`\[CapitalPi]A[$CellContext`i, \
$CellContext`k$, $CellContext`\[CapitalPi]AA$, \
$CellContext`\[CapitalPi]AB$]]/(
               Exp[$CellContext`m$ \
$CellContext`\[CapitalPi]B[$CellContext`kA$, $CellContext`k$, $CellContext`\
\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$]] + 
               Exp[$CellContext`m$ $CellContext`\[CapitalPi]A[$CellContext`i, \
$CellContext`k$, $CellContext`\[CapitalPi]AA$, \
$CellContext`\[CapitalPi]AB$]])), {$CellContext`i, 0, $CellContext`k$ - 1}], 
            "Imitative pairwise difference", \
($CellContext`kA$/$CellContext`k$) 
            Sum[$CellContext`PAOneB[$CellContext`i, $CellContext`k$, \
$CellContext`qAA$] \
($CellContext`BePositive[$CellContext`\[CapitalPi]A[$CellContext`i, \
$CellContext`k$, $CellContext`\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$] - \
$CellContext`\[CapitalPi]B[$CellContext`kA$, $CellContext`k$, $CellContext`\
\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$]]/$CellContext`maxDiff$), \
{$CellContext`i, 0, $CellContext`k$ - 1}], "Best neighbor", 
            Switch[$CellContext`kA$, 0, 0, $CellContext`k$, 
             Sum[
              Piecewise[{{
                 $CellContext`ProbabilityBestPayoffAmongANbrsBOneA[
                  $CellContext`\[CapitalPi]A[$CellContext`i, $CellContext`k$, \
$CellContext`\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$], \
$CellContext`kA$, $CellContext`k$, $CellContext`payoffs$, $CellContext`qAA$], \
$CellContext`\[CapitalPi]A[$CellContext`i, $CellContext`k$, $CellContext`\
\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$] > \
$CellContext`\[CapitalPi]B[$CellContext`kA$, $CellContext`k$, $CellContext`\
\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$]}}, 0], {$CellContext`i, 
               0, $CellContext`k$ - 1}], 
             Blank[], 
             Sum[
              Piecewise[{{$CellContext`ProbabilityBestPayoffAmongANbrsBOneA[
                   $CellContext`\[CapitalPi]A[$CellContext`i, \
$CellContext`k$, $CellContext`\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$], \
$CellContext`kA$, $CellContext`k$, $CellContext`payoffs$, $CellContext`qAA$] \
$CellContext`StrictCumulativeProbabilityBestPayoffAmongBNbrsBOneB[
                   $CellContext`\[CapitalPi]A[$CellContext`i, \
$CellContext`k$, $CellContext`\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$], \
$CellContext`kA$, $CellContext`k$, $CellContext`payoffs$, $CellContext`qAB$], \
$CellContext`\[CapitalPi]A[$CellContext`i, $CellContext`k$, $CellContext`\
\[CapitalPi]AA$, $CellContext`\[CapitalPi]AB$] > \
$CellContext`\[CapitalPi]B[$CellContext`kA$, $CellContext`k$, $CellContext`\
\[CapitalPi]BA$, $CellContext`\[CapitalPi]BB$]}}, 0], {$CellContext`i, 
               0, $CellContext`k$ - 1}]]]]; $CellContext`BePositive[
          Pattern[$CellContext`x, 
           Blank[]]] := 
        Piecewise[{{
           0, $CellContext`x < 0}, {$CellContext`x, $CellContext`x >= 
            0}}]; $CellContext`CumulativeProbabilityBestPayoffAmongANbrsBOneA[
          Pattern[$CellContext`x, 
           Blank[]], 
          Pattern[$CellContext`kA, 
           Blank[]], 
          Pattern[$CellContext`k, 
           Blank[]], 
          Pattern[$CellContext`payoffs, 
           Blank[]], 
          Pattern[$CellContext`qAA, 
           Blank[]]] := 
        Module[{$CellContext`\[CapitalPi]AA, $CellContext`\[CapitalPi]AB, \
$CellContext`\[CapitalPi]BA, $CellContext`\[CapitalPi]BB}, {$CellContext`\
\[CapitalPi]AA, $CellContext`\[CapitalPi]AB, $CellContext`\[CapitalPi]BA, \
$CellContext`\[CapitalPi]BB} = $CellContext`payoffs; Sum[
             Piecewise[{{
                $CellContext`PAOneB[$CellContext`i, $CellContext`k, \
$CellContext`qAA], $CellContext`\[CapitalPi]A[$CellContext`i, $CellContext`k, \
$CellContext`\[CapitalPi]AA, $CellContext`\[CapitalPi]AB] <= $CellContext`x}},
               0], {$CellContext`i, 0, $CellContext`k - 
              1}]^$CellContext`kA]; \
$CellContext`StrictCumulativeProbabilityBestPayoffAmongANbrsBOneA[
          Pattern[$CellContext`x, 
           Blank[]], 
          Pattern[$CellContext`kA, 
           Blank[]], 
          Pattern[$CellContext`k, 
           Blank[]], 
          Pattern[$CellContext`payoffs, 
           Blank[]], 
          Pattern[$CellContext`qAA, 
           Blank[]]] := 
        Module[{$CellContext`\[CapitalPi]AA, $CellContext`\[CapitalPi]AB, \
$CellContext`\[CapitalPi]BA, $CellContext`\[CapitalPi]BB}, {$CellContext`\
\[CapitalPi]AA, $CellContext`\[CapitalPi]AB, $CellContext`\[CapitalPi]BA, \
$CellContext`\[CapitalPi]BB} = $CellContext`payoffs; Sum[
             Piecewise[{{
                $CellContext`PAOneB[$CellContext`i, $CellContext`k, \
$CellContext`qAA], $CellContext`\[CapitalPi]A[$CellContext`i, $CellContext`k, \
$CellContext`\[CapitalPi]AA, $CellContext`\[CapitalPi]AB] < $CellContext`x}}, 
              0], {$CellContext`i, 0, $CellContext`k - 
              1}]^$CellContext`kA]; \
$CellContext`ProbabilityBestPayoffAmongANbrsBOneA[
          Pattern[$CellContext`x, 
           Blank[]], 
          Pattern[$CellContext`kA, 
           Blank[]], 
          Pattern[$CellContext`k, 
           Blank[]], 
          Pattern[$CellContext`payoffs, 
           Blank[]], 
          Pattern[$CellContext`qAA, 
           
           Blank[]]] := \
$CellContext`CumulativeProbabilityBestPayoffAmongANbrsBOneA[$CellContext`x, \
$CellContext`kA, $CellContext`k, $CellContext`payoffs, $CellContext`qAA] - \
$CellContext`StrictCumulativeProbabilityBestPayoffAmongANbrsBOneA[$\
CellContext`x, $CellContext`kA, $CellContext`k, $CellContext`payoffs, \
$CellContext`qAA]; $CellContext`CumulativeProbabilityBestPayoffAmongBNbrsBOneB[
          Pattern[$CellContext`x, 
           Blank[]], 
          Pattern[$CellContext`kA, 
           Blank[]], 
          Pattern[$CellContext`k, 
           Blank[]], 
          Pattern[$CellContext`payoffs, 
           Blank[]], 
          Pattern[$CellContext`qAB, 
           Blank[]]] := 
        Module[{$CellContext`\[CapitalPi]AA, $CellContext`\[CapitalPi]AB, \
$CellContext`\[CapitalPi]BA, $CellContext`\[CapitalPi]BB}, {$CellContext`\
\[CapitalPi]AA, $CellContext`\[CapitalPi]AB, $CellContext`\[CapitalPi]BA, \
$CellContext`\[CapitalPi]BB} = $CellContext`payoffs; Sum[
             Piecewise[{{
                $CellContext`PBOneB[$CellContext`i, $CellContext`k, \
$CellContext`qAB], $CellContext`\[CapitalPi]B[$CellContext`i, $CellContext`k, \
$CellContext`\[CapitalPi]BA, $CellContext`\[CapitalPi]BB] <= $CellContext`x}},
               0], {$CellContext`i, 0, $CellContext`k - 
              1}]^($CellContext`k - $CellContext`kA)]; \
$CellContext`StrictCumulativeProbabilityBestPayoffAmongBNbrsBOneB[
          Pattern[$CellContext`x, 
           Blank[]], 
          Pattern[$CellContext`kA, 
           Blank[]], 
          Pattern[$CellContext`k, 
           Blank[]], 
          Pattern[$CellContext`payoffs, 
           Blank[]], 
          Pattern[$CellContext`qAB, 
           Blank[]]] := 
        Module[{$CellContext`\[CapitalPi]AA, $CellContext`\[CapitalPi]AB, \
$CellContext`\[CapitalPi]BA, $CellContext`\[CapitalPi]BB}, {$CellContext`\
\[CapitalPi]AA, $CellContext`\[CapitalPi]AB, $CellContext`\[CapitalPi]BA, \
$CellContext`\[CapitalPi]BB} = $CellContext`payoffs; Sum[
             Piecewise[{{
                $CellContext`PBOneB[$CellContext`i, $CellContext`k, \
$CellContext`qAB], $CellContext`\[CapitalPi]B[$CellContext`i, $CellContext`k, \
$CellContext`\[CapitalPi]BA, $CellContext`\[CapitalPi]BB] < $CellContext`x}}, 
              0], {$CellContext`i, 0, $CellContext`k - 
              1}]^($CellContext`k - $CellContext`kA)]; \
$CellContext`ProbabilityBestPayoffAmongBNbrsBOneB[
          Pattern[$CellContext`x, 
           Blank[]], 
          Pattern[$CellContext`kA, 
           Blank[]], 
          Pattern[$CellContext`k, 
           Blank[]], 
          Pattern[$CellContext`payoffs, 
           Blank[]], 
          Pattern[$CellContext`qAB, 
           
           Blank[]]] := \
$CellContext`CumulativeProbabilityBestPayoffAmongBNbrsBOneB[$CellContext`x, \
$CellContext`kA, $CellContext`k, $CellContext`payoffs, $CellContext`qAB] - \
$CellContext`StrictCumulativeProbabilityBestPayoffAmongBNbrsBOneB[$\
CellContext`x, $CellContext`kA, $CellContext`k, $CellContext`payoffs, \
$CellContext`qAB]; $CellContext`CumulativeProbabilityBestPayoffAmongBNbrsAOneB[
          Pattern[$CellContext`x, 
           Blank[]], 
          Pattern[$CellContext`kA, 
           Blank[]], 
          Pattern[$CellContext`k, 
           Blank[]], 
          Pattern[$CellContext`payoffs, 
           Blank[]], 
          Pattern[$CellContext`qAB, 
           Blank[]]] := 
        Module[{$CellContext`\[CapitalPi]AA, $CellContext`\[CapitalPi]AB, \
$CellContext`\[CapitalPi]BA, $CellContext`\[CapitalPi]BB}, {$CellContext`\
\[CapitalPi]AA, $CellContext`\[CapitalPi]AB, $CellContext`\[CapitalPi]BA, \
$CellContext`\[CapitalPi]BB} = $CellContext`payoffs; Sum[
             Piecewise[{{
                $CellContext`PBOneA[$CellContext`i, $CellContext`k, \
$CellContext`qAB], $CellContext`\[CapitalPi]B[$CellContext`i, $CellContext`k, \
$CellContext`\[CapitalPi]BA, $CellContext`\[CapitalPi]BB] <= $CellContext`x}},
               0], {$CellContext`i, 
              1, $CellContext`k}]^($CellContext`k - $CellContext`kA)]; \
$CellContext`StrictCumulativeProbabilityBestPayoffAmongBNbrsAOneB[
          Pattern[$CellContext`x, 
           Blank[]], 
          Pattern[$CellContext`kA, 
           Blank[]], 
          Pattern[$CellContext`k, 
           Blank[]], 
          Pattern[$CellContext`payoffs, 
           Blank[]], 
          Pattern[$CellContext`qAB, 
           Blank[]]] := 
        Module[{$CellContext`\[CapitalPi]AA, $CellContext`\[CapitalPi]AB, \
$CellContext`\[CapitalPi]BA, $CellContext`\[CapitalPi]BB}, {$CellContext`\
\[CapitalPi]AA, $CellContext`\[CapitalPi]AB, $CellContext`\[CapitalPi]BA, \
$CellContext`\[CapitalPi]BB} = $CellContext`payoffs; Sum[
             Piecewise[{{
                $CellContext`PBOneA[$CellContext`i, $CellContext`k, \
$CellContext`qAB], $CellContext`\[CapitalPi]B[$CellContext`i, $CellContext`k, \
$CellContext`\[CapitalPi]BA, $CellContext`\[CapitalPi]BB] < $CellContext`x}}, 
              0], {$CellContext`i, 
              1, $CellContext`k}]^($CellContext`k - $CellContext`kA)]; \
$CellContext`ProbabilityBestPayoffAmongBNbrsAOneB[
          Pattern[$CellContext`x, 
           Blank[]], 
          Pattern[$CellContext`kA, 
           Blank[]], 
          Pattern[$CellContext`k, 
           Blank[]], 
          Pattern[$CellContext`payoffs, 
           Blank[]], 
          Pattern[$CellContext`qAB, 
           
           Blank[]]] := \
$CellContext`CumulativeProbabilityBestPayoffAmongBNbrsAOneB[$CellContext`x, \
$CellContext`kA, $CellContext`k, $CellContext`payoffs, $CellContext`qAB] - \
$CellContext`StrictCumulativeProbabilityBestPayoffAmongBNbrsAOneB[$\
CellContext`x, $CellContext`kA, $CellContext`k, $CellContext`payoffs, \
$CellContext`qAB]; $CellContext`CumulativeProbabilityBestPayoffAmongANbrsAOneA[
          Pattern[$CellContext`x, 
           Blank[]], 
          Pattern[$CellContext`kA, 
           Blank[]], 
          Pattern[$CellContext`k, 
           Blank[]], 
          Pattern[$CellContext`payoffs, 
           Blank[]], 
          Pattern[$CellContext`qAA, 
           Blank[]]] := 
        Module[{$CellContext`\[CapitalPi]AA, $CellContext`\[CapitalPi]AB, \
$CellContext`\[CapitalPi]BA, $CellContext`\[CapitalPi]BB}, {$CellContext`\
\[CapitalPi]AA, $CellContext`\[CapitalPi]AB, $CellContext`\[CapitalPi]BA, \
$CellContext`\[CapitalPi]BB} = $CellContext`payoffs; Sum[
             Piecewise[{{
                $CellContext`PAOneA[$CellContext`i, $CellContext`k, \
$CellContext`qAA], $CellContext`\[CapitalPi]A[$CellContext`i, $CellContext`k, \
$CellContext`\[CapitalPi]AA, $CellContext`\[CapitalPi]AB] <= $CellContext`x}},
               0], {$CellContext`i, 
              1, $CellContext`k}]^$CellContext`kA]; \
$CellContext`StrictCumulativeProbabilityBestPayoffAmongANbrsAOneA[
          Pattern[$CellContext`x, 
           Blank[]], 
          Pattern[$CellContext`kA, 
           Blank[]], 
          Pattern[$CellContext`k, 
           Blank[]], 
          Pattern[$CellContext`payoffs, 
           Blank[]], 
          Pattern[$CellContext`qAA, 
           Blank[]]] := 
        Module[{$CellContext`\[CapitalPi]AA, $CellContext`\[CapitalPi]AB, \
$CellContext`\[CapitalPi]BA, $CellContext`\[CapitalPi]BB}, {$CellContext`\
\[CapitalPi]AA, $CellContext`\[CapitalPi]AB, $CellContext`\[CapitalPi]BA, \
$CellContext`\[CapitalPi]BB} = $CellContext`payoffs; Sum[
             Piecewise[{{
                $CellContext`PAOneA[$CellContext`i, $CellContext`k, \
$CellContext`qAA], $CellContext`\[CapitalPi]A[$CellContext`i, $CellContext`k, \
$CellContext`\[CapitalPi]AA, $CellContext`\[CapitalPi]AB] < $CellContext`x}}, 
              0], {$CellContext`i, 
              1, $CellContext`k}]^$CellContext`kA]; \
$CellContext`ProbabilityBestPayoffAmongANbrsAOneA[
          Pattern[$CellContext`x, 
           Blank[]], 
          Pattern[$CellContext`kA, 
           Blank[]], 
          Pattern[$CellContext`k, 
           Blank[]], 
          Pattern[$CellContext`payoffs, 
           Blank[]], 
          Pattern[$CellContext`qAA, 
           
           Blank[]]] := \
$CellContext`CumulativeProbabilityBestPayoffAmongANbrsAOneA[$CellContext`x, \
$CellContext`kA, $CellContext`k, $CellContext`payoffs, $CellContext`qAA] - \
$CellContext`StrictCumulativeProbabilityBestPayoffAmongANbrsAOneA[$\
CellContext`x, $CellContext`kA, $CellContext`k, $CellContext`payoffs, \
$CellContext`qAA]; Null}; Typeset`initDone$$ = True),
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellLabel->"Out[27]=",ExpressionUUID->"1fd5b92f-772e-4f7d-8abb-7336373fceb7"],

Cell["\<\
You can also use this notebook to replicate some of the results in the \
following papers:\
\>", "Text",ExpressionUUID->"021aea6b-5e2b-4058-85f8-5552c48ddfc5"],

Cell[TextData[{
 StyleBox["Hauert, C. and Doebeli, M. (2004). Spatial structure often \
inhibits the evolution of cooperation in the snowdrift game. ", "Item"],
 StyleBox["Nature", "Item",
  FontSlant->"Italic"],
 StyleBox[", 428:643\[Dash]646. http://dx.doi.org/10.1038/nature02360", "Item"]
}], "Item",ExpressionUUID->"cff5d4dc-3f61-4bdd-8771-9f7b6b96d81f"],

Cell[TextData[{
 StyleBox["Hauert, C. and Szab\[OAcute], G. (2005). Game theory and physics. \
", "Item"],
 StyleBox["American Journal of Physics", "Item",
  FontSlant->"Italic"],
 StyleBox[", 73(5):405\[Dash]414. https://doi.org/10.1119/1.1848514", "Item"]
}], "Item",ExpressionUUID->"2ca8f976-df16-491d-9adf-ee3a9cf8a092"],

Cell[TextData[{
 StyleBox["Fu, F., Nowak, M. A., and Hauert, C. (2010). Invasion and \
expansion of cooperators in lattice populations: Prisoner\[CloseCurlyQuote]s \
dilemma vs. snowdrift games. ", "Item"],
 StyleBox["Journal of Theoretical Biology", "Item",
  FontSlant->"Italic"],
 StyleBox[", \
266(3):358\[Dash]366.\[NonBreakingSpace]https://doi.org/10.1016/j.jtbi.2010.\
06.042", "Item"]
}], "Item",ExpressionUUID->"c3352103-912e-4d0d-a932-79dfb6d96bba"],

Cell[TextData[{
 "Please, note that the menu \[OpenCurlyDoubleQuote]Presets for replication\
\[CloseCurlyDoubleQuote] only works for versions 13.3 or higher of \
Mathematica and Wolfram Player. You can download the Wolfram Player for free \
at https://www.wolfram.com/player/.\n\nIf you find this notebook useful, we \
would appreciate it if you cited it as follows: \[LineSeparator]Izquierdo, \
Luis R.; Izquierdo, Segismundo S.; Hauert, Christoph (2024). Pair \
approximation for 2x2 symmetric games on regular networks. Software. DOI: ",
 ButtonBox["10.5281/zenodo.10975163",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.5281/zenodo.10975163"], None},
  ButtonNote->"https://doi.org/10.5281/zenodo.10975163"],
 ". "
}], "Text",ExpressionUUID->"6ceadfdc-305c-40ae-91bb-bfcef2ce55de"],

Cell[CellGroupData[{

Cell["License: GPLv3", "Section",ExpressionUUID->"55447b59-612e-4591-8e42-22aa94d55bf5"],

Cell[TextData[{
 "This is a ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " notebook created to solve \nthe pair approximation in 2x2 symmetric games \
on regular networks.\nCopyright (C) 2024.\n",
 ButtonBox["Luis R. Izquierdo",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://luis.izqui.org"], None},
  ButtonNote->"http://luis.izqui.org"],
 ", ",
 ButtonBox["Segismundo S. Izquierdo",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://www.segis.izqui.org"], None},
  ButtonNote->"http://www.segis.izqui.org"],
 " and ",
 ButtonBox["Christoph Hauert",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://personal.math.ubc.ca/~hauert/"], None},
  ButtonNote->"https://personal.math.ubc.ca/~hauert/"],
 ".\n \nThis program is free software: you can redistribute it and/or modify\n\
it under the terms of the GNU General Public License as published by\nthe \
Free Software Foundation, either version 3 of the License, or\n(at your \
option) any later version.\n\nThis program is distributed in the hope that it \
will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty \
of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  \[LineSeparator]See \
the GNU General Public License for more details.\n\nYou can find a copy of \
the GNU General Public License \nat ",
 ButtonBox["https://www.gnu.org/licenses/gpl.html",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://www.gnu.org/licenses/gpl.html"], None},
  ButtonNote->"https://www.gnu.org/licenses/gpl.html"],
 ".\n\nL.R.I. and S.S.I. gratefully acknowledge financial support \nfrom the \
Spanish State Research Agency \n\
(PID2020-118906GB-I00/AEI/10.13039/501100011033), \nfrom the Regional \
Government of Castilla y Le\[OAcute]n and the EU-FEDER program \n(CLU-2019-04 \
- BIOECOUVA Unit of Excellence of the University of Valladolid), and \nfrom \
the Spanish Ministry of Universities (PRX22/00064 and PRX22/00065). \nC.H. \
acknowledges financial support \nfrom Natural Sciences and Engineering \
Research Council of Canada \n(NSERC) RGPIN-2021-02608.\n\nContact \
information: \nLuis R. Izquierdo \nUniversity of Burgos, Spain. \nwebsite: ",
 ButtonBox["http://www.luis.izqui.org",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://www.luis.izqui.org"], None},
  ButtonNote->"http://www.luis.izqui.org"]
}], "Text",ExpressionUUID->"3e570553-cd0b-47f0-bf9b-dcd4a5acb375"]
}, Closed]],

Cell[CellGroupData[{

Cell["Source code", "Section",ExpressionUUID->"d7fc9b4c-924e-445b-8538-aebcffdbf017"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", " ", 
      RowBox[{
      "\[Rho]A", ",", "\[Rho]B", ",", "qAA", ",", "xAA", ",", "qAB", ",", 
       "qBA", ",", "payoffs", ",", "initialxA", ",", "initialqAA", ",", 
       "rulesToAddt", ",", "t", ",", 
       RowBox[{"maxTime", "=", "100000"}], ",", 
       RowBox[{"tolerance", "=", 
        RowBox[{"10", "^", 
         RowBox[{"-", "8"}]}]}], ",", 
       RowBox[{"accuracyGoal", "=", "6"}], ",", " ", "maxDiff", ",", "mR", 
       ",", 
       RowBox[{"errorPA", "=", "False"}], ",", 
       RowBox[{"errorMD", "=", "False"}], ",", " ", 
       RowBox[{"tooLong", "=", "False"}], ",", "limitingxPA", ",", " ", 
       "limitingqPA", ",", "limitingxMD", ",", 
       RowBox[{"epsilon", "=", 
        RowBox[{"10", "^", 
         RowBox[{"-", "4"}]}]}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"payoffs", "=", 
       RowBox[{"Rationalize", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a11", ",", "a12", ",", "a21", ",", "a22"}], "}"}], ",", 
         "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"initialxA", ",", "initialqAA"}], "}"}], "=", 
       RowBox[{"Rationalize", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"initxA", ",", "initqAA"}], "}"}], ",", "0"}], "]"}]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "We", " ", "define", " ", "actualFinalTime", " ", "and", " ", 
        "actualFinalTimeMD", " ", "with", " ", "such", " ", "long", " ", 
        "names", " ", "and", " ", "as", " ", "global", " ", "variables", " ", 
        "to", " ", "be", " ", "able", " ", "to", " ", "use", " ", "them", " ",
         "inside", " ", "the", " ", "nested", " ", "Manipulate", " ", "to", 
        " ", "zoom", " ", "in", " ", "the", " ", "Plot"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"actualFinalTimePA", "=", "maxTime"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"actualFinalTimeMD", "=", "maxTime"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Basic", " ", "variables"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"xAA", "=", " ", 
       RowBox[{"\[Rho]A", " ", "qAA"}]}], " ", ";", "\[IndentingNewLine]", 
      RowBox[{"\[Rho]B", "=", 
       RowBox[{"1", "-", "\[Rho]A"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"qBA", "=", 
       RowBox[{"(", 
        RowBox[{"1", "-", "qAA"}], " ", ")"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"qAB", "=", 
       RowBox[{
        FractionBox["\[Rho]A", 
         RowBox[{"1", "-", "\[Rho]A"}]], 
        RowBox[{"(", 
         RowBox[{"1", "-", "qAA"}], " ", ")"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "The", " ", "following", " ", "two", " ", "lines", " ", "are", " ", 
        "for", " ", "imitative", " ", "pairwise", " ", "difference", " ", 
        "only"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"maxDiff", "=", 
       RowBox[{"Max", "@", 
        RowBox[{"Outer", "[", 
         RowBox[{"Subtract", ",", "payoffs", ",", "payoffs"}], "]"}]}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"maxDiff", "==", "0"}], ",", 
        RowBox[{"maxDiff", "=", "1"}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "To", " ", "avoid", " ", "division", " ", "by", " ", "zero", " ", "in",
         " ", "case", " ", "all", " ", "payoffs", " ", "are", " ", "equal"}], 
       "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"mR", "=", 
       RowBox[{"Rationalize", "[", 
        RowBox[{"m", ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Differential", " ", "equations"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"rulesToAddt", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Rho]A", "'"}], "->", 
          RowBox[{
           RowBox[{"\[Rho]A", "'"}], "[", "t", "]"}]}], ",", 
         RowBox[{"\[Rho]A", "->", 
          RowBox[{"\[Rho]A", "[", "t", "]"}]}], ",", 
         RowBox[{"qAA", " ", "->", 
          RowBox[{"qAA", " ", "[", "t", "]"}]}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"xAA", "'"}], "=", 
       RowBox[{
        RowBox[{"\[Rho]B", 
         RowBox[{
          SubsuperscriptBox["\[Sum]", 
           RowBox[{"kA", "=", "0"}], "k"], 
          RowBox[{
           RowBox[{"PB", "[", 
            RowBox[{"kA", ",", "k", ",", "qAB"}], "]"}], 
           RowBox[{"FB", "[", 
            RowBox[{
            "kA", ",", "k", ",", "maxDiff", ",", "mR", ",", "payoffs", ",", 
             "qAA", ",", "qAB"}], "]"}], 
           FractionBox[
            RowBox[{"2", "kA"}], "k"]}]}]}], "  ", "-", 
        RowBox[{"\[Rho]A", 
         RowBox[{
          SubsuperscriptBox["\[Sum]", 
           RowBox[{"kA", "=", "0"}], "k"], 
          RowBox[{
           RowBox[{"PA", "[", 
            RowBox[{"kA", ",", "k", ",", "qAA"}], "]"}], 
           RowBox[{"FA", "[", 
            RowBox[{
            "kA", ",", "k", ",", "maxDiff", ",", "mR", ",", "payoffs", ",", 
             "qAA", ",", "qAB"}], "]"}], 
           FractionBox[
            RowBox[{"2", "kA"}], "k"]}]}]}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "We", " ", "define", " ", "pairApproximationSolution", " ", "with", 
        " ", "such", " ", "a", " ", "long", " ", "name", " ", "and", " ", 
        "as", " ", "a", " ", "global", " ", "variable", " ", "to", " ", "be", 
        " ", "able", " ", "to", " ", "use", " ", "it", " ", "inside", " ", 
        "the", " ", "nested", " ", "Manipulate", " ", "to", " ", "zoom", " ", 
        "in", " ", "the", " ", "Plot"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"pairApproximationSolution", "=", 
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"$MaxExtraPrecision", "=", "1000"}], "}"}], ",", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"$MaxExtraPrecision", "=", "1000"}], "}"}], " ", "is", 
           " ", "to", " ", "deal", " ", "with", " ", "some", " ", "cases", 
           " ", "with", " ", "Fermi"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"TimeConstrained", "[", 
          RowBox[{
           RowBox[{"Quiet", "@", 
            RowBox[{"Check", "[", 
             RowBox[{
              RowBox[{"NDSolveValue", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"\[Rho]A", "'"}], "[", "t", "]"}], "==", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"\[Rho]B", 
                    RowBox[{
                    SubsuperscriptBox["\[Sum]", 
                    RowBox[{"kA", "=", "0"}], "k"], 
                    RowBox[{
                    RowBox[{"PB", "[", 
                    RowBox[{"kA", ",", "k", ",", "qAB"}], "]"}], 
                    RowBox[{"FB", "[", 
                    RowBox[{
                    "kA", ",", "k", ",", "maxDiff", ",", "mR", ",", "payoffs",
                     ",", "qAA", ",", "qAB"}], "]"}]}]}]}], "-", 
                    RowBox[{"\[Rho]A", 
                    RowBox[{
                    SubsuperscriptBox["\[Sum]", 
                    RowBox[{"kA", "=", "0"}], "k"], 
                    RowBox[{
                    RowBox[{"PA", "[", 
                    RowBox[{"kA", ",", "k", ",", "qAA"}], "]"}], 
                    RowBox[{"FA", "[", 
                    RowBox[{
                    "kA", ",", "k", ",", "maxDiff", ",", "mR", ",", "payoffs",
                     ",", "qAA", ",", "qAB"}], "]"}]}]}]}]}], "/.", 
                    "rulesToAddt"}], ")"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"qAA", " ", "'"}], "[", "t", "]"}], "==", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    FractionBox[
                    RowBox[{"xAA", "'"}], "\[Rho]A"], "-", 
                    RowBox[{
                    FractionBox["xAA", 
                    SuperscriptBox["\[Rho]A", "2"]], 
                    RowBox[{"\[Rho]A", "'"}]}]}], "/.", "rulesToAddt"}], 
                    ")"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"\[Rho]A", "[", "0", "]"}], "==", "initialxA"}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"qAA", " ", "[", "0", "]"}], "==", "initialqAA"}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{"WhenEvent", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Norm", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"\[Rho]A", "'"}], "[", "t", "]"}], ",", 
                    RowBox[{
                    RowBox[{"qAA", " ", "'"}], "[", "t", "]"}]}], "}"}], 
                    "]"}], "-", "tolerance"}], "<", "0"}], "}"}], ",", " ", 
                    RowBox[{"\"\<StopIntegration\>\"", ";", 
                    RowBox[{"actualFinalTimePA", "=", "t"}]}]}], "]"}]}], 
                 "}"}], ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"\[Rho]A", ",", "qAA"}], " ", "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"t", ",", "0", ",", "maxTime"}], "}"}], ",", 
                RowBox[{"AccuracyGoal", "\[Rule]", "accuracyGoal"}], ",", 
                RowBox[{"MaxSteps", "->", "Infinity"}], ",", 
                RowBox[{"WorkingPrecision", "\[Rule]", "20"}], ",", 
                RowBox[{"Method", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                   "\"\<TimeIntegration\>\"", "->", 
                    "\"\<StiffnessSwitching\>\""}], ",", 
                   RowBox[{"\"\<EquationSimplification\>\"", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Solve\>\"", ",", " ", 
                    RowBox[{"\"\<TimeConstraint\>\"", "\[Rule]", "10"}]}], 
                    "}"}]}]}], "}"}]}]}], "]"}], ",", 
              RowBox[{
               RowBox[{"errorPA", "=", "True"}], ";", 
               RowBox[{"actualFinalTimePA", "=", "10"}], ";", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "1"}], "&"}], ",", 
                 RowBox[{
                  RowBox[{"-", "1"}], "&"}]}], "}"}]}]}], "]"}]}], 
           "\[IndentingNewLine]", ",", "maxTimeOut"}], "]"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Method", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<StiffnessSwitching\>\"", ",", 
           RowBox[{"\"\<DiscontinuityProcessing\>\"", "\[Rule]", "False"}]}], 
          "}"}]}], ","}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"We", " ", "include", " ", "Method"}], "\[Rule]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<DiscontinuityProcessing\>\"", "\[Rule]", "False"}], 
          "}"}], " ", "to", " ", "avoid", " ", 
         RowBox[{"error", ":", " ", 
          RowBox[{"NDSolve", "::", "smpf"}], ":", 
          RowBox[{
          "Failure", " ", "to", " ", "project", " ", "onto", " ", "the", " ", 
           "discontinuity", " ", "surface", " ", "when", " ", "computing", 
           " ", "Filippov", " ", "continuation", " ", "at", " ", "time", " ", 
           "0"}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"We", " ", "include", " ", "Method"}], "\[Rule]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "\"\<StiffnessSwitching\>\"", "}"}], " ", "and", " ", 
           "WorkingPrecision"}], "\[Rule]", 
          RowBox[{"20", " ", "to", " ", "avoid", " ", 
           RowBox[{"error", ":", " ", 
            RowBox[{"NDSolve", "::", "ndsz"}], ":", 
            RowBox[{
            "\"\<At xxx, step size is effectively zero; singularity or stiff \
system suspected.\>\"", "\[IndentingNewLine]", "See", " ", 
             RowBox[{"https", ":"}]}]}]}]}]}], "//", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"mathematica", ".", "stackexchange", ".", "com"}], "/", 
            "questions"}], "/", "158458"}], "/", "how"}], "-", "to", "-", 
         "evade", "-", "singularity", "-", "or", "-", "stiff", "-", "system", 
         "-", "suspected", "-", "in", "-", "ndsolve"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Method", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "\"\<TimeIntegration\>\"", "->", "\"\<StiffnessSwitching\>\""}], 
          ",", 
          RowBox[{"\"\<EquationSimplification\>\"", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<Solve\>\"", ",", " ", 
             RowBox[{"\"\<TimeConstraint\>\"", "\[Rule]", "10"}]}], "}"}]}]}],
          "}"}]}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "If", " ", "NDSolveValue", " ", "takes", " ", "too", " ", "long"}], 
        ",", " ", 
        RowBox[{"pairApproximationSolution", " ", "==", " ", "$Aborted"}]}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"pairApproximationSolution", "===", "$Aborted"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"tooLong", "=", "True"}], ";", "\[IndentingNewLine]", 
         RowBox[{"pairApproximationSolution", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "1"}], "&"}], ",", 
            RowBox[{
             RowBox[{"-", "1"}], "&"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"actualFinalTimePA", "=", "0"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"actualFinalTimeMD", "=", 
       RowBox[{"Max", "[", 
        RowBox[{"10", ",", "actualFinalTimePA"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"We", " ", "impose", " ", "that", " ", "actualFinalTimeMD"}],
          " ", ">=", " ", "10"}], ",", " ", 
        RowBox[{
         RowBox[{"because", " ", "if", " ", "updateRule"}], " ", "=", " ", 
         RowBox[{
         "\"\<Imitate if better, all nbrs\>\"", " ", "we", " ", "do", " ", 
          "not", " ", "solve", " ", "the", " ", "MD", " ", "with", " ", 
          "NDSolve"}]}], ",", " ", 
        RowBox[{
         RowBox[{"sometimes", " ", "actualFinalTimePA"}], " ", "<", " ", 
         "10"}], ",", " ", 
        RowBox[{
        "but", " ", "the", " ", "solution", " ", "of", " ", "the", " ", "MD", 
         " ", "has", " ", "not", " ", 
         RowBox[{"converged", ".", " ", "The"}], " ", "value", " ", "of", " ",
          "10", " ", "is", " ", "arbitrary"}], ",", " ", 
        RowBox[{"but", " ", "it", " ", "seems", " ", "to", " ", "work", " ", 
         RowBox[{"fine", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Below", " ", "we", " ", "define", " ", "meanDynamicSolution", " ", 
        "with", " ", "such", " ", "a", " ", "long", " ", "name", " ", "and", 
        " ", "as", " ", "a", " ", "global", " ", "variable", " ", "to", " ", 
        "be", " ", "able", " ", "to", " ", "use", " ", "it", " ", "inside", 
        " ", "the", " ", "nested", " ", "Manipulate", " ", "to", " ", "zoom", 
        " ", "in", " ", "the", " ", "Plot"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"meanDynamicSolution", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"updateRule", "!=", "\"\<Imitate if better, all nbrs\>\""}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"Quiet", "@", 
          RowBox[{"Check", "[", 
           RowBox[{
            RowBox[{"NDSolveValue", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Rho]A", "'"}], "[", "t", "]"}], "==", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"ExpectedChange", "[", 
                    RowBox[{
                    "maxDiff", ",", "mR", ",", "payoffs", ",", "\[Rho]A"}], 
                    "]"}], "/.", "rulesToAddt"}], ")"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"\[Rho]A", "[", "0", "]"}], "==", "initialxA"}], ",",
                 "\[IndentingNewLine]", 
                RowBox[{"WhenEvent", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"\[Rho]A", "'"}], "[", "t", "]"}], "]"}], "-", 
                    "tolerance"}], "<", "0"}], ",", " ", 
                  RowBox[{"\"\<StopIntegration\>\"", ";", 
                   RowBox[{"actualFinalTimeMD", "=", "t"}]}]}], "]"}]}], 
               "}"}], ",", "\[IndentingNewLine]", "\[Rho]A", ",", 
              RowBox[{"{", 
               RowBox[{"t", ",", "0", ",", "maxTime"}], "}"}], ",", 
              RowBox[{"AccuracyGoal", "\[Rule]", "accuracyGoal"}], ",", 
              RowBox[{"MaxSteps", "->", "Infinity"}], ",", 
              RowBox[{"Method", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\"\<StiffnessSwitching\>\"", ",", 
                 RowBox[{
                 "\"\<DiscontinuityProcessing\>\"", "\[Rule]", "False"}]}], 
                "}"}]}]}], "]"}], "\[IndentingNewLine]", ",", 
            RowBox[{
             RowBox[{"errorMD", "=", "True"}], ";", 
             RowBox[{"actualFinalTimeMD", "=", "10"}], ";", 
             RowBox[{
              RowBox[{"-", "1"}], "&"}]}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"-", "1"}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Below", " ", "we", " ", "define", " ", 
        "meanDynamicSolutionImitateIfBetterAllNbrs", " ", "with", " ", "such",
         " ", "a", " ", "long", " ", "name", " ", "and", " ", "as", " ", "a", 
        " ", "global", " ", "variable", " ", "to", " ", "be", " ", "able", 
        " ", "to", " ", "use", " ", "it", " ", "inside", " ", "the", " ", 
        "nested", " ", "Manipulate", " ", "to", " ", "zoom", " ", "in", " ", 
        "the", " ", "Plot"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"meanDynamicSolutionImitateIfBetterAllNbrs", "=", 
       RowBox[{"MDsolutionImitateIfBetterAllNbrs", "[", 
        RowBox[{"initialxA", ",", "payoffs"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "update", ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "This", " ", "is", " ", "a", " ", "trick", " ", "to", " ", "make", " ",
         "the", " ", "\"\<update\>\"", " ", "button", " ", "work"}], " ", 
       "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"actualFinalTime", "=", 
       RowBox[{"Max", "[", 
        RowBox[{"actualFinalTimePA", ",", "actualFinalTimeMD"}], "]"}]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"limitingxPA", "=", 
       RowBox[{"Chop", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"First", "[", "pairApproximationSolution", "]"}], "[", 
          "actualFinalTime", "]"}], ",", 
         RowBox[{"10", "^", 
          RowBox[{"-", "5"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"limitingqPA", "=", 
       RowBox[{"Chop", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Last", "[", "pairApproximationSolution", "]"}], "[", 
          "actualFinalTime", "]"}], ",", 
         RowBox[{"10", "^", 
          RowBox[{"-", "5"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"0", "-", "epsilon"}], "<=", "limitingxPA", "<=", 
            RowBox[{"1", "+", "epsilon"}]}], ")"}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"0", "-", "epsilon"}], "<=", "limitingqPA", "<=", 
            RowBox[{"1", "+", "epsilon"}]}], ")"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"errorPA", "=", "True"}], ";", "\[IndentingNewLine]", 
         RowBox[{"pairApproximationSolution", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "1"}], "&"}], ",", 
            RowBox[{
             RowBox[{"-", "1"}], "&"}]}], "}"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"limitingxMD", "=", 
       RowBox[{"meanDynamicSolution", "[", "actualFinalTime", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"updateRule", "!=", "\"\<Imitate if better, all nbrs\>\""}], 
         "&&", "showMD", "&&", 
         RowBox[{"Not", "[", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"0", "-", "epsilon"}], "<=", "limitingxMD", "<=", 
            RowBox[{"1", "+", "epsilon"}]}], ")"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"errorMD", "=", "True"}], ";", "\[IndentingNewLine]", 
         RowBox[{"meanDynamicSolution", "=", 
          RowBox[{
           RowBox[{"-", "1"}], "&"}]}], ";"}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Pane", "[", 
       RowBox[{"Grid", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", "PLOT", " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "Show", " ", "PA", " ", "if", " ", "not", " ", "error", " ", 
               "and", " ", "not", " ", "tooLong"}], ",", " ", "and", ",", " ", 
              RowBox[{"if", " ", "showMD"}], ",", " ", 
              RowBox[{"then", " ", "MD", " ", "too"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Item", "[", 
              RowBox[{
               RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Plot", "[", 
                  RowBox[{
                   RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Evaluate", "@", 
                    RowBox[{"MapThread", "[", 
                    RowBox[{"Tooltip", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", "t2", "]"}], "&"}], ",", 
                    "pairApproximationSolution"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<\[Rho]A\>\"", ",", "\"\<qAA\>\""}], "}"}]}], 
                    "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Evaluate", "@", 
                    RowBox[{"Tooltip", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{"showMD", ",", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    "updateRule", "==", 
                    "\"\<Imitate if better, all nbrs\>\""}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    "meanDynamicSolutionImitateIfBetterAllNbrs", "[", "t2", 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"meanDynamicSolution", "[", "t2", "]"}]}], 
                    "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"-", "1"}]}], "]"}], ",", "\"\<MD\>\""}], 
                    "]"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"t2", ",", "0", ",", 
                    RowBox[{"actualFinalTime", "/", 
                    RowBox[{"z", "^", "2"}]}]}], "}"}], ",", 
                   RowBox[{"PlotLegends", "\[Rule]", 
                    RowBox[{"LineLegend", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Directive", "[", 
                    RowBox[{
                    
                    TemplateBox[<|
                    "color" -> RGBColor[0.368417, 0.506779, 0.709798]|>,
                    "RGBColorSwatchTemplate"], ",", 
                    RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"Directive", "[", 
                    RowBox[{
                    
                    TemplateBox[<|
                    "color" -> RGBColor[0.880722, 0.611041, 0.142051]|>,
                    "RGBColorSwatchTemplate"], ",", 
                    RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"Directive", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{"showMD", ",", "Black", ",", "White"}], "]"}], 
                    ",", 
                    RowBox[{"AbsoluteThickness", "[", "2", "]"}], ",", 
                    "Dashed"}], "]"}]}], "}"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{"showMD", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<\!\(\*SubscriptBox[\(x\), \(A\)]\)\>\"", ",", 
                    "\"\<\!\(\*SubscriptBox[\(q\), \(AA\)]\)\>\"", ",", 
                    "\"\<MD\>\""}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<\!\(\*SubscriptBox[\(x\), \(A\)]\)\>\"", ",", 
                    "\"\<\!\(\*SubscriptBox[\(q\), \(AA\)]\)\>\"", ",", 
                    "\"\<\>\""}], "}"}]}], "]"}]}], "]"}]}], ",", 
                   RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
                   RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "Automatic"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "0.01"}], ",", "1.01"}], "}"}]}], "}"}]}], 
                   ",", 
                   RowBox[{"AxesLabel", "->", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<\!\(\*StyleBox[\"t\",FontSlant->\"Italic\"]\)\>\"", 
                    ",", "None"}], "}"}]}], ",", 
                   RowBox[{"PlotStyle", "->", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Directive", "[", 
                    RowBox[{
                    
                    TemplateBox[<|
                    "color" -> RGBColor[0.368417, 0.506779, 0.709798]|>,
                    "RGBColorSwatchTemplate"], ",", 
                    RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], 
                    ",", " ", 
                    RowBox[{"Directive", "[", 
                    RowBox[{
                    
                    TemplateBox[<|
                    "color" -> RGBColor[0.880722, 0.611041, 0.142051]|>,
                    "RGBColorSwatchTemplate"], ",", 
                    RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}], 
                    ",", " ", 
                    RowBox[{"Directive", "[", 
                    RowBox[{"Black", ",", 
                    RowBox[{"AbsoluteThickness", "[", "2", "]"}], ",", 
                    "Dashed"}], "]"}]}], "}"}]}], ",", 
                   RowBox[{"ImageSize", "\[Rule]", "450"}]}], "]"}], 
                 "\[IndentingNewLine]", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"z", ",", "1", ",", "\"\<zoom\>\""}], "}"}], ",", 
                   "1", ",", "100"}], "}"}], ",", 
                 RowBox[{"SynchronousUpdating", "\[Rule]", "True"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"ContinuousAction", "\[Rule]", "True"}], ",", 
                 RowBox[{"AppearanceElements", "\[Rule]", "None"}], ",", 
                 RowBox[{"Paneled", "\[Rule]", "False"}]}], "]"}], ",", 
               RowBox[{"Alignment", "->", "Center"}]}], "]"}], ",", 
             "SpanFromLeft", ",", "SpanFromLeft"}], "\[IndentingNewLine]", 
            "}"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"FIRST", " ", "ROW"}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Not", "[", "errorPA", "]"}], "&&", 
                  RowBox[{"Not", "[", "tooLong", "]"}]}], ")"}], "||", 
                RowBox[{"(", 
                 RowBox[{"showMD", "&&", 
                  RowBox[{"Not", "[", "errorMD", "]"}]}], ")"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Row", "[", 
                RowBox[{"{", 
                 RowBox[{
                 "\"\<Numerical integration stopped at \
\!\(\*StyleBox[\"t\",FontSlant->\"Italic\"]\)=\>\"", ",", 
                  RowBox[{"ScientificForm", "[", 
                   RowBox[{
                    RowBox[{"N", "@", 
                    RowBox[{"Floor", "@", "actualFinalTime"}]}], ",", "3"}], 
                   "]"}], ",", " ", "\"\< because \>\"", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"actualFinalTime", "<", "maxTime"}], ",", 
                    "\"\<all computed values stabilized at that time\>\"", 
                    ",", "\"\<that is the maximum time set for \
integration\>\""}], "]"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
               "\"\<\>\""}], "]"}], ",", "SpanFromLeft", ",", 
             "SpanFromLeft"}], "\[IndentingNewLine]", "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"SECOND", " ", "ROW"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"THIRD", " ", "ROW"}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"\"\<Pair Approximation\>\"", ",", "Black", ",", "14"}],
               "]"}], ",", "\[IndentingNewLine]", "\"\<\>\"", ",", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{"showMD", ",", 
               RowBox[{"Style", "[", 
                RowBox[{
                "\"\<Mean Dynamic (MD)\>\"", ",", "Black", ",", "14"}], "]"}],
                ",", "\"\<\>\""}], "]"}]}], "\[IndentingNewLine]", "}"}], 
           "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"FOURTH", " ", "ROW"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"R2", ",", " ", "c1"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{"errorPA", ",", "\[IndentingNewLine]", 
               RowBox[{"Style", "[", 
                RowBox[{
                "\"\<Numerical instability\>\"", ",", "Red", ",", "12"}], 
                "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{"tooLong", ",", " ", "\[IndentingNewLine]", 
                 RowBox[{"Style", "[", 
                  RowBox[{
                  "\"\<Solving the pair approximation\>\"", ",", "Red", ",", 
                   "12"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{"Everything", " ", "ok"}], "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{"Style", "[", 
                  RowBox[{
                   RowBox[{"Row", "[", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    "\"\<\!\(\*SubscriptBox[StyleBox[\"x\",FontSlant->\"\
Italic\"], \"A\"]\)(\!\(\*StyleBox[\"t\",FontSlant->\"Italic\"]\)=\>\"", ",", 
                    RowBox[{"ScientificForm", "[", 
                    RowBox[{
                    RowBox[{"N", "@", 
                    RowBox[{"Floor", "@", "actualFinalTime"}]}], ",", "3"}], 
                    "]"}], ",", "\"\<) = \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{"limitingxPA", ",", "3"}], "]"}]}], 
                    "\[IndentingNewLine]", "}"}], "]"}], ",", 
                   RowBox[{"Darker", "[", "Blue", "]"}], ",", "12"}], "]"}]}],
                 "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}],
              ",", "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{"R2", ",", " ", "c2"}], " ", "*)"}], 
             "\[IndentingNewLine]", "\"\<\>\"", ",", "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{"R2", ",", " ", "c3"}], " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{"showMD", ",", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{"errorMD", ",", "\[IndentingNewLine]", 
                 RowBox[{"Style", "[", 
                  RowBox[{
                  "\"\<Numerical instability\>\"", ",", "Red", ",", "12"}], 
                  "]"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
                 RowBox[{"Style", "[", 
                  RowBox[{
                   RowBox[{"Row", "[", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    "\"\<\!\(\*SubscriptBox[StyleBox[\"x\",FontSlant->\"\
Italic\"], \"A\"]\)(\!\(\*StyleBox[\"t\",FontSlant->\"Italic\"]\)=\>\"", ",", 
                    RowBox[{"ScientificForm", "[", 
                    RowBox[{
                    RowBox[{"N", "@", 
                    RowBox[{"Floor", "@", "actualFinalTime"}]}], ",", "3"}], 
                    "]"}], ",", "\"\<) = \>\"", ",", "\[IndentingNewLine]", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"Chop", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    "updateRule", "==", 
                    "\"\<Imitate if better, all nbrs\>\""}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Quiet", "@", 
                    RowBox[{"N", "[", 
                    RowBox[{
                    "meanDynamicSolutionImitateIfBetterAllNbrs", "[", 
                    "actualFinalTime", "]"}], "]"}]}], ",", "limitingxMD"}], 
                    "]"}], "\[IndentingNewLine]", ",", 
                    RowBox[{"10", "^", 
                    RowBox[{"-", "5"}]}]}], "]"}], ",", "3"}], "]"}]}], 
                    "\[IndentingNewLine]", "}"}], "]"}], ",", "Black", ",", 
                   "12"}], "]"}]}], "\[IndentingNewLine]", "]"}], 
               "\[IndentingNewLine]", ",", "\"\<\>\""}], "]"}]}], 
            "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"FIFTH", " ", "ROW"}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"R3", ",", " ", "c1"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{"errorPA", ",", "\[IndentingNewLine]", 
               RowBox[{"Style", "[", 
                RowBox[{
                "\"\<Please, try changing the initial conditions\>\"", ",", 
                 "Black", ",", "10"}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{"tooLong", ",", " ", "\[IndentingNewLine]", 
                 RowBox[{"Style", "[", 
                  RowBox[{
                   RowBox[{"\"\<takes longer than maxTimeOut = \>\"", "<>", 
                    RowBox[{"ToString", "[", "maxTimeOut", "]"}], "<>", 
                    "\"\<s.\>\""}], ",", "Red", ",", "12"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{
                   RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"maxTimeOut", "<", "20"}], ",", 
                    "\"\<You may wish to increase maxTimeOut\>\"", ",", 
                    "\"\<\>\""}], "]"}], ",", "10"}], "]"}], ","}], "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{"Everything", " ", "ok"}], "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{"Style", "[", 
                  RowBox[{
                   RowBox[{"Row", "[", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    "\"\<\!\(\*SubscriptBox[StyleBox[\"q\",FontSlant->\"\
Italic\"], \"AA\"]\)(\!\(\*StyleBox[\"t\",FontSlant->\"Italic\"]\)=\>\"", ",", 
                    RowBox[{"ScientificForm", "[", 
                    RowBox[{
                    RowBox[{"N", "@", 
                    RowBox[{"Floor", "@", "actualFinalTime"}]}], ",", "3"}], 
                    "]"}], ",", "\"\<) = \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{"limitingqPA", ",", "3"}], "]"}]}], 
                    "\[IndentingNewLine]", "}"}], "]"}], ",", 
                   RowBox[{"Darker", "[", "Orange", "]"}], ",", "12"}], 
                  "]"}]}], "\[IndentingNewLine]", "]"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{"R3", ",", " ", "c2"}], " ", "*)"}], 
             "\[IndentingNewLine]", "\"\<\>\"", ",", "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{"R3", ",", " ", "c3"}], " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"showMD", "&&", "errorMD"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Style", "[", 
                RowBox[{
                "\"\<Please, try changing initial cond.\>\"", ",", "Black", 
                 ",", "10"}], "]"}], ",", "\[IndentingNewLine]", "\"\<\>\""}],
               "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}],
           "\[IndentingNewLine]", "}"}], ",", 
         RowBox[{"Alignment", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"Left", ",", "Center", ",", "Right"}], "}"}], "}"}]}]}], 
        "]"}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}],
    ",", " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "End", " ", "of", " ", "Module", " ", "right", " ", "after", " ", 
     "Manipulate"}], " ", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"MANIPULATE", " ", "PARAMETERS"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "We", " ", "want", " ", "all", " ", "parameteres", " ", "to", " ", "be", 
      " ", "controlled", " ", "by", " ", "Manipulate"}], ",", " ", 
     RowBox[{
     "but", " ", "we", " ", "also", " ", "want", " ", "to", " ", "customize", 
      " ", "the", " ", 
      RowBox[{"interface", ".", " ", "Because"}], " ", "of", " ", "this"}], 
     ",", " ", 
     RowBox[{
     "we", " ", "define", " ", "all", " ", "parameters", " ", "here", " ", 
      "following", " ", "the", " ", "Manipulate", " ", "approach"}], ",", " ", 
     RowBox[{
      RowBox[{"but", " ", "with", " ", "ControlType"}], "\[Rule]", "None"}], 
     ",", " ", 
     RowBox[{
     "and", " ", "we", " ", "create", " ", "our", " ", "customized", " ", 
      "controls", " ", "later"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"preset", ",", "\"\<Hauert Doebeli 2004 fig1b r=0.2\>\""}], 
      "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a11", ",", "1"}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a12", ",", "0.8"}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a21", ",", "1.2"}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a22", ",", "0"}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"gameName", ",", "\"\<Snowdrift\>\""}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"k", ",", "4"}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", " ", 
   RowBox[{"(*", " ", "degree", " ", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"update", ",", "0"}], "}"}], ",", "0", ",", "100", ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"updateRule", ",", "\"\<Imitative pairwise difference\>\""}], 
      "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", ",", "1"}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"initxA", ",", "0.5"}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"initqAA", ",", "0.5"}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"showMD", ",", "True"}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"maxTimeOut", ",", "1"}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"CUSTOMIZED", " ", "INTERFACE", " ", "FOR", " ", "PARAMETERS"}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Style", "[", 
    RowBox[{"\"\<Presets for replication\>\"", ",", "Bold", ",", "Medium"}], 
    "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Row", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ActionMenu", "[", 
       RowBox[{
        RowBox[{"Dynamic", "[", "preset", "]"}], ",", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\"\<Hauert & Doebeli (2004)\>\"", "->", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"\"\<fig1b r=0.2\>\"", "\[RuleDelayed]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"a11", "=", "1"}], ";", 
                RowBox[{"a12", "=", "0.8"}], ";", 
                RowBox[{"a21", "=", "1.2"}], ";", 
                RowBox[{"a22", "=", "0"}], ";", 
                RowBox[{"update", "=", "1000"}], ";", 
                RowBox[{"gameName", "=", "\"\<Snowdrift\>\""}], ";", 
                RowBox[{
                "updateRule", "=", "\"\<Imitative pairwise difference\>\""}], 
                ";", 
                RowBox[{"k", "=", "4"}], ";", 
                RowBox[{"initxA", "=", "0.5"}], ";", 
                RowBox[{"initqAA", "=", "0.5"}], ";", 
                RowBox[{"showMD", "=", "True"}], ";", 
                RowBox[{
                "preset", "=", "\"\<Hauert Doebeli 2004 fig1b r=0.2\>\""}]}], 
               ")"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"\"\<fig1b r=0.5\>\"", "\[RuleDelayed]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"a11", "=", "1"}], ";", 
                RowBox[{"a12", "=", "0.5"}], ";", 
                RowBox[{"a21", "=", "1.5"}], ";", 
                RowBox[{"a22", "=", "0"}], ";", 
                RowBox[{"update", "=", "2000"}], ";", 
                RowBox[{"gameName", "=", "\"\<Snowdrift\>\""}], ";", 
                RowBox[{
                "updateRule", "=", "\"\<Imitative pairwise difference\>\""}], 
                ";", 
                RowBox[{"k", "=", "4"}], ";", 
                RowBox[{"initxA", "=", "0.5"}], ";", 
                RowBox[{"initqAA", "=", "0.5"}], ";", 
                RowBox[{"showMD", "=", "True"}], ";", 
                RowBox[{
                "preset", "=", "\"\<Hauert Doebeli 2004 fig1b r=0.5\>\""}]}], 
               ")"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"\"\<fig1b r=0.9\>\"", "\[RuleDelayed]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"a11", "=", "1"}], ";", 
                RowBox[{"a12", "=", "0.1"}], ";", 
                RowBox[{"a21", "=", "1.9"}], ";", 
                RowBox[{"a22", "=", "0"}], ";", 
                RowBox[{"update", "=", "3000"}], ";", 
                RowBox[{"gameName", "=", "\"\<Snowdrift\>\""}], ";", 
                RowBox[{
                "updateRule", "=", "\"\<Imitative pairwise difference\>\""}], 
                ";", 
                RowBox[{"k", "=", "4"}], ";", 
                RowBox[{"initxA", "=", "0.5"}], ";", 
                RowBox[{"initqAA", "=", "0.5"}], ";", 
                RowBox[{"showMD", "=", "True"}], ";", 
                RowBox[{
                "preset", "=", "\"\<Hauert Doebeli 2004 fig1b r=0.9\>\""}]}], 
               ")"}]}], ",", "\[IndentingNewLine]", "Delimiter", ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<fig1d r=0.2\>\"", "\[RuleDelayed]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"a11", "=", "1"}], ";", 
                RowBox[{"a12", "=", "0.8"}], ";", 
                RowBox[{"a21", "=", "1.2"}], ";", 
                RowBox[{"a22", "=", "0"}], ";", 
                RowBox[{"update", "=", "5000"}], ";", 
                RowBox[{"gameName", "=", "\"\<Snowdrift\>\""}], ";", 
                RowBox[{
                "updateRule", "=", "\"\<Imitative pairwise difference\>\""}], 
                ";", 
                RowBox[{"k", "=", "8"}], ";", 
                RowBox[{"initxA", "=", "0.5"}], ";", 
                RowBox[{"initqAA", "=", "0.5"}], ";", 
                RowBox[{"showMD", "=", "True"}], ";", 
                RowBox[{
                "preset", "=", "\"\<Hauert Doebeli 2004 fig1d r=0.2\>\""}]}], 
               ")"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"\"\<fig1d r=0.5\>\"", "\[RuleDelayed]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"a11", "=", "1"}], ";", 
                RowBox[{"a12", "=", "0.5"}], ";", 
                RowBox[{"a21", "=", "1.5"}], ";", 
                RowBox[{"a22", "=", "0"}], ";", 
                RowBox[{"update", "=", "6000"}], ";", 
                RowBox[{"gameName", "=", "\"\<Snowdrift\>\""}], ";", 
                RowBox[{
                "updateRule", "=", "\"\<Imitative pairwise difference\>\""}], 
                ";", 
                RowBox[{"k", "=", "8"}], ";", 
                RowBox[{"initxA", "=", "0.5"}], ";", 
                RowBox[{"initqAA", "=", "0.5"}], ";", 
                RowBox[{"showMD", "=", "True"}], ";", 
                RowBox[{
                "preset", "=", "\"\<Hauert Doebeli 2004 fig1d r=0.5\>\""}]}], 
               ")"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"\"\<fig1d r=0.9\>\"", "\[RuleDelayed]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"a11", "=", "1"}], ";", 
                RowBox[{"a12", "=", "0.1"}], ";", 
                RowBox[{"a21", "=", "1.9"}], ";", 
                RowBox[{"a22", "=", "0"}], ";", 
                RowBox[{"update", "=", "7000"}], ";", 
                RowBox[{"gameName", "=", "\"\<Snowdrift\>\""}], ";", 
                RowBox[{
                "updateRule", "=", "\"\<Imitative pairwise difference\>\""}], 
                ";", 
                RowBox[{"k", "=", "8"}], ";", 
                RowBox[{"initxA", "=", "0.5"}], ";", 
                RowBox[{"initqAA", "=", "0.5"}], ";", 
                RowBox[{"showMD", "=", "True"}], ";", 
                RowBox[{
                "preset", "=", "\"\<Hauert Doebeli 2004 fig1d r=0.9\>\""}]}], 
               ")"}]}]}], "\[IndentingNewLine]", "}"}]}], 
          "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<Hauert & Szab\[OAcute] (2005)\>\"", "->", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"\"\<fig5 r=0\>\"", "\[RuleDelayed]", 
              RowBox[{"(", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"a11", "=", "1"}], ";", 
                RowBox[{"a12", "=", "0"}], ";", 
                RowBox[{"a21", "=", "1"}], ";", 
                RowBox[{"a22", "=", "0"}], ";", 
                RowBox[{"update", "=", "15500"}], ";", 
                RowBox[{"gameName", "=", "\"\<Weak Prisoner's D\>\""}], ";", 
                RowBox[{
                "updateRule", "=", 
                 "\"\<Fermi (set intensity \
\!\(\*StyleBox[\"m\",FontSlant->\"Italic\"]\))\>\""}], ";", 
                RowBox[{"k", "=", "4"}], ";", 
                RowBox[{"m", "=", "40"}], ";", 
                RowBox[{"initxA", "=", "0.5"}], ";", 
                RowBox[{"initqAA", "=", "0.5"}], ";", 
                RowBox[{"showMD", "=", "False"}], ";", 
                RowBox[{"maxTimeOut", "=", "20"}], ";", 
                RowBox[{
                "preset", "=", 
                 "\"\<Hauert Szab\[OAcute] 2005 fig5 r=0.01\>\""}]}], ")"}]}],
              ",", "\[IndentingNewLine]", 
             RowBox[{"\"\<fig5 r=0.01\>\"", "\[RuleDelayed]", 
              RowBox[{"(", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"a11", "=", "1"}], ";", 
                RowBox[{"a12", "=", 
                 RowBox[{"-", ".01"}]}], ";", 
                RowBox[{"a21", "=", "1.01"}], ";", 
                RowBox[{"a22", "=", "0"}], ";", 
                RowBox[{"update", "=", "16000"}], ";", 
                RowBox[{"gameName", "=", "\"\<Prisoner's Dilemma\>\""}], ";", 
                RowBox[{
                "updateRule", "=", 
                 "\"\<Fermi (set intensity \
\!\(\*StyleBox[\"m\",FontSlant->\"Italic\"]\))\>\""}], ";", 
                RowBox[{"k", "=", "4"}], ";", 
                RowBox[{"m", "=", "40"}], ";", 
                RowBox[{"initxA", "=", "0.5"}], ";", 
                RowBox[{"initqAA", "=", "0.5"}], ";", 
                RowBox[{"showMD", "=", "False"}], ";", 
                RowBox[{"maxTimeOut", "=", "20"}], ";", 
                RowBox[{
                "preset", "=", 
                 "\"\<Hauert Szab\[OAcute] 2005 fig5 r=0.01\>\""}]}], ")"}]}],
              ",", "\[IndentingNewLine]", 
             RowBox[{"\"\<fig5 r=0.02\>\"", "\[RuleDelayed]", 
              RowBox[{"(", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"a11", "=", "1"}], ";", 
                RowBox[{"a12", "=", 
                 RowBox[{"-", ".02"}]}], ";", 
                RowBox[{"a21", "=", "1.02"}], ";", 
                RowBox[{"a22", "=", "0"}], ";", 
                RowBox[{"update", "=", "17000"}], ";", 
                RowBox[{"gameName", "=", "\"\<Prisoner's Dilemma\>\""}], ";", 
                RowBox[{
                "updateRule", "=", 
                 "\"\<Fermi (set intensity \
\!\(\*StyleBox[\"m\",FontSlant->\"Italic\"]\))\>\""}], ";", 
                RowBox[{"k", "=", "4"}], ";", 
                RowBox[{"m", "=", "40"}], ";", 
                RowBox[{"initxA", "=", "0.5"}], ";", 
                RowBox[{"initqAA", "=", "0.5"}], ";", 
                RowBox[{"showMD", "=", "False"}], ";", 
                RowBox[{"maxTimeOut", "=", "20"}], ";", 
                RowBox[{
                "preset", "=", 
                 "\"\<Hauert Szab\[OAcute] 2005 fig5 r=0.02\>\""}]}], ")"}]}],
              ",", "\[IndentingNewLine]", 
             RowBox[{"\"\<fig5 r=0.06\>\"", "\[RuleDelayed]", 
              RowBox[{"(", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"a11", "=", "1"}], ";", 
                RowBox[{"a12", "=", 
                 RowBox[{"-", ".06"}]}], ";", 
                RowBox[{"a21", "=", "1.06"}], ";", 
                RowBox[{"a22", "=", "0"}], ";", 
                RowBox[{"update", "=", "18000"}], ";", 
                RowBox[{"gameName", "=", "\"\<Prisoner's Dilemma\>\""}], ";", 
                RowBox[{
                "updateRule", "=", 
                 "\"\<Fermi (set intensity \
\!\(\*StyleBox[\"m\",FontSlant->\"Italic\"]\))\>\""}], ";", 
                RowBox[{"k", "=", "4"}], ";", 
                RowBox[{"m", "=", "40"}], ";", 
                RowBox[{"initxA", "=", "0.5"}], ";", 
                RowBox[{"initqAA", "=", "0.5"}], ";", 
                RowBox[{"showMD", "=", "False"}], ";", 
                RowBox[{"maxTimeOut", "=", "20"}], ";", 
                RowBox[{
                "preset", "=", 
                 "\"\<Hauert Szab\[OAcute] 2005 fig5 r=0.02\>\""}]}], 
               ")"}]}]}], "\[IndentingNewLine]", "}"}]}], 
          "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<Fu, Nowak & Hauert (2010)\>\"", "->", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"\"\<fig4a,b u=0.02\>\"", "\[RuleDelayed]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"a11", "=", "1"}], ";", 
                RowBox[{"a12", "=", "0"}], ";", 
                RowBox[{"a21", "=", "1.02"}], ";", 
                RowBox[{"a22", "=", "0.02"}], ";", 
                RowBox[{"update", "=", "8000"}], ";", 
                RowBox[{"gameName", "=", "\"\<Prisoner's Dilemma\>\""}], ";", 
                RowBox[{
                "updateRule", "=", "\"\<Imitative pairwise difference\>\""}], 
                ";", 
                RowBox[{"k", "=", "8"}], ";", 
                RowBox[{"initxA", "=", "0.01"}], ";", 
                RowBox[{"initqAA", "=", "0.7"}], ";", 
                RowBox[{"showMD", "=", "False"}], ";", 
                RowBox[{
                "preset", "=", "\"\<Fu et al 2010 fig4ab u=0.02\>\""}]}], 
               ")"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"\"\<fig4a,b u=0.1\>\"", "\[RuleDelayed]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"a11", "=", "1"}], ";", 
                RowBox[{"a12", "=", "0"}], ";", 
                RowBox[{"a21", "=", "1.1"}], ";", 
                RowBox[{"a22", "=", "0.1"}], ";", 
                RowBox[{"update", "=", "9000"}], ";", 
                RowBox[{"gameName", "=", "\"\<Prisoner's Dilemma\>\""}], ";", 
                RowBox[{
                "updateRule", "=", "\"\<Imitative pairwise difference\>\""}], 
                ";", 
                RowBox[{"k", "=", "8"}], ";", 
                RowBox[{"initxA", "=", "0.01"}], ";", 
                RowBox[{"initqAA", "=", "0.7"}], ";", 
                RowBox[{"showMD", "=", "False"}], ";", 
                RowBox[{
                "preset", "=", "\"\<Fu et al 2010 fig4ab u=0.1\>\""}]}], 
               ")"}]}], ",", "\[IndentingNewLine]", "Delimiter", ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<fig4d,e v=0.05\>\"", "\[RuleDelayed]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"a11", "=", "1"}], ";", 
                RowBox[{"a12", "=", "0.95"}], ";", 
                RowBox[{"a21", "=", "1.05"}], ";", 
                RowBox[{"a22", "=", "0"}], ";", 
                RowBox[{"update", "=", "10000"}], ";", 
                RowBox[{"gameName", "=", "\"\<Snowdrift\>\""}], ";", 
                RowBox[{
                "updateRule", "=", "\"\<Imitative pairwise difference\>\""}], 
                ";", 
                RowBox[{"k", "=", "8"}], ";", 
                RowBox[{"initxA", "=", "0.01"}], ";", 
                RowBox[{"initqAA", "=", "0.7"}], ";", 
                RowBox[{"showMD", "=", "False"}], ";", 
                RowBox[{
                "preset", "=", "\"\<Fu et al 2010 fig4de v=0.05\>\""}]}], 
               ")"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"\"\<fig4d,e v=0.4\>\"", "\[RuleDelayed]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"a11", "=", "1"}], ";", 
                RowBox[{"a12", "=", "0.6"}], ";", 
                RowBox[{"a21", "=", "1.4"}], ";", 
                RowBox[{"a22", "=", "0"}], ";", 
                RowBox[{"update", "=", "11000"}], ";", 
                RowBox[{"gameName", "=", "\"\<Snowdrift\>\""}], ";", 
                RowBox[{
                "updateRule", "=", "\"\<Imitative pairwise difference\>\""}], 
                ";", 
                RowBox[{"k", "=", "8"}], ";", 
                RowBox[{"initxA", "=", "0.01"}], ";", 
                RowBox[{"initqAA", "=", "0.7"}], ";", 
                RowBox[{"showMD", "=", "False"}], ";", 
                RowBox[{
                "preset", "=", "\"\<Fu et al 2010 fig4de v=0.4\>\""}]}], 
               ")"}]}], ",", "\[IndentingNewLine]", "Delimiter", ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<fig6a u=0.05\>\"", "\[RuleDelayed]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"a11", "=", "1"}], ";", 
                RowBox[{"a12", "=", "0"}], ";", 
                RowBox[{"a21", "=", "1.05"}], ";", 
                RowBox[{"a22", "=", "0.05"}], ";", 
                RowBox[{"update", "=", "12000"}], ";", 
                RowBox[{"gameName", "=", "\"\<Prisoner's Dilemma\>\""}], ";", 
                RowBox[{
                "updateRule", "=", "\"\<Imitative pairwise difference\>\""}], 
                ";", 
                RowBox[{"k", "=", "8"}], ";", 
                RowBox[{"initxA", "=", "0.01"}], ";", 
                RowBox[{"initqAA", "=", "0.7"}], ";", 
                RowBox[{"showMD", "=", "True"}], ";", 
                RowBox[{
                "preset", "=", "\"\<Fu et al 2010 fig6a u=0.05\>\""}]}], 
               ")"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"\"\<fig6a u=0.15\>\"", "\[RuleDelayed]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"a11", "=", "1"}], ";", 
                RowBox[{"a12", "=", "0"}], ";", 
                RowBox[{"a21", "=", "1.15"}], ";", 
                RowBox[{"a22", "=", "0.15"}], ";", 
                RowBox[{"update", "=", "13000"}], ";", 
                RowBox[{"gameName", "=", "\"\<Prisoner's Dilemma\>\""}], ";", 
                RowBox[{
                "updateRule", "=", "\"\<Imitative pairwise difference\>\""}], 
                ";", 
                RowBox[{"k", "=", "8"}], ";", 
                RowBox[{"initxA", "=", "0.01"}], ";", 
                RowBox[{"initqAA", "=", "0.7"}], ";", 
                RowBox[{"showMD", "=", "True"}], ";", 
                RowBox[{
                "preset", "=", "\"\<Fu et al 2010 fig6a u=0.15\>\""}]}], 
               ")"}]}], ",", "\[IndentingNewLine]", "Delimiter", ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<fig6c v=0.5\>\"", "\[RuleDelayed]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"a11", "=", "1"}], ";", 
                RowBox[{"a12", "=", "0.5"}], ";", 
                RowBox[{"a21", "=", "1.5"}], ";", 
                RowBox[{"a22", "=", "0"}], ";", 
                RowBox[{"update", "=", "14000"}], ";", 
                RowBox[{"gameName", "=", "\"\<Snowdrift\>\""}], ";", 
                RowBox[{
                "updateRule", "=", "\"\<Imitative pairwise difference\>\""}], 
                ";", 
                RowBox[{"k", "=", "8"}], ";", 
                RowBox[{"initxA", "=", "0.01"}], ";", 
                RowBox[{"initqAA", "=", "0.7"}], ";", 
                RowBox[{"showMD", "=", "True"}], ";", 
                RowBox[{
                "preset", "=", "\"\<Fu et al 2010 fig6c v=0.5\>\""}]}], 
               ")"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"\"\<fig6c v=1\>\"", "\[RuleDelayed]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"a11", "=", "1"}], ";", 
                RowBox[{"a12", "=", "0"}], ";", 
                RowBox[{"a21", "=", "2"}], ";", 
                RowBox[{"a22", "=", "0"}], ";", 
                RowBox[{"update", "=", "15000"}], ";", 
                RowBox[{"gameName", "=", "\"\<Snowdrift\>\""}], ";", 
                RowBox[{
                "updateRule", "=", "\"\<Imitative pairwise difference\>\""}], 
                ";", 
                RowBox[{"k", "=", "8"}], ";", 
                RowBox[{"initxA", "=", "0.01"}], ";", 
                RowBox[{"initqAA", "=", "0.7"}], ";", 
                RowBox[{"showMD", "=", "True"}], ";", 
                RowBox[{"preset", "=", "\"\<Fu et al 2010 fig6c v=1\>\""}]}], 
               ")"}]}]}], "\[IndentingNewLine]", "}"}]}]}], 
         "\[IndentingNewLine]", "}"}], ",", 
        RowBox[{"Appearance", "\[Rule]", "\"\<PopupMenu\>\""}], ",", 
        RowBox[{"ImageSize", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"220", ",", "20"}], "}"}]}]}], "]"}], "}"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "220"}], ",", 
     RowBox[{"Alignment", "\[Rule]", "Center"}]}], "]"}], ",", 
   "\[IndentingNewLine]", "Delimiter", ",", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Style", "[", 
    RowBox[{
    "\"\<Payoffs (\!\(\*SubscriptBox[\(\[CapitalPi]\), \(ij\)]\))\>\"", ",", 
     "Bold", ",", "Medium"}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Row", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ActionMenu", "[", 
       RowBox[{
        RowBox[{"Dynamic", "[", "gameName", "]"}], ",", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\"\<Snowdrift\>\"", "\[RuleDelayed]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a11", "=", "3"}], ",", 
             RowBox[{"a12", "=", "1"}], ",", 
             RowBox[{"a21", "=", "4"}], ",", 
             RowBox[{"a22", "=", "0"}], ",", 
             RowBox[{
              RowBox[{"update", "=", "500"}], ";", 
              RowBox[{"gameName", "=", "\"\<Snowdrift\>\""}]}], ",", 
             RowBox[{"preset", "=", "\"\<Presets\>\""}]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<Prisoner's Dilemma\>\"", "\[RuleDelayed]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a11", "=", "3"}], ",", 
             RowBox[{"a12", "=", "0"}], ",", 
             RowBox[{"a21", "=", "4"}], ",", 
             RowBox[{"a22", "=", "1"}], ",", 
             RowBox[{
              RowBox[{"update", "=", "1000"}], ";", 
              RowBox[{"gameName", "=", "\"\<Prisoner's Dilemma\>\""}]}], ",", 
             RowBox[{"preset", "=", "\"\<Presets\>\""}]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<Coordination\>\"", "\[RuleDelayed]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a11", "=", "2"}], ",", 
             RowBox[{"a12", "=", "0"}], ",", 
             RowBox[{"a21", "=", "0"}], ",", 
             RowBox[{"a22", "=", "1"}], ",", 
             RowBox[{
              RowBox[{"update", "=", "2000"}], ";", 
              RowBox[{"gameName", "=", "\"\<Coordination\>\""}]}], ",", 
             RowBox[{"preset", "=", "\"\<Presets\>\""}]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<All 0s\>\"", "\[RuleDelayed]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a11", "=", "0"}], ",", 
             RowBox[{"a12", "=", "0"}], ",", 
             RowBox[{"a21", "=", "0"}], ",", 
             RowBox[{"a22", "=", "0"}], ",", 
             RowBox[{
              RowBox[{"update", "=", "3000"}], ";", 
              RowBox[{"gameName", "=", "\"\<All 0s\>\""}]}], ",", 
             RowBox[{"preset", "=", "\"\<Presets\>\""}]}], "}"}]}]}], 
         "\[IndentingNewLine]", "}"}], ",", 
        RowBox[{"Appearance", "\[Rule]", "\"\<PopupMenu\>\""}], ",", 
        RowBox[{"ImageSize", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"150", ",", "20"}], "}"}]}]}], "]"}], "}"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "180"}], ",", 
     RowBox[{"Alignment", "\[Rule]", "Center"}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Grid", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<              \>\"", ",", 
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "a11", ",", "1", ",", 
              "\"\<\!\(\*SubscriptBox[\(\[CapitalPi]\), \(\(A\)\(\[CenterDot]\
\)\)]\)\>\""}], "}"}], ",", 
            RowBox[{
             RowBox[{"InputField", "[", 
              RowBox[{
               RowBox[{"Dynamic", "[", 
                RowBox[{"a11", ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"a11", "=", 
                    RowBox[{"ForceNumber", "[", "#", "]"}]}], ")"}], "&"}]}], 
                "]"}], ",", "Number", ",", 
               RowBox[{"FieldSize", "\[Rule]", "4"}]}], "]"}], "&"}]}], "}"}],
           "]"}], " ", ",", "\[IndentingNewLine]", 
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"a12", ",", "0.8", ",", "\"\<\>\""}], "}"}], ",", 
            RowBox[{
             RowBox[{"InputField", "[", 
              RowBox[{
               RowBox[{"Dynamic", "[", 
                RowBox[{"a12", ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"a12", "=", 
                    RowBox[{"ForceNumber", "[", "#", "]"}]}], ")"}], "&"}]}], 
                "]"}], ",", "Number", ",", 
               RowBox[{"FieldSize", "\[Rule]", "4"}]}], "]"}], "&"}]}], "}"}],
           "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"\"\<\>\"", ",", 
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "a21", ",", "1.2", ",", 
              "\"\<\!\(\*SubscriptBox[\(\[CapitalPi]\), \(\(B\)\(\[CenterDot]\
\)\)]\)\>\""}], "}"}], ",", 
            RowBox[{
             RowBox[{"InputField", "[", 
              RowBox[{
               RowBox[{"Dynamic", "[", 
                RowBox[{"a21", ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"a21", "=", 
                    RowBox[{"ForceNumber", "[", "#", "]"}]}], ")"}], "&"}]}], 
                "]"}], ",", "Number", ",", 
               RowBox[{"FieldSize", "\[Rule]", "4"}]}], "]"}], "&"}]}], "}"}],
           "]"}], " ", ",", "\[IndentingNewLine]", 
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"a22", ",", "0", ",", "\"\<\>\""}], "}"}], ",", 
            RowBox[{
             RowBox[{"InputField", "[", 
              RowBox[{
               RowBox[{"Dynamic", "[", 
                RowBox[{"a22", ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"a22", "=", 
                    RowBox[{"ForceNumber", "[", "#", "]"}]}], ")"}], "&"}]}], 
                "]"}], ",", "Number", ",", 
               RowBox[{"FieldSize", "\[Rule]", "4"}]}], "]"}], "&"}]}], "}"}],
           "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}], ",", " ", 
     RowBox[{"Alignment", "\[Rule]", "Right"}]}], "]"}], 
   "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
   RowBox[{"Button", "[", 
    RowBox[{"\"\<Update\>\"", ",", 
     RowBox[{
      RowBox[{"update", "++"}], ";", 
      RowBox[{"gameName", "=", "\"\<Predefined games\>\""}], ";", 
      RowBox[{"preset", "=", "\"\<Presets\>\""}]}], ",", 
     RowBox[{"ImageSize", "->", "180"}]}], "]"}], ",", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "Delimiter", ",", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Style", "[", 
    RowBox[{"\"\<Degree of regular network\>\"", ",", "Bold", ",", "Medium"}],
     "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Control", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "k", ",", "8", ",", 
        "\"\<\!\(\*StyleBox[\"k\",FontSlant->\"Italic\"]\)\>\""}], "}"}], ",",
       "2", ",", "10", ",", "1", " ", ",", 
      RowBox[{"ImageSize", "\[Rule]", "Small"}], " ", ",", 
      RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], "]"}], 
   ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "Delimiter", ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Grid", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Style", "[", 
         RowBox[{"\"\<Decision rule\>\"", ",", "Bold", ",", "Medium"}], "]"}],
         "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"Control", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "updateRule", ",", "\"\<Imitative pairwise difference\>\"", ",", 
             "\"\<\>\""}], "}"}], ",", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
            "\"\<Imitative pairwise difference\>\"", ",", 
             "\[IndentingNewLine]", "\"\<Imitate if better, all nbrs\>\"", 
             ",", "\[IndentingNewLine]", 
             "\"\<Fermi (set intensity \
\!\(\*StyleBox[\"m\",FontSlant->\"Italic\"]\))\>\"", ",", 
             "\[IndentingNewLine]", "\"\<Best neighbor\>\""}], 
            "\[IndentingNewLine]", "}"}], ",", 
           RowBox[{"ControlType", "\[Rule]", "PopupMenu"}], ",", 
           RowBox[{"MenuStyle", "\[Rule]", "12"}]}], "}"}], "]"}], "}"}]}], 
      "\[IndentingNewLine]", "}"}], ",", 
     RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}], "\[IndentingNewLine]",
    ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Control", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "m", ",", "1", " ", ",", 
        "\"\<Fermi's \!\(\*StyleBox[\"m\",FontSlant->\"Italic\"]\)\>\""}], 
       "}"}], ",", "0.5", ",", "40", ",", "0.01", " ", ",", 
      RowBox[{"ImageSize", "\[Rule]", "Small"}], " ", ",", 
      RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], "]"}], 
   ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "Delimiter", ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Style", "[", 
    RowBox[{"\"\<Initial conditions\>\"", ",", "Bold", ",", "Medium"}], "]"}],
    ",", "\[IndentingNewLine]", 
   RowBox[{"Control", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "initxA", ",", "0.5", ",", 
        "\"\<\!\(\*SubscriptBox[StyleBox[\"x\",FontSlant->\"Italic\"], \"A\"]\
\)\!\(\*StyleBox[\"(\",FontWeight->\"Plain\"]\)\!\(\*StyleBox[\"0\",\
FontWeight->\"Plain\"]\)\!\(\*StyleBox[\")\",FontWeight->\"Plain\"]\)\>\""}], 
       "}"}], ",", "0.01", ",", "0.99", ",", "0.01", " ", ",", 
      RowBox[{"ImageSize", "\[Rule]", "Small"}], " ", ",", 
      RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], "]"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"Control", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "initqAA", ",", "0.5", ",", 
        "\"\<\!\(\*SubscriptBox[StyleBox[\"q\",FontSlant->\"Italic\"], \
\"AA\"]\)\!\(\*StyleBox[\"(\",FontWeight->\"Plain\"]\)\!\(\*StyleBox[\"0\",\
FontWeight->\"Plain\"]\)\!\(\*StyleBox[\")\",FontWeight->\"Plain\"]\)\>\""}], 
       "}"}], ",", "0.01", ",", "0.99", ",", "0.01", " ", ",", 
      RowBox[{"ImageSize", "\[Rule]", "Small"}], " ", ",", 
      RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], "]"}], 
   ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "Delimiter", ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Style", "[", 
    RowBox[{"\"\<Mean Dynamic (MD)\>\"", ",", "Bold", ",", "Medium"}], "]"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"Control", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"showMD", ",", "True", ",", "\"\<Show MD\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"True", ",", "False"}], "}"}], " ", ",", 
      RowBox[{"ImageSize", "\[Rule]", "Small"}], " ", ",", 
      RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], "]"}], 
   ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "Delimiter", ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Style", "[", 
    RowBox[{
    "\"\<Time allowed for computations\>\"", ",", "Bold", ",", "Medium"}], 
    "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Control", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"maxTimeOut", ",", "1", ",", "\"\<maxTimeOut (s)\>\""}], "}"}],
       ",", "1", ",", "20", ",", "1", ",", 
      RowBox[{"ImageSize", "\[Rule]", "Small"}], ",", 
      RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], "]"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Row", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Control", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"maxTimeOut", ",", "1", ",", "\"\<maxTimeOut\>\""}], 
            "}"}], ",", "1", ",", "20", ",", "1", ",", 
           RowBox[{"ImageSize", "\[Rule]", "Small"}]}], " ", "}"}], "]"}], 
        ",", 
        RowBox[{"Spacer", "[", "5", "]"}], ",", 
        RowBox[{"Dynamic", "@", "maxTimeOut"}], ",", "\"\<s\>\""}], "}"}], 
      "]"}], ","}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"OTHER", " ", "MANIPULATE", " ", "OPTIONS"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"SaveDefinitions", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
   RowBox[{"TrackedSymbols", "\[RuleDelayed]", 
    RowBox[{"{", 
     RowBox[{
     "update", ",", "updateRule", ",", "k", ",", "m", ",", "initxA", ",", 
      "initqAA", ",", "showMD", ",", "maxTimeOut"}], "}"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Alignment", "\[Rule]", "Top"}], " ", ",", "\[IndentingNewLine]", 
   RowBox[{"ControlPlacement", "\[Rule]", "Left"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"SynchronousUpdating", "\[Rule]", "False"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"ContinuousAction", "\[Rule]", "True"}], ",", " ", 
   "\[IndentingNewLine]", 
   RowBox[{"AppearanceElements", "\[Rule]", "None"}], "  ", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "This", " ", "conceals", " ", "the", " ", "menu", " ", "with", " ", 
      "the", " ", 
      RowBox[{"bookmarks", ".", " ", "The"}], " ", 
      "\"\<Animate bookmarks\>\"", " ", "feature", " ", "creates", " ", 
      "problems", " ", "if", " ", "bookmarks", " ", "do", " ", "not", " ", 
      "set", " ", "the", " ", "values", " ", "of", " ", "all", " ", 
      RowBox[{"parameters", ".", " ", "For"}], " ", "such", " ", "cases"}], 
     ",", " ", 
     RowBox[{
     "a", " ", "nice", " ", "workaround", " ", "is", " ", "to", " ", 
      "implement", " ", "the", " ", "\"\<bookmark\>\"", " ", "feature", " ", 
      "using", " ", "an", " ", "ActionMenu"}], ",", " ", 
     RowBox[{"as", " ", "it", " ", "is", " ", "done", " ", 
      RowBox[{"here", "."}]}]}], " ", "*)"}], ",", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", "INTIALIZATION", " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Initialization", "\[RuleDelayed]", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Off", "[", 
        RowBox[{"NDSolveValue", "::", "ndsz"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Off", "[", 
        RowBox[{"NDSolveValue", "::", "ndcf"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Off", "[", 
        RowBox[{"InterpolatingFunction", "::", "dmval"}], "]"}], ";"}], 
      "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Off", "[", 
       RowBox[{"General", "::", "munfl"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "INTERFACE", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ForceNumber", "[", "n_", "]"}], ":=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"NumberQ", "[", "n", "]"}], ",", "n", ",", "0"}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"PAYOFF", " ", "FUNCTIONS"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"For", " ", "Mean", " ", "Dynamic"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[CapitalPi]A", "[", 
        RowBox[{"x_", ",", "\[CapitalPi]AA_", ",", "\[CapitalPi]AB_"}], "]"}],
        ":=", 
       RowBox[{
        RowBox[{"x", " ", "\[CapitalPi]AA"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "x"}], ")"}], "\[CapitalPi]AB"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[CapitalPi]B", "[", 
        RowBox[{"x_", ",", "\[CapitalPi]BA_", ",", "\[CapitalPi]BB_"}], "]"}],
        ":=", 
       RowBox[{
        RowBox[{"x", " ", "\[CapitalPi]BA"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "x"}], ")"}], "\[CapitalPi]BB"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"For", " ", "Pair", " ", "approximation"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[CapitalPi]A", "[", 
        RowBox[{
        "kA_", ",", "k_", ",", "\[CapitalPi]AA_", ",", "\[CapitalPi]AB_"}], 
        "]"}], ":=", 
       FractionBox[
        RowBox[{
         RowBox[{"kA", " ", "\[CapitalPi]AA"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"k", "-", "kA"}], ")"}], "\[CapitalPi]AB"}]}], "k"]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[CapitalPi]B", "[", 
        RowBox[{
        "kA_", ",", "k_", ",", "\[CapitalPi]BA_", ",", "\[CapitalPi]BB_"}], 
        "]"}], ":=", 
       FractionBox[
        RowBox[{
         RowBox[{"kA", " ", "\[CapitalPi]BA"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"k", "-", "kA"}], ")"}], "\[CapitalPi]BB"}]}], "k"]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"MEAN", " ", "DYNAMIC"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ExpectedChange", "[", 
        RowBox[{"maxDiff_", ",", "mR_", ",", "payoffs_", ",", "\[Rho]A_"}], 
        "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\[CapitalPi]AA", ",", "\[CapitalPi]AB", ",", "\[CapitalPi]BA", ",",
            "\[CapitalPi]BB", ",", 
           RowBox[{"\[Rho]B", "=", 
            RowBox[{"1", "-", "\[Rho]A"}]}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "\[CapitalPi]AA", ",", "\[CapitalPi]AB", ",", "\[CapitalPi]BA", 
             ",", "\[CapitalPi]BB"}], "}"}], "=", "payoffs"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Switch", "[", 
           RowBox[{
           "updateRule", ",", "\[IndentingNewLine]", 
            "\"\<Imitate if better, all nbrs\>\"", ",", 
            RowBox[{"\[Rho]B", " ", "\[Rho]A", " ", 
             RowBox[{"Piecewise", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{
                    RowBox[{"\[CapitalPi]A", "[", 
                    RowBox[{
                    "\[Rho]A", ",", "\[CapitalPi]AA", ",", "\[CapitalPi]AB"}],
                     "]"}], ">", 
                    RowBox[{"\[CapitalPi]B", "[", 
                    RowBox[{
                    "\[Rho]A", ",", "\[CapitalPi]BA", ",", "\[CapitalPi]BB"}],
                     "]"}]}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "1"}], ",", 
                   RowBox[{
                    RowBox[{"\[CapitalPi]A", "[", 
                    RowBox[{
                    "\[Rho]A", ",", "\[CapitalPi]AA", ",", "\[CapitalPi]AB"}],
                     "]"}], "<", 
                    RowBox[{"\[CapitalPi]B", "[", 
                    RowBox[{
                    "\[Rho]A", ",", "\[CapitalPi]BA", ",", "\[CapitalPi]BB"}],
                     "]"}]}]}], "}"}]}], "}"}], ",", "0"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"\"\<Imitate if better, all nbrs\>\"", ",", 
              RowBox[{
               SubscriptBox["x", 
                RowBox[{"B", " "}]], "\[Rho]A", " ", 
               RowBox[{"Sign", "[", 
                RowBox[{
                 RowBox[{"\[CapitalPi]A", "[", "\[Rho]A", "]"}], "-", 
                 RowBox[{"\[CapitalPi]B", "[", "\[Rho]A", "]"}]}], "]"}]}], 
              ","}], "*)"}], "\[IndentingNewLine]", 
            "\"\<Fermi (set intensity \
\!\(\*StyleBox[\"m\",FontSlant->\"Italic\"]\))\>\"", ",", 
            RowBox[{"\[Rho]B", " ", "\[Rho]A", 
             FractionBox[
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{"m", " ", 
                 RowBox[{"\[CapitalPi]A", "[", 
                  RowBox[{
                  "\[Rho]A", ",", "\[CapitalPi]AA", ",", "\[CapitalPi]AB"}], 
                  "]"}]}], "]"}], "-", 
               RowBox[{"Exp", "[", 
                RowBox[{"m", " ", 
                 RowBox[{"\[CapitalPi]B", "[", 
                  RowBox[{
                  "\[Rho]A", ",", "\[CapitalPi]BA", ",", "\[CapitalPi]BB"}], 
                  "]"}]}], "]"}]}], 
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{"m", " ", 
                 RowBox[{"\[CapitalPi]A", "[", 
                  RowBox[{
                  "\[Rho]A", ",", "\[CapitalPi]AA", ",", "\[CapitalPi]AB"}], 
                  "]"}]}], "]"}], "+", 
               RowBox[{"Exp", "[", 
                RowBox[{"m", " ", 
                 RowBox[{"\[CapitalPi]B", "[", 
                  RowBox[{
                  "\[Rho]A", ",", "\[CapitalPi]BA", ",", "\[CapitalPi]BB"}], 
                  "]"}]}], "]"}]}]]}], ",", "\[IndentingNewLine]", 
            "\"\<Imitative pairwise difference\>\"", ",", 
            RowBox[{"\[Rho]B", " ", "\[Rho]A", 
             FractionBox[
              RowBox[{
               RowBox[{"\[CapitalPi]A", "[", 
                RowBox[{
                "\[Rho]A", ",", "\[CapitalPi]AA", ",", "\[CapitalPi]AB"}], 
                "]"}], "-", 
               RowBox[{"\[CapitalPi]B", "[", 
                RowBox[{
                "\[Rho]A", ",", "\[CapitalPi]BA", ",", "\[CapitalPi]BB"}], 
                "]"}]}], "maxDiff"]}], ",", "\[IndentingNewLine]", 
            "\"\<Best neighbor\>\"", ",", 
            RowBox[{
             RowBox[{"\[Rho]B", " ", 
              RowBox[{"Piecewise", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"BePositive", "[", 
                    RowBox[{
                    RowBox[{"\[CapitalPi]A", "[", 
                    RowBox[{
                    "\[Rho]A", ",", "\[CapitalPi]AA", ",", "\[CapitalPi]AB"}],
                     "]"}], "-", 
                    RowBox[{"\[CapitalPi]B", "[", 
                    RowBox[{
                    "\[Rho]A", ",", "\[CapitalPi]BA", ",", "\[CapitalPi]BB"}],
                     "]"}]}], "]"}], ",", 
                   RowBox[{"\[Rho]A", ">", "0"}]}], "}"}], "}"}], ",", "0"}], 
               "]"}]}], "-", 
             RowBox[{"\[Rho]A", " ", 
              RowBox[{"Piecewise", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"BePositive", "[", 
                    RowBox[{
                    RowBox[{"\[CapitalPi]B", "[", 
                    RowBox[{
                    "\[Rho]A", ",", "\[CapitalPi]BA", ",", "\[CapitalPi]BB"}],
                     "]"}], "-", 
                    RowBox[{"\[CapitalPi]A", "[", 
                    RowBox[{
                    "\[Rho]A", ",", "\[CapitalPi]AA", ",", "\[CapitalPi]AB"}],
                     "]"}]}], "]"}], ",", 
                   RowBox[{"\[Rho]B", ">", "0"}]}], "}"}], "}"}], ",", "0"}], 
               "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "Mathematica", " ", "cannot", " ", "realiably", " ", "solve", " ", 
         "the", " ", "mean", " ", "dynamic", " ", "of", " ", 
         "\"\<Imitate if better, all nbrs\>\""}], ",", " ", 
        RowBox[{
        "so", " ", "we", " ", "solved", " ", "it", " ", "analytically"}]}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"MDsolutionImitateIfBetterAllNbrs", "[", 
        RowBox[{"initialxA_", ",", "payoffs_"}], "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\[CapitalPi]AA", ",", "\[CapitalPi]AB", ",", "\[CapitalPi]BA", ",",
            "\[CapitalPi]BB", ",", "interiorEq"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "\[CapitalPi]AA", ",", "\[CapitalPi]AB", ",", "\[CapitalPi]BA", 
             ",", "\[CapitalPi]BB"}], "}"}], "=", "payoffs"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"interiorEq", "=", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
              "\[CapitalPi]AA", "-", "\[CapitalPi]AB", "-", "\[CapitalPi]BA", 
               "+", "\[CapitalPi]BB"}], "==", "0"}], ",", 
             RowBox[{"-", "1"}], ",", 
             FractionBox[
              RowBox[{"\[CapitalPi]BB", "-", "\[CapitalPi]AB"}], 
              RowBox[{
              "\[CapitalPi]AA", "-", "\[CapitalPi]AB", "-", "\[CapitalPi]BA", 
               "+", "\[CapitalPi]BB"}]]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Function", "[", 
           RowBox[{
            RowBox[{"{", "t", "}"}], ",", 
            RowBox[{"Piecewise", "[", 
             RowBox[{
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Min", "[", 
                   RowBox[{
                    FractionBox["initialxA", 
                    RowBox[{
                    RowBox[{
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"-", "t"}]], 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "initialxA"}], ")"}]}], "+", 
                    "initialxA"}]], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"And", "[", 
                    RowBox[{
                    RowBox[{"0", "<", "interiorEq", "<", "1"}], ",", 
                    RowBox[{"initialxA", "<", "interiorEq"}]}], "]"}], ",", 
                    "interiorEq", ",", "1"}], "]"}]}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"\[CapitalPi]A", "[", 
                    RowBox[{
                    "initialxA", ",", "\[CapitalPi]AA", ",", 
                    "\[CapitalPi]AB"}], "]"}], ">", 
                   RowBox[{"\[CapitalPi]B", "[", 
                    RowBox[{
                    "initialxA", ",", "\[CapitalPi]BA", ",", 
                    "\[CapitalPi]BB"}], "]"}]}]}], "}"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Max", "[", 
                   RowBox[{
                    FractionBox["initialxA", 
                    RowBox[{
                    RowBox[{
                    SuperscriptBox["\[ExponentialE]", "t"], 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "initialxA"}], ")"}]}], "+", 
                    "initialxA"}]], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"And", "[", 
                    RowBox[{
                    RowBox[{"0", "<", "interiorEq", "<", "1"}], ",", 
                    RowBox[{"initialxA", ">", "interiorEq"}]}], "]"}], ",", 
                    "interiorEq", ",", "0"}], "]"}]}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"\[CapitalPi]A", "[", 
                    RowBox[{
                    "initialxA", ",", "\[CapitalPi]AA", ",", 
                    "\[CapitalPi]AB"}], "]"}], "<", 
                   RowBox[{"\[CapitalPi]B", "[", 
                    RowBox[{
                    "initialxA", ",", "\[CapitalPi]BA", ",", 
                    "\[CapitalPi]BB"}], "]"}]}]}], "}"}]}], 
               "\[IndentingNewLine]", "}"}], ",", "initialxA"}], "]"}]}], 
           "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"NEIGHBORHOOD", " ", "CONFIGURATIONS"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"PA", "[", 
        RowBox[{"kA_", ",", "k_", ",", "qAA_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"Binomial", "[", 
         RowBox[{"k", ",", "kA"}], "]"}], 
        SuperscriptBox[
         RowBox[{"(", "qAA", ")"}], "kA"], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", "qAA"}], ")"}], 
         RowBox[{"k", "-", "kA"}]]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"PB", "[", 
        RowBox[{"kA_", ",", "k_", ",", "qAB_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"Binomial", "[", 
         RowBox[{"k", ",", "kA"}], "]"}], 
        SuperscriptBox[
         RowBox[{"(", "qAB", ")"}], "kA"], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", "qAB"}], ")"}], 
         RowBox[{"k", "-", "kA"}]]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"PAOneB", "[", 
        RowBox[{"kA_", ",", "k_", ",", "qAA_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"Binomial", "[", 
         RowBox[{
          RowBox[{"k", "-", "1"}], ",", "kA"}], "]"}], 
        SuperscriptBox[
         RowBox[{"(", "qAA", ")"}], "kA"], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", "qAA"}], ")"}], 
         RowBox[{"k", "-", "1", "-", "kA"}]]}]}], " ", ";", 
      RowBox[{"(*", " ", 
       RowBox[{"kA", " ", "<=", " ", 
        RowBox[{"k", "-", "1"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"PBOneA", "[", 
        RowBox[{"kA_", ",", "k_", ",", "qAB_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"Binomial", "[", 
         RowBox[{
          RowBox[{"k", "-", "1"}], ",", 
          RowBox[{"kA", "-", "1"}]}], "]"}], 
        SuperscriptBox[
         RowBox[{"(", "qAB", ")"}], 
         RowBox[{"kA", "-", "1"}]], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", "qAB"}], ")"}], 
         RowBox[{"k", "-", "kA"}]]}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"kA", " ", ">=", " ", "1"}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "The", " ", "following", " ", "two", " ", "functions", " ", "are", " ",
         "for", " ", "best", " ", "neighbor", " ", "only"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"PAOneA", "[", 
        RowBox[{"kA_", ",", "k_", ",", "qAA_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"Binomial", "[", 
         RowBox[{
          RowBox[{"k", "-", "1"}], ",", 
          RowBox[{"kA", "-", "1"}]}], "]"}], 
        SuperscriptBox[
         RowBox[{"(", "qAA", ")"}], 
         RowBox[{"kA", "-", "1"}]], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", "qAA"}], ")"}], 
         RowBox[{"k", "-", "kA"}]]}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"kA", " ", ">=", " ", "1"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"PBOneB", "[", 
        RowBox[{"kA_", ",", "k_", ",", "qAB_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"Binomial", "[", 
         RowBox[{
          RowBox[{"k", "-", "1"}], ",", "kA"}], "]"}], 
        SuperscriptBox[
         RowBox[{"(", "qAB", ")"}], "kA"], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", "qAB"}], ")"}], 
         RowBox[{"k", "-", "1", "-", "kA"}]]}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"kA", " ", "<=", " ", 
        RowBox[{"k", "-", "1"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"CONDITIONAL", " ", "SWITCHING", " ", "PROBABILITIES"}], " ", 
       "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FA", "[", 
        RowBox[{
        "kA_", ",", "k_", ",", "maxDiff_", ",", "m_", ",", "payoffs_", ",", 
         "qAA_", ",", "qAB_"}], "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\[CapitalPi]AA", ",", "\[CapitalPi]AB", ",", "\[CapitalPi]BA", ",",
            "\[CapitalPi]BB"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "\[CapitalPi]AA", ",", "\[CapitalPi]AB", ",", "\[CapitalPi]BA", 
             ",", "\[CapitalPi]BB"}], "}"}], "=", "payoffs"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Switch", "[", 
           RowBox[{
           "updateRule", ",", "\[IndentingNewLine]", 
            "\"\<Imitate if better, all nbrs\>\"", ",", 
            RowBox[{
             FractionBox[
              RowBox[{"k", "-", "kA"}], "k"], 
             RowBox[{
              SubsuperscriptBox["\[Sum]", 
               RowBox[{"i", "=", "1"}], "k"], 
              RowBox[{"Piecewise", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"PBOneA", "[", 
                    RowBox[{"i", ",", "k", ",", "qAB"}], "]"}], ",", 
                   RowBox[{
                    RowBox[{"\[CapitalPi]B", "[", 
                    RowBox[{
                    "i", ",", "k", ",", "\[CapitalPi]BA", ",", 
                    "\[CapitalPi]BB"}], "]"}], ">", 
                    RowBox[{"\[CapitalPi]A", "[", 
                    RowBox[{
                    "kA", ",", "k", ",", "\[CapitalPi]AA", ",", 
                    "\[CapitalPi]AB"}], "]"}]}]}], "}"}], "}"}], ",", "0"}], 
               "]"}]}]}], ",", "\[IndentingNewLine]", 
            "\"\<Fermi (set intensity \
\!\(\*StyleBox[\"m\",FontSlant->\"Italic\"]\))\>\"", ",", 
            RowBox[{
             FractionBox[
              RowBox[{"k", "-", "kA"}], "k"], 
             RowBox[{
              SubsuperscriptBox["\[Sum]", 
               RowBox[{"i", "=", "1"}], "k"], 
              RowBox[{
               RowBox[{"PBOneA", "[", 
                RowBox[{"i", ",", "k", ",", "qAB"}], "]"}], " ", 
               FractionBox[
                RowBox[{"Exp", "[", 
                 RowBox[{"m", " ", 
                  RowBox[{"\[CapitalPi]B", "[", 
                   RowBox[{
                   "i", ",", "k", ",", "\[CapitalPi]BA", ",", 
                    "\[CapitalPi]BB"}], "]"}]}], "]"}], 
                RowBox[{
                 RowBox[{"Exp", "[", 
                  RowBox[{"m", " ", 
                   RowBox[{"\[CapitalPi]A", "[", 
                    RowBox[{
                    "kA", ",", "k", ",", "\[CapitalPi]AA", ",", 
                    "\[CapitalPi]AB"}], "]"}]}], "]"}], "+", 
                 RowBox[{"Exp", "[", 
                  RowBox[{"m", " ", 
                   RowBox[{"\[CapitalPi]B", "[", 
                    RowBox[{
                    "i", ",", "k", ",", "\[CapitalPi]BA", ",", 
                    "\[CapitalPi]BB"}], "]"}]}], "]"}]}]]}]}]}], ",", 
            "\[IndentingNewLine]", "\"\<Imitative pairwise difference\>\"", 
            ",", 
            RowBox[{
             FractionBox[
              RowBox[{"k", "-", "kA"}], "k"], 
             RowBox[{
              SubsuperscriptBox["\[Sum]", 
               RowBox[{"i", "=", "1"}], "k"], 
              RowBox[{
               RowBox[{"PBOneA", "[", 
                RowBox[{"i", ",", "k", ",", "qAB"}], "]"}], 
               FractionBox[
                RowBox[{"BePositive", "[", 
                 RowBox[{
                  RowBox[{"\[CapitalPi]B", "[", 
                   RowBox[{
                   "i", ",", "k", ",", "\[CapitalPi]BA", ",", 
                    "\[CapitalPi]BB"}], "]"}], "-", 
                  RowBox[{"\[CapitalPi]A", "[", 
                   RowBox[{
                   "kA", ",", "k", ",", "\[CapitalPi]AA", ",", 
                    "\[CapitalPi]AB"}], "]"}]}], "]"}], "maxDiff"]}]}]}], ",",
             "\[IndentingNewLine]", "\"\<Best neighbor\>\"", ",", 
            RowBox[{"Switch", "[", 
             RowBox[{"kA", ",", "\[IndentingNewLine]", "0", ",", 
              RowBox[{
               SubsuperscriptBox["\[Sum]", 
                RowBox[{"i", "=", "1"}], "k"], 
               RowBox[{"Piecewise", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"ProbabilityBestPayoffAmongBNbrsAOneB", "[", 
                    RowBox[{
                    RowBox[{"\[CapitalPi]B", "[", 
                    RowBox[{
                    "i", ",", "k", ",", "\[CapitalPi]BA", ",", 
                    "\[CapitalPi]BB"}], "]"}], ",", "kA", ",", "k", ",", 
                    "payoffs", ",", "qAB"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"\[CapitalPi]B", "[", 
                    RowBox[{
                    "i", ",", "k", ",", "\[CapitalPi]BA", ",", 
                    "\[CapitalPi]BB"}], "]"}], ">", 
                    RowBox[{"\[CapitalPi]A", "[", 
                    RowBox[{
                    "kA", ",", "k", ",", "\[CapitalPi]AA", ",", 
                    "\[CapitalPi]AB"}], "]"}]}]}], "}"}], "}"}], ",", "0"}], 
                "]"}]}], ",", "\[IndentingNewLine]", "k", ",", "0", ",", 
              "\[IndentingNewLine]", "_", ",", 
              RowBox[{
               SubsuperscriptBox["\[Sum]", 
                RowBox[{"i", "=", "1"}], "k"], 
               RowBox[{"Piecewise", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"ProbabilityBestPayoffAmongBNbrsAOneB", "[", 
                    RowBox[{
                    RowBox[{"\[CapitalPi]B", "[", 
                    RowBox[{
                    "i", ",", "k", ",", "\[CapitalPi]BA", ",", 
                    "\[CapitalPi]BB"}], "]"}], ",", "kA", ",", "k", ",", 
                    "payoffs", ",", "qAB"}], "]"}], 
                    RowBox[{
                    "StrictCumulativeProbabilityBestPayoffAmongANbrsAOneA", 
                    "[", 
                    RowBox[{
                    RowBox[{"\[CapitalPi]B", "[", 
                    RowBox[{
                    "i", ",", "k", ",", "\[CapitalPi]BA", ",", 
                    "\[CapitalPi]BB"}], "]"}], ",", "kA", ",", "k", ",", 
                    "payoffs", ",", "qAA"}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"\[CapitalPi]B", "[", 
                    RowBox[{
                    "i", ",", "k", ",", "\[CapitalPi]BA", ",", 
                    "\[CapitalPi]BB"}], "]"}], ">", 
                    RowBox[{"\[CapitalPi]A", "[", 
                    RowBox[{
                    "kA", ",", "k", ",", "\[CapitalPi]AA", ",", 
                    "\[CapitalPi]AB"}], "]"}]}]}], "}"}], "}"}], ",", "0"}], 
                "]"}]}]}], "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{"kA", " ", "<=", " ", 
               RowBox[{"k", "-", "1"}]}], " ", "*)"}], 
             RowBox[{"(*", " ", 
              RowBox[{"kA", " ", ">=", " ", "1"}], " ", "*)"}], 
             "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]}],
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FB", "[", 
        RowBox[{
        "kA_", ",", "k_", ",", "maxDiff_", ",", "m_", ",", "payoffs_", ",", 
         "qAA_", ",", "qAB_"}], "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\[CapitalPi]AA", ",", "\[CapitalPi]AB", ",", "\[CapitalPi]BA", ",",
            "\[CapitalPi]BB"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "\[CapitalPi]AA", ",", "\[CapitalPi]AB", ",", "\[CapitalPi]BA", 
             ",", "\[CapitalPi]BB"}], "}"}], "=", "payoffs"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Switch", "[", 
           RowBox[{
           "updateRule", ",", "\[IndentingNewLine]", 
            "\"\<Imitate if better, all nbrs\>\"", ",", 
            RowBox[{
             FractionBox["kA", "k"], 
             RowBox[{
              SubsuperscriptBox["\[Sum]", 
               RowBox[{"i", "=", "0"}], 
               RowBox[{"k", "-", "1"}]], 
              RowBox[{"Piecewise", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"PAOneB", "[", 
                    RowBox[{"i", ",", "k", ",", "qAA"}], "]"}], ",", 
                   RowBox[{
                    RowBox[{"\[CapitalPi]A", "[", 
                    RowBox[{
                    "i", ",", "k", ",", "\[CapitalPi]AA", ",", 
                    "\[CapitalPi]AB"}], "]"}], ">", 
                    RowBox[{"\[CapitalPi]B", "[", 
                    RowBox[{
                    "kA", ",", "k", ",", "\[CapitalPi]BA", ",", 
                    "\[CapitalPi]BB"}], "]"}]}]}], "}"}], "}"}], ",", "0"}], 
               "]"}]}]}], ",", "\[IndentingNewLine]", 
            "\"\<Fermi (set intensity \
\!\(\*StyleBox[\"m\",FontSlant->\"Italic\"]\))\>\"", ",", 
            RowBox[{
             FractionBox["kA", "k"], 
             RowBox[{
              SubsuperscriptBox["\[Sum]", 
               RowBox[{"i", "=", "0"}], 
               RowBox[{"k", "-", "1"}]], 
              RowBox[{
               RowBox[{"PAOneB", "[", 
                RowBox[{"i", ",", "k", ",", "qAA"}], "]"}], " ", 
               FractionBox[
                RowBox[{"Exp", "[", 
                 RowBox[{"m", " ", 
                  RowBox[{"\[CapitalPi]A", "[", 
                   RowBox[{
                   "i", ",", "k", ",", "\[CapitalPi]AA", ",", 
                    "\[CapitalPi]AB"}], "]"}]}], "]"}], 
                RowBox[{
                 RowBox[{"Exp", "[", 
                  RowBox[{"m", " ", 
                   RowBox[{"\[CapitalPi]B", "[", 
                    RowBox[{
                    "kA", ",", "k", ",", "\[CapitalPi]BA", ",", 
                    "\[CapitalPi]BB"}], "]"}]}], "]"}], "+", 
                 RowBox[{"Exp", "[", 
                  RowBox[{"m", " ", 
                   RowBox[{"\[CapitalPi]A", "[", 
                    RowBox[{
                    "i", ",", "k", ",", "\[CapitalPi]AA", ",", 
                    "\[CapitalPi]AB"}], "]"}]}], "]"}]}]]}]}]}], ",", 
            "\[IndentingNewLine]", "\"\<Imitative pairwise difference\>\"", 
            ",", 
            RowBox[{
             FractionBox["kA", "k"], 
             RowBox[{
              SubsuperscriptBox["\[Sum]", 
               RowBox[{"i", "=", "0"}], 
               RowBox[{"k", "-", "1"}]], 
              RowBox[{
               RowBox[{"PAOneB", "[", 
                RowBox[{"i", ",", "k", ",", "qAA"}], "]"}], 
               FractionBox[
                RowBox[{"BePositive", "[", 
                 RowBox[{
                  RowBox[{"\[CapitalPi]A", "[", 
                   RowBox[{
                   "i", ",", "k", ",", "\[CapitalPi]AA", ",", 
                    "\[CapitalPi]AB"}], "]"}], "-", 
                  RowBox[{"\[CapitalPi]B", "[", 
                   RowBox[{
                   "kA", ",", "k", ",", "\[CapitalPi]BA", ",", 
                    "\[CapitalPi]BB"}], "]"}]}], "]"}], "maxDiff"]}]}]}], ",",
             "\[IndentingNewLine]", "\"\<Best neighbor\>\"", ",", 
            RowBox[{"Switch", "[", 
             RowBox[{
             "kA", ",", "\[IndentingNewLine]", "0", ",", "0", ",", 
              "\[IndentingNewLine]", "k", ",", 
              RowBox[{
               SubsuperscriptBox["\[Sum]", 
                RowBox[{"i", "=", "0"}], 
                RowBox[{"k", "-", "1"}]], 
               RowBox[{"Piecewise", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"ProbabilityBestPayoffAmongANbrsBOneA", "[", 
                    RowBox[{
                    RowBox[{"\[CapitalPi]A", "[", 
                    RowBox[{
                    "i", ",", "k", ",", "\[CapitalPi]AA", ",", 
                    "\[CapitalPi]AB"}], "]"}], ",", "kA", ",", "k", ",", 
                    "payoffs", ",", "qAA"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"\[CapitalPi]A", "[", 
                    RowBox[{
                    "i", ",", "k", ",", "\[CapitalPi]AA", ",", 
                    "\[CapitalPi]AB"}], "]"}], ">", 
                    RowBox[{"\[CapitalPi]B", "[", 
                    RowBox[{
                    "kA", ",", "k", ",", "\[CapitalPi]BA", ",", 
                    "\[CapitalPi]BB"}], "]"}]}]}], "}"}], "}"}], ",", "0"}], 
                "]"}]}], ",", "\[IndentingNewLine]", "_", ",", 
              RowBox[{
               SubsuperscriptBox["\[Sum]", 
                RowBox[{"i", "=", "0"}], 
                RowBox[{"k", "-", "1"}]], 
               RowBox[{"Piecewise", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"ProbabilityBestPayoffAmongANbrsBOneA", "[", 
                    RowBox[{
                    RowBox[{"\[CapitalPi]A", "[", 
                    RowBox[{
                    "i", ",", "k", ",", "\[CapitalPi]AA", ",", 
                    "\[CapitalPi]AB"}], "]"}], ",", "kA", ",", "k", ",", 
                    "payoffs", ",", "qAA"}], "]"}], 
                    RowBox[{
                    "StrictCumulativeProbabilityBestPayoffAmongBNbrsBOneB", 
                    "[", 
                    RowBox[{
                    RowBox[{"\[CapitalPi]A", "[", 
                    RowBox[{
                    "i", ",", "k", ",", "\[CapitalPi]AA", ",", 
                    "\[CapitalPi]AB"}], "]"}], ",", "kA", ",", "k", ",", 
                    "payoffs", ",", "qAB"}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"\[CapitalPi]A", "[", 
                    RowBox[{
                    "i", ",", "k", ",", "\[CapitalPi]AA", ",", 
                    "\[CapitalPi]AB"}], "]"}], ">", 
                    RowBox[{"\[CapitalPi]B", "[", 
                    RowBox[{
                    "kA", ",", "k", ",", "\[CapitalPi]BA", ",", 
                    "\[CapitalPi]BB"}], "]"}]}]}], "}"}], "}"}], ",", "0"}], 
                "]"}]}]}], "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{"kA", " ", "<=", " ", 
               RowBox[{"k", "-", "1"}]}], " ", "*)"}], 
             RowBox[{"(*", " ", 
              RowBox[{"kA", " ", ">=", " ", "1"}], " ", "*)"}], 
             "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]}],
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "For", " ", "imitative", " ", "pairwise", " ", "difference", " ", 
        "and", " ", "best", " ", "neighbor", " ", "MD", " ", "only"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"BePositive", "[", "x_", "]"}], ":=", 
       RowBox[{"Piecewise", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"x", "<", "0"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{"x", "\[GreaterEqual]", "0"}]}], "}"}]}], "}"}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"For", " ", "best", " ", "neighbor", " ", "only"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"CumulativeProbabilityBestPayoffAmongANbrsBOneA", "[", 
        RowBox[{"x_", ",", "kA_", ",", "k_", ",", "payoffs_", ",", "qAA_"}], 
        "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\[CapitalPi]AA", ",", "\[CapitalPi]AB", ",", "\[CapitalPi]BA", ",",
            "\[CapitalPi]BB"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "\[CapitalPi]AA", ",", "\[CapitalPi]AB", ",", "\[CapitalPi]BA", 
             ",", "\[CapitalPi]BB"}], "}"}], "=", "payoffs"}], ";", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SubsuperscriptBox["\[Sum]", 
              RowBox[{"i", "=", "0"}], 
              RowBox[{"k", "-", "1"}]], 
             RowBox[{"Piecewise", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"PAOneB", "[", 
                   RowBox[{"i", ",", "k", ",", "qAA"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"\[CapitalPi]A", "[", 
                    RowBox[{
                    "i", ",", "k", ",", "\[CapitalPi]AA", ",", 
                    "\[CapitalPi]AB"}], "]"}], "<=", "x"}]}], "}"}], "}"}], 
               ",", "0"}], "]"}]}], ")"}], "kA"]}]}], "\[IndentingNewLine]", 
        "]"}]}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{"kA", " ", ">=", " ", "1"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"StrictCumulativeProbabilityBestPayoffAmongANbrsBOneA", "[", 
        RowBox[{"x_", ",", "kA_", ",", "k_", ",", "payoffs_", ",", "qAA_"}], 
        "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\[CapitalPi]AA", ",", "\[CapitalPi]AB", ",", "\[CapitalPi]BA", ",",
            "\[CapitalPi]BB"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "\[CapitalPi]AA", ",", "\[CapitalPi]AB", ",", "\[CapitalPi]BA", 
             ",", "\[CapitalPi]BB"}], "}"}], "=", "payoffs"}], ";", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SubsuperscriptBox["\[Sum]", 
              RowBox[{"i", "=", "0"}], 
              RowBox[{"k", "-", "1"}]], 
             RowBox[{"Piecewise", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"PAOneB", "[", 
                   RowBox[{"i", ",", "k", ",", "qAA"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"\[CapitalPi]A", "[", 
                    RowBox[{
                    "i", ",", "k", ",", "\[CapitalPi]AA", ",", 
                    "\[CapitalPi]AB"}], "]"}], "<", "x"}]}], "}"}], "}"}], 
               ",", "0"}], "]"}]}], ")"}], "kA"]}]}], "\[IndentingNewLine]", 
        "]"}]}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{"kA", " ", ">=", " ", "1"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ProbabilityBestPayoffAmongANbrsBOneA", "[", 
        RowBox[{"x_", ",", "kA_", ",", "k_", ",", "payoffs_", ",", "qAA_"}], 
        "]"}], ":=", 
       RowBox[{
        RowBox[{"CumulativeProbabilityBestPayoffAmongANbrsBOneA", "[", 
         RowBox[{"x", ",", "kA", ",", "k", ",", "payoffs", ",", "qAA"}], 
         "]"}], "-", 
        RowBox[{"StrictCumulativeProbabilityBestPayoffAmongANbrsBOneA", "[", 
         RowBox[{"x", ",", "kA", ",", "k", ",", "payoffs", ",", "qAA"}], 
         "]"}]}]}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{"kA", " ", ">=", " ", "1"}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"CumulativeProbabilityBestPayoffAmongBNbrsBOneB", "[", 
        RowBox[{"x_", ",", "kA_", ",", "k_", ",", "payoffs_", ",", "qAB_"}], 
        "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\[CapitalPi]AA", ",", "\[CapitalPi]AB", ",", "\[CapitalPi]BA", ",",
            "\[CapitalPi]BB"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "\[CapitalPi]AA", ",", "\[CapitalPi]AB", ",", "\[CapitalPi]BA", 
             ",", "\[CapitalPi]BB"}], "}"}], "=", "payoffs"}], ";", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SubsuperscriptBox["\[Sum]", 
              RowBox[{"i", "=", "0"}], 
              RowBox[{"k", "-", "1"}]], 
             RowBox[{"Piecewise", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"PBOneB", "[", 
                   RowBox[{"i", ",", "k", ",", "qAB"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"\[CapitalPi]B", "[", 
                    RowBox[{
                    "i", ",", "k", ",", "\[CapitalPi]BA", ",", 
                    "\[CapitalPi]BB"}], "]"}], "<=", "x"}]}], "}"}], "}"}], 
               ",", "0"}], "]"}]}], ")"}], 
           RowBox[{"k", "-", "kA"}]]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{"kA", " ", "<=", " ", 
        RowBox[{"k", "-", "1"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"StrictCumulativeProbabilityBestPayoffAmongBNbrsBOneB", "[", 
        RowBox[{"x_", ",", "kA_", ",", "k_", ",", "payoffs_", ",", "qAB_"}], 
        "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\[CapitalPi]AA", ",", "\[CapitalPi]AB", ",", "\[CapitalPi]BA", ",",
            "\[CapitalPi]BB"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "\[CapitalPi]AA", ",", "\[CapitalPi]AB", ",", "\[CapitalPi]BA", 
             ",", "\[CapitalPi]BB"}], "}"}], "=", "payoffs"}], ";", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SubsuperscriptBox["\[Sum]", 
              RowBox[{"i", "=", "0"}], 
              RowBox[{"k", "-", "1"}]], 
             RowBox[{"Piecewise", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"PBOneB", "[", 
                   RowBox[{"i", ",", "k", ",", "qAB"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"\[CapitalPi]B", "[", 
                    RowBox[{
                    "i", ",", "k", ",", "\[CapitalPi]BA", ",", 
                    "\[CapitalPi]BB"}], "]"}], "<", "x"}]}], "}"}], "}"}], 
               ",", "0"}], "]"}]}], ")"}], 
           RowBox[{"k", "-", "kA"}]]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{"kA", " ", "<=", " ", 
        RowBox[{"k", "-", "1"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ProbabilityBestPayoffAmongBNbrsBOneB", "[", 
        RowBox[{"x_", ",", "kA_", ",", "k_", ",", "payoffs_", ",", "qAB_"}], 
        "]"}], ":=", 
       RowBox[{
        RowBox[{"CumulativeProbabilityBestPayoffAmongBNbrsBOneB", "[", 
         RowBox[{"x", ",", "kA", ",", "k", ",", "payoffs", ",", "qAB"}], 
         "]"}], "-", 
        RowBox[{"StrictCumulativeProbabilityBestPayoffAmongBNbrsBOneB", "[", 
         RowBox[{"x", ",", "kA", ",", "k", ",", "payoffs", ",", "qAB"}], 
         "]"}]}]}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{"kA", " ", "<=", " ", 
        RowBox[{"k", "-", "1"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"CumulativeProbabilityBestPayoffAmongBNbrsAOneB", "[", 
        RowBox[{"x_", ",", "kA_", ",", "k_", ",", "payoffs_", ",", "qAB_"}], 
        "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\[CapitalPi]AA", ",", "\[CapitalPi]AB", ",", "\[CapitalPi]BA", ",",
            "\[CapitalPi]BB"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "\[CapitalPi]AA", ",", "\[CapitalPi]AB", ",", "\[CapitalPi]BA", 
             ",", "\[CapitalPi]BB"}], "}"}], "=", "payoffs"}], ";", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SubsuperscriptBox["\[Sum]", 
              RowBox[{"i", "=", "1"}], "k"], 
             RowBox[{"Piecewise", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"PBOneA", "[", 
                   RowBox[{"i", ",", "k", ",", "qAB"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"\[CapitalPi]B", "[", 
                    RowBox[{
                    "i", ",", "k", ",", "\[CapitalPi]BA", ",", 
                    "\[CapitalPi]BB"}], "]"}], "<=", "x"}]}], "}"}], "}"}], 
               ",", "0"}], "]"}]}], ")"}], 
           RowBox[{"k", "-", "kA"}]]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{"kA", " ", "<=", " ", 
        RowBox[{"k", "-", "1"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"StrictCumulativeProbabilityBestPayoffAmongBNbrsAOneB", "[", 
        RowBox[{"x_", ",", "kA_", ",", "k_", ",", "payoffs_", ",", "qAB_"}], 
        "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\[CapitalPi]AA", ",", "\[CapitalPi]AB", ",", "\[CapitalPi]BA", ",",
            "\[CapitalPi]BB"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "\[CapitalPi]AA", ",", "\[CapitalPi]AB", ",", "\[CapitalPi]BA", 
             ",", "\[CapitalPi]BB"}], "}"}], "=", "payoffs"}], ";", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SubsuperscriptBox["\[Sum]", 
              RowBox[{"i", "=", "1"}], "k"], 
             RowBox[{"Piecewise", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"PBOneA", "[", 
                   RowBox[{"i", ",", "k", ",", "qAB"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"\[CapitalPi]B", "[", 
                    RowBox[{
                    "i", ",", "k", ",", "\[CapitalPi]BA", ",", 
                    "\[CapitalPi]BB"}], "]"}], "<", "x"}]}], "}"}], "}"}], 
               ",", "0"}], "]"}]}], ")"}], 
           RowBox[{"k", "-", "kA"}]]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{"kA", " ", "<=", " ", 
        RowBox[{"k", "-", "1"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ProbabilityBestPayoffAmongBNbrsAOneB", "[", 
        RowBox[{"x_", ",", "kA_", ",", "k_", ",", "payoffs_", ",", "qAB_"}], 
        "]"}], ":=", 
       RowBox[{
        RowBox[{"CumulativeProbabilityBestPayoffAmongBNbrsAOneB", "[", 
         RowBox[{"x", ",", "kA", ",", "k", ",", "payoffs", ",", "qAB"}], 
         "]"}], "-", 
        RowBox[{"StrictCumulativeProbabilityBestPayoffAmongBNbrsAOneB", "[", 
         RowBox[{"x", ",", "kA", ",", "k", ",", "payoffs", ",", "qAB"}], 
         "]"}]}]}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{"kA", " ", "<=", " ", 
        RowBox[{"k", "-", "1"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"CumulativeProbabilityBestPayoffAmongANbrsAOneA", "[", 
        RowBox[{"x_", ",", "kA_", ",", "k_", ",", "payoffs_", ",", "qAA_"}], 
        "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\[CapitalPi]AA", ",", "\[CapitalPi]AB", ",", "\[CapitalPi]BA", ",",
            "\[CapitalPi]BB"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "\[CapitalPi]AA", ",", "\[CapitalPi]AB", ",", "\[CapitalPi]BA", 
             ",", "\[CapitalPi]BB"}], "}"}], "=", "payoffs"}], ";", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SubsuperscriptBox["\[Sum]", 
              RowBox[{"i", "=", "1"}], "k"], 
             RowBox[{"Piecewise", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"PAOneA", "[", 
                   RowBox[{"i", ",", "k", ",", "qAA"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"\[CapitalPi]A", "[", 
                    RowBox[{
                    "i", ",", "k", ",", "\[CapitalPi]AA", ",", 
                    "\[CapitalPi]AB"}], "]"}], "<=", "x"}]}], "}"}], "}"}], 
               ",", "0"}], "]"}]}], ")"}], "kA"]}]}], "\[IndentingNewLine]", 
        "]"}]}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{"kA", " ", ">=", " ", "1"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"StrictCumulativeProbabilityBestPayoffAmongANbrsAOneA", "[", 
        RowBox[{"x_", ",", "kA_", ",", "k_", ",", "payoffs_", ",", "qAA_"}], 
        "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\[CapitalPi]AA", ",", "\[CapitalPi]AB", ",", "\[CapitalPi]BA", ",",
            "\[CapitalPi]BB"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "\[CapitalPi]AA", ",", "\[CapitalPi]AB", ",", "\[CapitalPi]BA", 
             ",", "\[CapitalPi]BB"}], "}"}], "=", "payoffs"}], ";", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SubsuperscriptBox["\[Sum]", 
              RowBox[{"i", "=", "1"}], "k"], 
             RowBox[{"Piecewise", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"PAOneA", "[", 
                   RowBox[{"i", ",", "k", ",", "qAA"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"\[CapitalPi]A", "[", 
                    RowBox[{
                    "i", ",", "k", ",", "\[CapitalPi]AA", ",", 
                    "\[CapitalPi]AB"}], "]"}], "<", "x"}]}], "}"}], "}"}], 
               ",", "0"}], "]"}]}], ")"}], "kA"]}]}], "\[IndentingNewLine]", 
        "]"}]}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{"kA", " ", ">=", " ", "1"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ProbabilityBestPayoffAmongANbrsAOneA", "[", 
        RowBox[{"x_", ",", "kA_", ",", "k_", ",", "payoffs_", ",", "qAA_"}], 
        "]"}], ":=", 
       RowBox[{
        RowBox[{"CumulativeProbabilityBestPayoffAmongANbrsAOneA", "[", 
         RowBox[{"x", ",", "kA", ",", "k", ",", "payoffs", ",", "qAA"}], 
         "]"}], "-", 
        RowBox[{"StrictCumulativeProbabilityBestPayoffAmongANbrsAOneA", "[", 
         RowBox[{"x", ",", "kA", ",", "k", ",", "payoffs", ",", "qAA"}], 
         "]"}]}]}], ";"}], 
     RowBox[{"(*", " ", 
      RowBox[{"kA", " ", ">=", " ", "1"}], " ", "*)"}], "\[IndentingNewLine]",
      ")"}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[27]:=",ExpressionUUID->"ebe497d7-c6bb-4946-9a6d-3dd577d63d4d"]
}, Closed]]
},
ScreenStyleEnvironment->"Working",
CellGrouping->Manual,
WindowSize->{1352, 757},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
TrackCellChangeTimes->False,
SpellingDictionaries->{"CorrectWords"->{
 "assortatively", "monomorphic", "Izquierdo", "Christoph", "Hauert", 
  "Doebeli", "Fu", "Nowak", "Segismundo"}},
Magnification:>1.25 Inherited,
FrontEndVersion->"14.0 for Mac OS X ARM (64-bit) (December 12, 2023)",
StyleDefinitions->FrontEnd`FileName[{"Creative"}, "NaturalColor.nb", 
  CharacterEncoding -> "UTF-8"],
ExpressionUUID->"4e2cc03b-a333-477d-bfc5-29b2fdd3b4c9"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[1257, 32, 142, 2, 76, "Title",ExpressionUUID->"be2ab95f-49ca-4d64-983e-6549390d65ef"],
Cell[1402, 36, 630, 20, 49, "Subtitle",ExpressionUUID->"c414d9db-7737-4bde-8abd-eaa0928aedb2"],
Cell[2035, 58, 505, 11, 62, "Text",ExpressionUUID->"73c625d9-c929-477d-869c-c28f423133fc"]
}, Open  ]],
Cell[2555, 72, 128550, 2401, 646, "Output",ExpressionUUID->"1fd5b92f-772e-4f7d-8abb-7336373fceb7"],
Cell[131108, 2475, 169, 3, 38, "Text",ExpressionUUID->"021aea6b-5e2b-4058-85f8-5552c48ddfc5"],
Cell[131280, 2480, 359, 6, 60, "Item",ExpressionUUID->"cff5d4dc-3f61-4bdd-8771-9f7b6b96d81f"],
Cell[131642, 2488, 324, 6, 38, "Item",ExpressionUUID->"2ca8f976-df16-491d-9adf-ee3a9cf8a092"],
Cell[131969, 2496, 459, 9, 60, "Item",ExpressionUUID->"c3352103-912e-4d0d-a932-79dfb6d96bba"],
Cell[132431, 2507, 810, 14, 157, "Text",ExpressionUUID->"6ceadfdc-305c-40ae-91bb-bfcef2ce55de"],
Cell[CellGroupData[{
Cell[133266, 2525, 88, 0, 92, "Section",ExpressionUUID->"55447b59-612e-4591-8e42-22aa94d55bf5"],
Cell[133357, 2527, 2401, 50, 775, "Text",ExpressionUUID->"3e570553-cd0b-47f0-bf9b-dcd4a5acb375"]
}, Closed]],
Cell[CellGroupData[{
Cell[135795, 2582, 85, 0, 53, "Section",ExpressionUUID->"d7fc9b4c-924e-445b-8538-aebcffdbf017"],
Cell[135883, 2584, 127390, 2884, 19121, "Input",ExpressionUUID->"ebe497d7-c6bb-4946-9a6d-3dd577d63d4d"]
}, Closed]]
}
]
*)

